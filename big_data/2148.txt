2009 2nd International Conference on Power Electronics and Intelligent Transportation System A Robust Image Watermarking Algorithm Based on Non-Uniform Rectangular Partition and DWT KinTak U ShengDun Hu Dongxu Q i Zesheng Tang Faculty of Information Technology Macau University of Science and Technology Macau China ktu@must.edu.mo  hsdlya@hotmail.com dxqi@must.edu.mo ztang@must.edu.mo where N is the image width and height x,y and x y are the 
PSNR=32 dB 
Wateunazked Image Recovered watermar k after JPEG-compression P SNR=3 1.14 dB 
pixel locations before and after scrambling MUST E  
Recovere d wate rmark after JPEG-compression Emb edding In.1emity 0.04 mod N 
x,y 
O,I N 
 G t 
I In order to solve this problem this study is designed to calculate the non-uniform intensities embedding into the low\255 frequency coefficients in DWT domain according to the partition number of the rectangles after the non-uniform rectangular partition This new method not only guarantees a strong anti-1PEG-compression attack function but also keeps the watermarked image away from obvious distortion In the meanwhile as a compensation for filtering attack the watermark bits are also embedded into the high-frequency coefficients which have a big magnitude comparing with the maximum of the low-frequency coefficients in DWT Finally the extracted watermark bits from low-frequency and high\255 frequency coefficients form the final extracted watermark The traditional watermark scrambling methods include Arnold Scrambling Magic Square Scrambling method and Hilbert Curve Scrambling etc  Here the 
Arnold Scrambling method is used to increase the ability of anti-cropping attack and the whole security before embedding lP EG-compression attack is obtained but a big distortion in the watermarked image will appear with square effect As shown in Table I when the uniform embedded intensity is 0.04 and 0.05 the watermark is almost not influenced by the lP EG\255 compression attack with Quality Factor\(QF\=40 but a strong square distortion appears in the watermarked image TAB L E I  TH E DI STORTION IN WATERMARKED IMAGE WITH UNIFORM EMBEDDED INTENSITY AFTER THE JP EGCOMPRESSION ATTACK 
Term\\'-non-uniform partition of image rectangular partition image watermarking DWT 
Index 
I 
I N TROD UC TIO N Nowadays the unauthorized pass-round and copy of digital mediums via the Internet become more and more serious as the rapid development of the Internet One of the most effective solutions to protect the intellectual property rights is to apply digital watermark Currently there are two most popular digital watermarking technologies including the Methods in Time Domain and Methods in Transformation Domain Methods in the former one can be implemented more simply but the robustness is poorer while methods in the latter one are more popular with their stronger anti-attack functions The typical Transformation-Domain Methods are mostly based on the domain 
of Discrete Fourier Transform DFT Discrete Cosine Transform DCT and Discrete Wavelet Transform DWT etc Among them the algorithms based on DWT[I][2 are in common use In these kinds of methods the information of watermark is inserted into the coefficients of intermediate-Iow\255 frequency in DWT domain Although this may not cause an obvious quality distortion of the watermarked image its function against lPEG compression attack is not very ideal If the information of watermark is inserted into low-frequency coefficients in DWT domain then a strong function against 
is more likely to prevent the watermark from 
Abstract-It 
JPEG-compression attack when it is emhedded into the low\255 frequency coefficients of DWT However embedding the watermark with the same intensity into them may di stort the watermarked image to a large extent To solve this problem a novel robust image-watermark algorithm is proposed with the characteristics of selective embedding intensity based on the non\255 uniform partition  Meanwhile as a balance for filtering attacks the watermark bits arc also embedded into the high-frequency coefficients which have a big magnitude  Besides in 
order to increase the anti-cropping function and the security of the algorithm Arnold Scrambling Algorithm is applied before the watermark is embedded The results of the experiments have showed that this algorithm is robust against noising attack filtering attack and cropping attack especially the JPEG\255 compression attack and no obvious distortion appeared in the watermarked image 978-1 4244 4543-1/09 25.00 2512009 IEEE PElTS 2009 25 
 


II THE CALCULATION OF THE EMBEDDED INTENSITY BASED ON THE NON-UNIFORM RECTANGULAR PARTITION OF IMAGE Paper proposed the algorithm of the non-uniform rectangular partition of image according to the pixel gray values When the initial partition the bivariate polynomial and the error control value are all determined this adaptive partition algorithm can be applied to do the non-uniform rectangular partition of image As an example we choose 10,7,4 and 1 and the following figures show the partition results and the number of rectangles within each 8*8 sub-area of the image Figure 1 Partition results and the number of rectangles within each 8*8 sub\255 area of the image when 
Where 
 10 Figure 2 Part ition results and the numb er of rectangl es within each 8*8 sub\255 area of the image when 7 Figure 3 Partition results and the number of rectangles within each 8*8 sub\255 area of the image when 4 26 Figure 4 Partition results and the number of rectangles within each 8*8 sub\255 area of the image when  1 The four groups of figures show that if the error is too big the texture characteristics of image cannot be made out obviously if it is too small the number of rectangles in each 8*8 sub-area becomes almost 16 After many experiments the texture characteristics of image for general images can be described in a good way when the error is between 4 and 7 The smallest partition size is 2*2=4\(pixels so the maximum number of rectangles in each 8*8 sub-area is 8*8/4=16 and the minimum number is one Here the Normalized Correlation Coefficient NC is used to scale the similarity between the original watermark and extracted watermark The definition ofNC is given by 
 
is the original watermark and W x,y is the extracted watermark In order to deduce the embedded intensity formula according to the rectangle number within each sub-area the analysis is conducted between the watermarked image and extracted watermark after applying the uniform-intensity embedding in the coefficients of LL 3 after three level wavelet decomposition as in Figure 5 The host image is a 256*256 standard gray image of Lena The watermark is a 32*32 binary image u HL j HL 2 LH HH j HL 1 Uh HH2 LH 1 HH 1 Figure 5 Third level wavelet decomposition 
W\(x,y 
I 
 


M/8 N/8 
If the watermark bit is one then LL p iJ  LL p iJ 1 Intensityji.jj otherwise LL p iJ  LL p iJ]*\(I\255 Intensityjijl Here iJ 
WaterJll3 aft er M UST M UST 
applying the arnold scrambling algorithm to scramble the pixel-locations of the watermark 27 
fi O.OI T 0.9T W\(i,j 
attac k Q=40 NC=l NC=l NC O 9532 Table II shows that the PSNR of watermarked image is 45dB when the uniform intensity is 0.01  but the anti-1PEG\255 compression function becomes worse with only 0.9532 ofNC in the extracted watermark 
W 2\(i,j  W 2\(i,j 1 W 
Wand Wli,j 
n  
JPE G-compresmon  
Intensity[iJ is the watermark embedding intensity array for each 8*8 sub-area of image With the value of each intensity  the embedding and extraction algorithm of watermark are derived in the following section Here the value of 
k 
Recovered 
I 
k 
 MUS t 
4 The host image is a standard 512 512 gray image of Lena and the watermark is a 32*32 binary image The PSNR of watermarked image is about 38dB and the NC of the recovered watermark is 1 without attacking Table III gives the performance comparison between this scheme and after some typical attacks As we can see all of recovered watermarks with better BER Bit Error b Let LL o be the original image LL I be the low-frequency\255 coefficient Matrix of the first level of wavelet decomposition of the original image Find the value ofp by the formula M/L=2 P 225 Treat the LL p as the initial partition and specify the value of control error G  do the non uniform rectangular part itioning for LL p calculate the number of partitioned rectangles in each 2 P 2 P sub-area and store it into the array of RNO follow the formula 2 to find out each intensity which is stored in the array Intensity[iJ c Embed the scrambled watermark bits into each coefficient of L d Let T 0.015*maximum coefficient in LL find the first L*L coefficients in HLj,LHI,HH   HLp,LHp,HH p If the number is not enough  adjust The extraction algorithm of watermark is described as follows a Do the DWT for both the original image and watermarked image LL p and LL p are low-frequency coefficients of the p-th level of wavelet decomposition of them b Compare each of LL and LLp,[iJ if the difference between them is greater than 0 then the corresponding extracted watermark bit should be I otherwise it is o This process can extract all the scrambled-watermark bits into the array W/\(i,j c Find the first L*L coefficients in    HLp LH p HH p and HLI  LHj HH j    HLp',LHp',HH p which are greater than the threshold value of T Store them into the sets of HFN and HFN d Compare each of HFN and HFN if the difference between them is greater than 0 then the corresponding extracted watermark bit should be 1 otherwise it is O This process can extract all the scrambled-watermark bits into the array e The final extracted scrambled watermark bits are in Use the same key and the Arnold method to de-scramble the pixel-location of and thus recovering the watermark as is in opposite way while the uniform intensity is 0.06 In fact this situation can be improved by the configuration of the different embedding intensity  according to the texture distribution of the image Firstly  the host image M*N is non\255 uniformly partitioned the control error is between 4 and 7 then the number of partitioned rectangles within each 8*8 sub\255 area according to the partition grids  is obtained The numbers of these rectangles are stored in the array RNO[iJ the embedded intensity of each sub-area is calculated by the following equation Intensity[iJ  0.01  RNO[iJ]*fi/16 2 where i j with size of M*M and is the watermark whose size is L*L\(where M/L=2 P   The embedding algorithm of watermark is described as follows a Specify the key 
W  
1 f It 
3 
TABLE II W ATERM ARKED IMAGES AND EXTRAC TE D WAT ERM ARKS AFTER A PPLYING TilE UNIFORM INTENSITY EMBE DDING IV EXPERIMENTAL RESULTS In order to test the feasibility and effect of the proposed algorithm  many experiments have been carried out Here are the experimental results for the value of 
G G 
The bivariate polynomial and the error control value and try again until the requirement is met All satisfied coefficients are stored in the set of HFN Embed the scrambled watermark bits into each satisfied coefficient in the set of HFN by the following formula If the watermark bit is one then HFN[s  HFN  1 0.6 otherwise HFN  HFN s]*\(1-0.6 s=I 2  L*L e Do the inverse of DWT transform and forms the watermarked image equal to 0.5 0.5 makes the intensity more flexible with a range generally between 0.01 and 0.04 On the other hand  as a compensation for some filtering attacks  we also embed the watermark bits into the high\255 frequency coefficients of DWT with a big magnitude comparing with the maximum value of the low-frequency coefficients After many experiments we concluded that if the we set the threshold value as T a*max{LL p a is between 0.01 and 0.04 and among the high-frequency coefficients HL LH],HH   HLp,LHp,HH p we can find first L*L size of the watermark satisfied valuesf T in which we embed the watermark bits The embedded intensity we used is a uniform one between 0.5 and 1 for general image Here p is the wavelet decomposition level III THE EMBEDDING AND EXTRACTION ALGORITHM OF WATERMARK Suppose the host image is 
Ll 
om om OlJl'i Emb edding Intensi ty Watermarl<ed Ima;e PSNR=30dB PSNR=36 dB PSNR=45 dB 
 


L   
 
MUST jJ 
225\225 rooT-po 0.9779 MUst 0.0332 0.05273 Blurring 
H I  
r 
 f1 
Filterin g 0.9987 
I 
I i I 225 
PERFORMANCE COMPARISON BETWEEN THIS SCHEME AND PAPER AFT ER SOM E T Y P I C A L K IT ACKS Att ack T his Pap er Recovered T his Pap er Pap er 151 Ty pe NC Wate rma rk HER HER 225 1/4 0.9646 1'1 0.0566 0.05664 Cropping 5 Ga ussia n 0.8897 0.1748 o 17773 Noise 1 Salt 0.0020 0.15234 Ga ussia n 0 0.035 16 0.9974 MUST 0.0039 0.00586 Sha r pening 50 0.998 1 MUST 0.0029 0.04492 30 0.99 11 MUST 0.0137 0.12012 25 0.9917 MUST 0.0127 0.16113 15 0.9696 10 0.9436 0.0859 No operation Computer Graphics 2001 Vol 13,No 4 PI 338-341   KinTak U  Zesheng T a n g Dongxu Qi  A non-uniform rectangular partition coding of digital image and its application Proceedings of2009 IEEE International Con ference on Information and Automation  2009 PI 995-999  ZHANG Jian wei  BAO Z he n g  WAN Sun-feng  Adaptive Image Watermark ing Scheme Based on the Wavelet Domain Journal ofImage and Graphics  2007,12\(5 1'1 811-818 
I li 
1 9 r I 
3*3  3*3 
fJ 
This proves that this algorithm is very robust against JPEG-compression attack The whole anti-attack performance of this algorithm is effective without obvious distortion in the watermarked image The value of V CONCLUSION Image can be partitioned into different sub-rectangles with different texture characteristics by the algorithm of adaptive non-uniform rectangular partition This paper proposes a new non-uniform intensity embedding method according to the number of partitioned rectangles in each sub-area after the above partition is performed The embedding position is the low-frequency coefficients of DWT thus improving the anti\255 JPEG-compression attack function of the watermarking The watermark bits are also uniformly embedded into the high\255 frequency coefficients with a big magnitude comparing with the maximum value of low-frequency coefficient thus further improving the anti-filtering function After the test of some general attacks the experimental results prove that the proposed watermarking algorithm is feasible and effective the whole anti-attack function is satisfactory and the anti-JPEG\255 compression function is strong ACKNOWLEDGMENT This work was supported in part by NSF-CHINA Project No I063 I080 National Key Basic Research Project of China grant No.2004CB 318000 and Science and Technology Development Fund of Macao SAR No.008/2008/A1 RE FERENCES I YANG Heng-Fu CHEN Xiao-Wei  A Robust Image-Adaptive Public Watermarking Technique in Wavelet Domain Journal of Software 2003 Vol 14 NO.9 PI 1652-1660  FU Xiao-qing  LI Xiao-ping  SHI Lei  Image Adap tive Blind Watermarking Algorithm Based on Wavelet Transform  Applicat ion Research of Computers  2006  Vo1.12 PI 333-335  Ding Wei Yan W ei Qi  Qi Dong Xu  D igital Imag e Scrambl ing Technology Based on Arnold Transformation Journal of Computer\255 Aided Design 
 Mtj 0T 
S'r  
00 254 0.16895 noise Median 
Rate The NC values of extracted watermarks after these attacks are also given in table III TABLE 
 1 P epper 0.9835 Filter ing 1.0000 From the table above we can see the effect of the proposed algorithm which controls the embedding intensities according to texture characteristic based on non-uniform rectangular partition In general the PSNRs of the watermarked images are above 38dB and it is robust against nosing attack filtering attack and cropping attack The attack types are similar to those in paper but the effect is better  In order to test the ability of anti-JPEG-compression attack of this algorithm another kind of experiment is also 0.01 is done and the results are shown in table IV Table IV shows the performance between this algorithm and paper after JPEG-compression attack with different QF The BERs of the recovered watermarks are smaller and generally below 0.02 and the corresponding NC values are always greater than 0.98 for can be chosen according to the real situation by user thus enhancing the feasibility of this algorithm 28 TABLE IV PERFORMAN CE COMPARISON BETWEEN THIS SCHEME AND PAPER AF T ER JP EG-COMPR ESSION AT TACK JP EG Thi s Paper Recover ed Thi s Paper Paperl51 Q F NC W aterm ark HER HER 90 1.0000 MUST 0 0.0019 If:ilA 70 1.0000 MUST 0 0.01758 0.0469 No operation 
III 
t _ 
  
MUST MUST 11  
 


dierent, as shown in Figure 9 Figure 7: Two digerent, but similar, data sets Figure 8: The power spectrum for both of the data sets in Figure 3 With wavelet analysis, the two data sets shown in Figure 7 will have completely dierent wavelet decompositions, with larger magnitude coecients in the location of the ?bump?. However, with the use of the correct basis \(namely, a basis with approximation order 2 or above in Figure 7 and the data shown at the top of Figure 9 will have exactly the same wavelet decomposition This property can be useful when trying to analyze data overlaid upon other background data 1.3 Wavelets vs. Multiwavelets The concept of a scaling function can be generalized to a vector of functions, called a scaling Proceedings of the 42nd Hawaii International Conference on System Sciences - 2009 3 vector. A scaling vector 1> = = = > !u a dilation equation of its own  s 2 X q5Z fq 2{ q 3 for some sequence of u  u matrices, and the entire set m\({ q 4 is a linearly independent set. Scaling vectors are said to be orthogonal if the sequence of matrices fq is nite and the components of satisfyZ R l q  1 when l = m, q = 0 0 otherwise Figure 9: The same data set with added linear data, and its power spectrum Scaling vectors still establish MRA?s, with the set given in \(4 structure, there will exist a vector of functions 1> = = = > #u 


plement of Y0 in Y1, denoted Z0, that will necessary satisfy its own dilation equation  s 2 X q5Z gq 2{ q 5 for some nite sequence of u  u matrices gq. As before, when using an orthogonal scaling vector, the matrix coecients can be used to construct perfectreconstruction lters for the decomposition and reconstruction of the signal in Y0 There are several advantages to using multiwavelets for analysis over single wavelets. The Haar scaling function dened in \(2 ure 1 is the only single scaling function to have any symmetry/anti-symmetry properties. However as we shall see in the next section, we may build scaling vectors such that each function in the vector has symmetry/anti-symmetry properties. Also each single scaling function ! must necessarily satisfy the condition thatZ R  This is not true for all of the functions in a scaling vector, but for only one of the functions. \(The antisymmetric members of the scaling vector would not satisfy this criteria, for example, so not all of the scaling vector functions could be anti-symmetric And lastly, for the class of scaling vectors that we will illustrate in this paper, it is very easy to build boundary functions and still maintain orthogonality. With the exception of the Haar basis, if you truncate a single scaling function supported on [d> e to a shorter integer-length interval, the function will no longer maintain its orthogonality to other truncated functions. The scaling vectors shown in Section 2, all of which are supported over an interval no larger than [1> 1], have the property that they are orthogonal \(or in the last basis shown, can be made orthogonal with a simple procedure both to the interval [1> 0] and [0> 1], meaning that the functions, when truncated at { = 0 and normalized, are still part of an orthogonal basis set on a bounded region Multiwavelets do have one disadvantage over the single wavelet constructions: the lters can not gen 


erally be applied directly to the raw data without losing approximation order. \(Much work has been done in creating balanced scaling vectors that can be applied directly to data. See [1], [7], and [8] for more details of the data, one has to rst convert the raw data to basis coecients in the Y0 space, called preltering, and if reconstructing the data, convert the basis coecients back into data, called postltering. Ideally, a prelter will preserve the o2-norm of the data called an ruwkrjrqdo prelter, as well as preserve the polynomial order of the data, but orthogonal prelters that preserve approximation order of the basis are sometimes hard to nd. \(They also have issues on bounded regions. See [5] for an excellent introduction to preltering nal prelter is more necessary in image compresProceedings of the 42nd Hawaii International Conference on System Sciences - 2009 4 sion applications than in pattern recognition. We are able to use a relatively simple non-orthogonal prelter, called a quasi-interpolation prelter, that maps the data to basis coecients in Y0 so that the combination of basis functions interpolates data sampled from polynomials up to the approximation order of the basis, and comes close to interpolating non-polynomial data 2. Useful Bases There are a number of orthogonal multiwavelet bases that have been developed. \(See [9] and [10 for some other examples the ones presented here have the advantage of being easily applied to bounded data, but they also have another advantage. The following bases all generate spaces that contain spline spaces; that is, piecewise polynomial spaces over integer knots that meet certain match-up conditions at the integers. We use the notation Sug\(Z polynomials of degree g that have equal uth derivatives at integer knots, where the 0th derivative is understood to be the function value. Thus, while we will refer to the approximation order n of the following bases, it it important to realize that the Y0 space generated by the bases will also contain piecewise polynomials of degree n  1 that are either continuous at integer values, or in the case of the last basis, have one derivative at integer values 2.1 GHM Basis The GHM basis rst appeared in [3], and was re 


constructed from a macroelement perspective in [4 and are illustrated in Figure 10. This scaling vector 1> !2 Y0 space that it generates also includes the spline space S01 \(Z 1 !2 Figure 10: The GHM scaling vector The scaling vector satises equation \(3 the following matrix coecients f2 0  120 0 0  f1 3 s 2 20 9 20 0 0  f0 s 2 2 9 20 0 3 s 2 10  f1  3 s 2 20 1 20 4 5 3 s 2 


10   The function values needed to interpolate data or otherwise develop prelters are 1\(1 1 0 1 1  1 2  1  1 2  3 s 3 10 and !2  1 2   4 s 6 5  Orthonormal basis elements for the left and right boundaries of a data set are constructed by keeping the right and left half of !1, respectively, and normalizing; that is O1 s 2!1"[0>1] and !U1 s 2!1"[1>0 respectively. Their decomposition lters reect this normalization in all but the entries corresponding to dilated versions of these functions The multiwavelet 1> #2 the GHM scaling vector is illustrated in Figure 11 and satises the equation \(5 trix coecients g2 


0 120 0 s 2 20  g1  3 s 2 20 9 20 3 10 9 s 2 20  g0 s 2 2 9 20 0 9 s 2 20  g1  3 s 2 20 1 20 310 s 2 20   Only truncated and normalized versions of the symmetric #1 are needed at the boundaries O1 s 


2#1"[0>1] and #U1 s 2#1"[1>0 on the left and right, respectively 1 #2 Figure 11: The GHM multiwavelet Proceedings of the 42nd Hawaii International Conference on System Sciences - 2009 5 2.2 Approximation-Order-4 Basis The groundwork for this basis was laid in [2 although the scaling vector was not explicitly constructed in that paper. The scaling vector  1> !2> !3> !4 approximation order 4. The Y0 space that it generates also includes the spline space S03\(Z one may notice that !2 and !3 are quadratic and cubic polynomials, respectively, restricted to [0> 1 and normalized 1 2 3 4 Figure 12: An approximation-order-4 scaling vector The scaling vector satises the dilation equation \(3 ing vector. However, the four 4  4 matrix coecients are too large to provide here, and are available instead from the author?s website www.wku.edu/?bruce.kessler, as are the function values needed to interpolate data or otherwise develop prelters As before, orthonormal basis elements for the left and right boundaries of a data set are constructed by keeping the right and left half of !1 respectively, and normalizing; that is O1 s 2!1"[0>1] and !U1 s 2!1"[1>0 respectively. Their decomposition lters reect this normalization in all but the entries corresponding to dilated versions of these functions The multiwavelet 1> #2> #3> #4 ated with this scaling vector is illustrated in Fig 


ure 13, with the matrix solutions to the dilation equation \(5 Again, only truncated and normalized versions of the symmetric #1 are needed at the boundaries O1 s 2#1"[0>1] and #U1 s 2#1"[1>0 on the left and right, respectively 1 2 3 4 Figure 13: The multiwavelet associated with the scaling vector in Section 2.2 2.3 Dierentiable Basis with Approximation Order 4 Each of the bases shown in the previous sections include a continuous spline space, but the Y0 space in each case also contains much more than that With each basis, Y0 will also contain functions that look like the left and right halves of the !1 function in that particular scaling vector. Hence, each approximation space, even at the lowest resolution will contain functions that have at least one nondierentiable ?corner?. This may not be desirable Proceedings of the 42nd Hawaii International Conference on System Sciences - 2009 6 especially if the points of interest in the original signal happen to fall on these corners at every resolution \(for example, at the midpoint of the data set basis \(i.e., has no corners A scaling vector was developed by the author in 6] that has approximation order 4, and generates a space that contains the spline space S13\(Z is, the space of piecewise cubic polynomials that are both continuous and dierentiable at the integer knots. This scaling vector 1> !2> !3> !4 is illustrated in Figure 14. As with the basis discussed in Section 2.2, the matrix coecients that satisfy the dilation equation \(3 are available on the author?s website, as are the function values needed to interpolate data or otherwise develop prelters. Left- and right-hand versions of both !1 and 2 can be created to handle bounded data 


1 !2 3 !4 Figure 14: A digerentiable approximation-order-4 scaling vector The multiwavelet 1> #2> #3> #4 ated with this scaling vector is illustrated in Figure 15, with the matrix solutions to the dilation equation \(5 The website also contains the matrices needed for lter construction of the left and right boundary wavelets 1 #2 3 #4 Figure 15: The multiwavelet associated with the scaling vector in Section 2.3 3. Pattern Matching The premise behind using wavelets for pattern matching is that the wavelet decomposition for the pattern for which you are searching and for the pattern added to data sampled from a polynomial of degree less than the approximation order of your scaling vector will be equal. For example, the wavelet decompositions for both data sets shown in Figure 16 will be identical when using either of the bases discussed in Sections 2.2 and 2.3. It is necessary that the pattern not be in the lowest-resolution approximation space, so that it will not have a wavelet decomposition with only 0 coecients. This problem is rare, but if it occurs, it is remedied by either continuing the decomposition to an even lowerresolution space, or by using a dierent scaling vector of lower approximation order In most cases, the pattern will not be overlaid upon perfectly polynomial data, and so, the wavelet decompositions will not match exactly. However, if the pattern is prominent enough in the signal so that the root mean square error \(UPVH new decomposition {gl} when compared to the decomposition {gl } of the original pattern, as dened Proceedings of the 42nd Hawaii International Conference on System Sciences - 2009 7 by UPVH vuuuut QX l=1 gl  gl Q 


is suciently small, then the pattern will still be detected Figure 16: Pattern data \(top data obscured by cubic polynomial data bottom When using a single scaling function and wavelet are used in applications, each successively smoother approximation of the data stretches the support of the basis functions, eectively drawing more data from outside the region where the pattern actually occurs. By using the scaling vectors and multiwavelets mentioned in Section 2, we are able to analyze data on a bounded region, and ignore data outside of that region 3.1 When to Use Wavelets Wavelet decompositions can be used to nd patterns in any type of data, but there are no advantages to using them for exact pattern matching. For example, if searching for the word ?the? in a text le or in packet data, we have to search for the exact ASCII values 116, 104, and 101 in succession Changing those values, even by a constant amount changes the word. Also, to apply the wavelet bases mentioned in Section 2, we need 2q + 1 data values for some integer q A 1 for the DGM and the approximation-order-4 basis, and 2q+2 data values for some integer q A 1 for the basis in Section 2.3 so we would have to pad the target pattern with spaces. This type of search can be conducted much more eciently using other search methods, such as Bloom lters, etc However, for quantitative data like packet trac dependent upon time, multiwavelets have the potential to spot patterns that are not immediately noticable to the human eye, such as in the bottom graph of Figure 16. The following section gives an example of how multiwavelets can be used to detect a ?low and slow? pattern caused by data exltration 3.2 Trac Analysis Example Suppose that we have a corrupted computer and we are aware through previous experience that this particular piece of malevolent code tends to sneak? data out under the ?TCP? protocol in the following pattern a single packet of size 256 bytes, followed approximately 1 second later by another packet of size 512 bytes one second later, four packets of size 256 bytes are sent with a quarter second gap between 


the packets, and one quarter-second later, three packets of size 512 bytes are sent, followed one-quarter second later by one packet of size 256 bytes The accumulated bytes sent with respect to time in seconds are shown in Figure 17 Total Bytes Seconds Figure 17: Accumulated bytes for the example pattern The packets described above have been inserted into a set of network trac packet collected from the author?s laptop over roughly 4 minutes of usage starting at w = 240 seconds. The total accumulated outgoing bytes are illustrated in Figure 18. To apply the basis looking for this specic pattern, we Proceedings of the 42nd Hawaii International Conference on System Sciences - 2009 8 accumulate the bytes on quarter-second intervals and generate a wavelet decomposition for a sliding 4-second window, which is compared to the original pattern?s decomposition with the UPVH. The UPVH for the dierent starting times are shown in Figure 19. Note the low value of the UPVH at w = 240 seconds, indicating a close match to our target pattern at that time Total Bytes Seconds Figure 18: Accumulated outgoing bytes of a sample usage period plus the packets in our pattern UPVH Seconds Figure 19: UPVH values \(less than 50 blocks of data with digerent starting times Note the low value of the UPVH at w = 240 seconds, indicating a close match to our target pattern at that time In fairness, this method of nding patterns has many of the same weaknesses found in other signature-matching approaches. The pattern has to be known ahead of time, which means that this detection scheme would still be vulnerable to rst-time attacks. Also, a completely innocuous data ow occurring with very similiar timing and quantities as our pattern will still cause a low UPVH value, possibly causing a false-positive alert. We do claim 


however, that we have a greater capacity for nding patterns in quantiable amounts that are obscured by standard network trac. Also, we can adjust the sensitivity of the search without changing the signature for which we are searching, by adjusting the threshold of the UPVH?s for which an alert is issued. Thus, statistical techniques and adaptive learning can be used to help develop optimal threshold levels for a particular pattern 4. Conclusion Wavelet analysis holds an as-of-yet untapped potential for analyzing usage patterns in network trac ows, due to their ability to lter out data up to a given approximation order. Neither simple character searches nor Fourier analysis has this capability. Also, while Fourier analysis generally gives only frequency information within an analysis window, wavelet analysis gives some amount of both frequency information and the location of that frequency activity. The additional information comes at no additional computational costs, since the bases are generally applied by convolving matrix lters over the data \(repeated matrix multiplication over sliding blocks of data tiwavelet bases introduced in this document should prove to be particularly useful in pattern-matching applications, due to their short support \(that is, non-zero only over a small interval the inclusion of splines in the approximation spaces instead of just polynomials, and the ability to use them on time series with left and right boundaries The author is currently working with computer scientists at the CyberDefense Lab \(CDL at Western Kentucky University to develop software that will utilize these bases in network security, intrusion-detection, and data-extrusion applications. Once developed, we will study the eectiveness of this type of analysis in detecting malicious behavior as compared to the more commonly used techniques, with the hope of improving detection capabilities while maintaining a low false-positive rate. The software will initially be tested in the CDL?s sandbox while running attacks from its attack library with various background usage scripts being implemented, but will eventually move to less controlled network environments Acknowledments: This work supported in part by the NACMAST consortium under contract 


EWAGSI-07-SC-0003 Proceedings of the 42nd Hawaii International Conference on System Sciences - 2009 9 References 1] C. K. Chui and Q. T. Jiang, ?Multivariate Balanced Vector-Valued Renable Functions?, in: V. W. Haussmann, K. Jetter, M Reimer, and J. Sto¨ckler \(Eds velopment in Multivariate Approximation, vol 145, Birkha¨user Verlag, Basel \(2003 102 2] G. Donovan, J. Geronimo, and D. Hardin Intertwining Multiresolution Analyses and the Construction of Piecewise Polynomial Wavelets?, SIAM J. Math. Anal. 27\(6 1996 1791?1815 3] J. Geronimo, D. Hardin, and P. Massopust Fractal Functions and Wavelet Expansions Based on Several Scaling Functions?, J. Approx. Theory 78:3 \(1994 4] D. Hardin and B. Kessler, ?Orthogonal Macroelement Scaling Vectors and Wavelets in 1-D?, Arab. J. Sci. Eng. Sect. C \(Theme Issue: Wavelet and Fractal Methods in Science and Engineering: Part 1 2003 5] D. Hardin and D. Roach, ?Multiwavelet Prelters I: Orthogonal Prelters Preserving Approximation Order s  2?, IEEE Trans. Circuits Syst. II: Analog Digital Signal Proces 45\(8 1998 6] B. Kessler, ?An Orthogonal Scaling Vector Generating a Space of F1 Cubic Splines Using Macroelements?, J. Concrete Appl. Math Special Issue on Wavelets and Applications 4\(4 2006 7] J. Lebrun and M. Vetterli, ?Balanced Multiwavelet Theory and Design?, IEEE Trans. Signal Process. 46\(4 1998 8] J. Lebrun and M. Vetterli, ?High Order Balanced Multiwavelets?, in Proc. IEEE Int. Conf. Acoust., Speech, Signal Processing ICASSP May 1998 1532 9] J. Lian, ?Armlets and Balanced Multiwavelets Flipping Filter Construction?, IEEE Trans Signal Process. 53\(5 2005 10] I. W. Selesnick, ?Balanced GHM-like Multiscaling Functions?, IEEE Signal Process. Lett 6\(5 1999 


Proceedings of the 42nd Hawaii International Conference on System Sciences - 2009 10 


The HyspIRI mission utilizes innovative techniques to both reduce the amount of data that must be transmitted to the ground and accommodate the required data volume on the ground The infrastructure and techniques developed by this mission will open the door to future high data volume science missions The designs presented here are the work of the authors and may differ from the current HyspIRI mission baseline A CKNOWLEDGMENTS This research was carried out at the Jet Propulsion Laboratory California Institute of Technology and was sponsored by the Space Grant program and the National Aeronautics and Space Administration R EFERENCES  K W ar\002eld T  V  Houten C Hee g V  Smith S Mobasser B Cox Y He R Jolly C Baker S Barry K Klassen A Nash M Vick S Kondos M Wallace J Wertz Chen R Cowley W Smythe S Klein L Cin-Young D Morabito M Pugh and R Miyake 223Hyspiri-tir mission study 2007-07 002nal report internal jpl document,\224 TeamX 923 Jet Propulsion Laboratory California Institute of Technology 4800 Oak Grove Drive Pasadena CA 91109 July 2007  R O Green 223Hyspiri summer 2008 o v ervie w  224 2008 Information exchanged during presentation  S Hook 2008 Information e xchanged during meeting discussion July 16th  R O Green 223Measuring the earth wi th imaging spectroscopy,\224 2008  223Moore s la w Made real by intel inno v ation 224 http://www.intel.com/technology/mooreslaw/index.htm  T  Doggett R Greele y  S Chein R Castano and B Cichy 223Autonomous detection of cryospheric change with hyperion on-board earth observing-1,\224 Remote Sensing of Environment  vol 101 pp 447\226462 2006  R Castano D Mazzoni N T ang and T  Dogget 223Learning classi\002ers for science event detection in remote sensing imagery,\224 in Proceedings of the ISAIRAS 2005 Conference  2005  S Shif fman 223Cloud detection from satellite imagery A comparison of expert-generated and autmatically-generated decision trees.\224 ti.arc.nasa.gov/m/pub/917/0917 Shiffman  M Griggin H Burk e D Mandl and J Miller  223Cloud cover detection algorithm for eo-1 hyperion imagery,\224 Geoscience and Remote Sensing Symposium 2003 IGARSS 03 Proceedings 2003 IEEE International  vol 1 pp 86\22689 July 2003  V  V apnik Advances in Kernel Methods Support Vector Learning  MIT Press 1999  C Bur ges 223 A tutorial on support v ector machines for pattern recognition,\224 Data Mining and Knowledge Discovery  vol 2 pp 121\226167 1998  M Klemish 223F ast lossless compression of multispectral imagery internal jpl document,\224 October 2007  F  Rizzo 223Lo w-comple xity lossless compression of h yperspectral imagery via linear prediction,\224 p 2 IEEE Signal Processing Letters IEEE 2005  R Roosta 223Nasa jpl Nasa electronic parts and packaging program.\224 http://nepp.nasa.gov/docuploads/3C8F70A32452-4336-B70CDF1C1B08F805/JPL%20RadTolerant%20FPGAs%20for%20Space%20Applications.pdf December 2004  I Xilinx 223Xilinx  Radiation-hardened virtex-4 qpro-v family overview.\224 http://www.xilinx.com/support/documentation data sheets/ds653.pdf March 2008  G S F  Center  223Tdrss o v ervie w  224 http://msp.gsfc.nasa.gov/tdrss/oview.html 7  H Hemmati 07 2008 Information e xchanged during meeting about LaserComm  223W orldvie w-1 224 http://www digitalglobe.com/inde x.php 86/WorldView-1 2008  223Sv albard ground station nor way.\224 http://www.aerospacetechnology.com/projects/svalbard 7 2008  223Satellite tracking ground station 224 http://www.asf.alaska.edu/stgs 2008  R Flaherty  223Sn/gn systems o v ervie w  224 tech rep Goddard Space Flight Center NASA 7 2002  223Geoe ye-1 f act sheet 224 http://launch.geoeye.com/launchsite/about/fact sheet.aspx 2008  L-3 Communications/Cincinnati Electronics Space Electronics 7500 Innovation Way Mason OH 45040 T-720 Transmitter  5 2007 PDF Spec Sheet for the T720 Ku-Band TDRSS Transmitter  L-3 Communications/Cincinnati Electronics Space Electronics 7500 Innovation Way Mason OH 45040 T-722 X-Band  7 2007 PDF Spec Sheet for the T-722  J Smith 07 2008 Information e xchanged during meeting about GDS  J Carpena-Nunez L Graham C Hartzell D Racek T Tao and C Taylor 223End-to-end data system design for hyspiri mission.\224 Jet Propulsion Laboratory Education Of\002ce 2008  J Behnk e T  W atts B K obler  D Lo we S F ox and R Meyer 223Eosdis petabyte archives Tenth anniversary,\224 Mass Storage Systems and Technologies 2005 Proceedings 22nd IEEE  13th NASA Goddard Conference on  pp 81\22693 April 2005 19 


 M Esf andiari H Ramapriyan J Behnk e and E So\002nowski 223Evolving a ten year old data system,\224 Space Mission Challenges for Information Technology 2006 SMC-IT 2006 Second IEEE International Conference on  pp 8 pp.\226 July 2006  S Marle y  M Moore and B Clark 223Building costeffective remote data storage capabilities for nasa's eosdis,\224 Mass Storage Systems and Technologies 2003 MSST 2003 Proceedings 20th IEEE/11th NASA Goddard Conference on  pp 28\22639 April 2003  223Earth science data and information system esdis project.\224 http://esdis.eosdis.nasa.gov/index.html  M Esf andiari H Ramapriyan J Behnk e and E So\002nowski 223Evolution of the earth observing system eos data and information system eosdis\\224 Geoscience and Remote Sensing Symposium 2006 IGARSS 2006 IEEE International Conference on  pp 309\226312 31 2006Aug 4 2006  223Earth science mission operations esmo 224 http://eos.gsfc.nasa.gov/esmo  E Masuoka and M T eague 223Science in v estig ator led global processing for the modis instrument,\224 Geoscience and Remote Sensing Symposium 2001 IGARSS 01 IEEE 2001 International  vol 1 pp 384\226386 vol.1 2001  M Esf andiari H Ramapriyan J Behnk e and E So\002nowski 223Earth observing system eos data and information system eosdis 227 evolution update and future,\224 Geoscience and Remote Sensing Symposium 2007 IGARSS 2007 IEEE International  pp 4005\2264008 July 2007  D McAdam 223The e v olving role of tape in the data center,\224 The Clipper Group Explorer  December 2006  223Sun microsystems announces w orld s 002rst one terabyte tape storage drive.\224 http://www.sun.com/aboutsun/pr/200807/sun\003ash.20080714.2.xml July 2008  223P anasas 227 welcome 224 http://www panasas.com  R Domikis J Douglas and L Bisson 223Impacts of data format variability on environmental visual analysis systems.\224 http://ams.confex.com/ams/pdfpapers/119728.pdf  223Wh y did nasa choose hdf-eos as the format for data products from the earth observing system eos instruments?.\224 http://hdfeos.net/reference/Info docs/SESDA docs/NASA chooses HDFEOS.php July 2001  R E Ullman 223Status and plans for hdfeos nasa's format for eos standard products.\224 http://www.hdfeos.net/hdfeos status HDFEOSStatus.htm July 2001  223Hdf esdis project.\224 http://hdf.ncsa.uiuc.edu/projects/esdis/index.html August 2007  223W elcome to the ogc website 224 http://www.opengeospatial.org 2008  223Open gis Gis lounge geographic information systems.\224 http://gislounge.com/open-gis Christine M Hartzell received her B.S in Aerospace Engineering for Georgia Institute of Technology with Highest Honors in 2008 She is currently a PhD student at the University of Colorado at Boulder where she is researching the impact of solar radiation pressure on the dynamics of dust around asteroids She has spent two summers working at JPL on the data handling system for the HyspIRI mission with particular emphasis on the cloud detection algorithm development and instrument design Jennifer Carpena-Nunez received her B.S in physics in 2008 from the University of Puerto Rico where she is currently a PhD student in Chemical Physics Her research involves 002eld emission studies of nanostructures and she is currently developing a 002eld emission setup for further studies on nano\002eld emitters The summer of 2008 she worked at JPL on the HyspIRI mission There she was responsible for the science analysis of the data handling system speci\002cally de\002ning the data level and processing and determining potential mission collaborations Lindley C Graham is currently a junior at the Massachusetts Institute of Technology where she is working towards a B.S in Aerospace Engineering She spent last summer working at JPL on the data handling system for the HyspIRI mission focusing on developing a data storage and distribution strategy 20 


David M Racek is a senior working toward a B.S in Computer Engineering at Montana State University He works in the Montana State Space Science and Engineering Laboratory where he specializes in particle detector instruments and circuits He spent last summer working at JPL on compression algorithms for the HyspIRI mission Tony S Tao is currently a junior honor student at the Pennsylvania State University working towards a B.S in Aerospace Engineering and a Space Systems Engineering Certi\002cation Tony works in the PSU Student Space Programs Laboratory as the project manager of the OSIRIS Cube Satellite and as a systems engineer on the NittanySat nanosatellite both of which aim to study the ionosphere During his work at JPL in the summer of 2008 Tony worked on the communication and broadcast system of the HyspIRI satellite as well as a prototype Google Earth module for science product distribution Christianna E Taylor received her B.S from Boston University in 2005 and her M.S at Georgia Institute of Technology in 2008 She is currently pursing her PhD at the Georgia Institute of Technology and plans to pursue her MBA and Public Policy Certi\002cate in the near future She worked on the ground station selection for the HyspIRI mission during the summer of 2008 and looks forward to working at JPL in the coming year as a NASA GSRP fellow Hannah R Goldberg received her M.S.E.E and B.S.E from the Department of Electrical Engineering and Computer Science at the University of Michigan in 2004 and 2003 respectively She has been employed at the Jet Propulsion Laboratory California Institute of Technology since 2004 as a member of the technical staff in the Precision Motion Control and Celestial Sensors group Her research interests include the development of nano-class spacecraft and microsystems Charles D Norton is a Principal Member of Technical Staff at the Jet Propulsion Laboratory California Institute of Technology He received his Ph.D in Computer Science from Rensselaer and his B.S.E in Electrical Engineering and Computer Science from Princeton University Prior to joining JPL he was a National Research Council resident scientist His work covers advanced scienti\002c software for Earth and space science modeling with an emphasis on high performance computing and 002nite element adaptive methods Additionally he is leading efforts in development of smart payload instrument concepts He has given 32 national and international keynote/invited talks published in numerous journals conference proceedings and book chapters He is a member of the editorial board of the journal Scienti\002c Programming the IEEE Technical Committee on Scalable Computing a Senior Member of IEEE recipient of the JPL Lew Allen Award and a NASA Exceptional Service Medal 21 


this paper, we only generate the size-2 patterns in the BFS phase. It will be interesting to investigate the impact on the performance if the ?rst phase is stopped at a deeper level Also, the projection is a very ef?cient method for ?nding patterns, especially for parallel implementation of pattern mining algorithms [1]. We plan to adapt the projection ideas into our algorithm and design an ef?cient parallel algorithm for mining maximal hyperclique patterns References 1] R. Agarwal, C. Aggarwal, and V. Prasad. A Tree Projection Algorithm For Generation of Frequent Itemsets. pages 350 371, Feb 2001 2] R. Agrawal, T. Imielinski, and A. Swami. Mining Association Rules between Sets of Items in Large Databases. In Proc. of the ACM SIGMOD Conference on Management of Data, pages 207–216,May 1993 3] R. Agrawal and R. Srikant. Fast Algorithms for Mining Association Rules. In Proc. of the 20th Int’l Conference on Very LargeData Bases, 1994 4] R. Bayardo. Ef?ciently mining long patterns from databases In Proc. of the ACM SIGMOD Conference, 1998 5] R. Bayardo and R. Agrawal. Mining the Most Interesting Rules. In Proc. of the ACM SIGKDD Conference, 1999 6] D. Burdick, M. Calimlim, and J. Gehrke. Ma?a: AMaximal Frequent Itemset Algorithm for Transactional Databases. In Proc. of IEEE Conf. on Data Engineering, 2001 7] Y. Huang, H. Xiong, W. Wu, and Z. Zhang. A Hybrid Approach for Mining Maximal Hyperclique Patterns. In In Technical Report UTDCS-34-04, Department of computer science, University of Texas - Dallas, 2004 8] J.Han, J.Pei, and Y. Yin. Mining Frequent Patterns without Candidate Generation. In Proc. of the ACM SIGMOD International Conference on Management of Data, 2000 9] M.J.Zaki and C.Hsiao. ChARM: An ef?cient algorithm for closed itemset mining. In Proc. of 2nd SIAM International Conference on Data Mining, 2002 10] R.Rymon. Search through Systematic Set Enumeration. In Proc. Third Int’l Conference on Principles of Knowledge Representation and Reasoning, 1992 11] H. Xiong, M. Steinbach, P.-N. Tan, and V. Kumar. HICAP: Hierarchial Clustering with Pattern Preservation. In Proc. of 2004 SIAM International Conference on Data Mining \(SDM 12] H. Xiong, P.-N. Tan, and V. Kumar. Mining Strong Af?nity Association Patterns in Data Set with Skewed Support. In Proc. of the Third IEEE International Conference on Data Mining \(ICDM Proceedings of the 16th IEEE International Conference on Tools with Artificial Intelligence \(ICTAI 2004 1082-3409/04 $20.00 © 2004 IEEE 





