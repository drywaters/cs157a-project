Privacy Preserving Classiìcation in Two-Dimension Distributed Data Luong The Dung 002 HoTuBao 003  Nguyen The Binh 002 and Tuan-Hao Hoang 004 002 Information Technology Center VietNam Government Information Security Commission 003 Japan Advanced Institute of Science and Technology Nomishi Ishikawa Japan 004 Faculty of Information Technology Le Quy Don Technical University Hanoi Vietnam 
Abstract Within the context of privacy preserving data mining several solutions for privacy-preserving classiìcation rules learning such as association rules mining have been proposed Each solution was provided for horizontally or vertically distributed scenario The aim of this work is to study privacy-preserving classiìcation rules learning in two-dimension distributed data which is a generalisation of both horizontally and vertically distributed data In this paper we develop a cryptographic solution for classiìcation rules learning methods The crucial step in the proposed solution is the privacy-preserving computation of frequencies of 
a tuple of values which can ensure each participantês privacy without loss of accuracy We illustrate the applicability of the method by using it to build the privacy preserving protocol for association rules mining and ID3 decision tree learning I I NTRODUCTION Data mining has emerged as a signiìcant technology for gaining knowledge from vast quantities of data Data mining allows us to analyse personal data or organisational data such as customer records criminal records medical history credit records etc However analyzing such data creates threats to privacy and thus might prevent data mining works The 
challenge then is whether we can obtain results of mining while still preserve the data secrecy Privacy preserving data mining PPDM techniques have been proposed to address this type of problem Generally there are mainly two kinds of privacy preserving data mining approaches the perturbation-based approach and the cryptography-based approach The methods based on perturbation e.g 3 23 ha v e been pro v e d t o b e efìcient but have a tradeoff between privacy and accuracy The methods based on cryptography e.g 20 11 can safely preserve privacy without loss of accuracy but 
have high complexity and high communication cost These privacy preserving data mining methods have been presented for various scenarios in which the general idea is to allow mining datasets distributed across multiple parties without disclosing each partyês private data Classiìcation is an important data mining technique that has found applications in various areas such as business education and defense Within the context of privacy preserving data mining several privacy-preserving classiìcation solutions have been proposed e.g 10 and 24 The goal of these works is for one of the participants to obtain the global 
classiìcation model from the joint data set of all parties The requirement of these works is that no information about private data except in the classiìcation model will be disclosed Each privacy preserving classiìcation solution can be applied in a particular privacy preserving data mining scenario In 10 and 24 the y de v eloped a p ri v a c y preserving classiìcation protocols from the vertically distributed data based on a secure scalar product method These privacy preserving protocols have been applied for learning naive Bayes classiìcation association rules and decision trees In  the pri v ac y preserving classiìcation w as addressed for horizontally distributed data by computing the secure sum 
of all local frequencies of participating parties Much more complicated solutions have been proposed for the fully distributed setting 22 These w orks aimed to allo w a miner to learn classiìcation rules from a data set distributed across a large number of users while preserving privacy of each userês private data Some randomization-based solutions proposed in 3  16 can be used in v a rious distrib uted data scenarios The basic idea of these solutions is that every user perturbs its data before sending it to the miner The miner then can reconstruct the original data to obtain the mining results with some bounded error These solutions allow each user to operate 
independently and the perturbed value of a data element does not depend on those of the other data elements but only on its initial value Although these solutions are high efìcient their use generally involves a tradeoff between privacy and accuracy i.e if we require more privacy the miner loses more accuracy in the data mining results and vice-versa In this paper we study a privacy preserving classiìcation rules learning in two-dimension distributed data which is a generalization of both horizontally and vertically distributed 
2010 Second International Conference on Knowledge and Systems Engineering 978-0-7695-4213-3/10 $25.00 © 2010 IEEE DOI 10.1109/KSE.2010.38 96 


data The generality of this model would be experimental proved to be better suited at practical settings in which data may be mostly but not completely vertically or horizontally distributed The contributions of the work include 002 The development of a cryptographic approach to privacy preserving classiìcation learning in two-dimension distributed data  We proposed a protocol for privacy preserving frequency computation The protocol ensures each partiesês privacy without loss of accuracy In addition it is efìcient and based on centered management model 002 The applicability of the approach  To illustrate it we present the design and analysis of the privacy-preserving association rule mining and ID3 learning protocols The rest of this paper is organised as follows Section 2 presents the preliminaries In Section 3 we introduce a privacy preserving protocol for frequency mining We also prove the correctness and privacy properties of the protocol and present experimental results of the efìciency In Section 4 we use the protocol for frequency mining in Section 3 as a building block to design a privacy preserving protocols for association rule mining and ID3 learning We also evaluate the efìciency of these protocols in Section 4 The last section concludes our research work in this paper II P RELIMINARIES A Privacy preserving frequency mining problem Deìnition 1 Two-dimension distributed data A data set 002\003 includes 004 normal attributes 002 005 002 006 007\007\007\006 005 002 003 with 010 records 002\003 is distributed into 011 004 012 blocks where 002 005 011\013\004 and 002 005 012\013\010  The parties 014 003\004 with 015 003\004 006 007\007\007\006 011 and 016 003\004 006 007\007\007\006 012  Each party holds a block 002\003 003\004 containing information about certain attributes set 005 003 004 004 and certain records The 002\003 003\004 are such that 002 002\003 003\004 and 002\003 003 002 004  015 006 003 015 003  have the same attributes set 005 003 004 004 but parts of different records of 002\003  002 002\003 003\004 and 002\003 003\004 002  016 006 003 016 003  have disjoint attributes sets 005 003 004 004 and 005 003 004 002 004 but contain information about the same records of 002\003  We call 002\003 be a two-dimension distributed data set Privacy preserving frequency mining problem Inthis section we consider a scenario in which a party plays a role as a miner which mines the frequency of a tuples of attribute values from 002\003  Where 002\003 is called the joint data set of all parties Our aim is to design the distributed protocols to obtain the frequency while preserving privacy of each partyês data We consider privacy as protecting individual data records as well as protecting the frequency of the local tuples of each party Let 017 007\002 004 006 007\007\007\006 012 003 and 004 005\010 017 010\005 012  In general case we assume that the miner needs to compute the frequency of a data tuple  020  that consists 010 017 010 parts indexed in 017  Each part 020 004  016 011 017  consists of some values for some attributes 011 005 003 004 004  Note that each record 021\022 005  023 003\004 006 007\007\007\006 010  is partitioned into 012 parts where each part 021\022 005\004 consists of values for the attributes in set 005 003 004 004 and is owned by a party 014 003\004  We consider the map of each record 023 to 010 017 010 binary numbers as follows For each 016 011 017 024 005\004 003 002 004 006 if 020 004 012 021\022 005\004  005 006 otherwise Thus 002\003 is mapped to a binary matrix  025  that consists of 010 017 010 columns and 010 rows Note that if 020 012 021\022 005  all elements of the 023 006\007 row of the binary matrix have 004 that means 026 005 003 003 004 004 010 024 005\004 013\010 017 010 003\005  where each 024 005\004 is owned by a 014 003\004  Therefore our purpose is to design a protocol that allows the miner learning the number of records 023 to satisfy 026 005 003\005 while the party does not have to disclose the values 024 005\004  B Encryption scheme selection Our protocol requires each party to send private data to the miner In order to preserve privacy of each partyês data each party encrypts its data and then send the encrypted data to the miner The miner executes the protocol to obtain the frequency from the encrypted data We use the ElGamal cryptosystem  a public k e y c ryptosystem consists of three algorithms the key generation algorithm the encryption algorithm and the decryption algorithm In the ElGamal cryptosystem the key generation algorithm generates the parameters 006 027\006 030\006 031\006 032 007  where 031 be a generator for a cyclic group 027 of order 030  032 be a private key that is uniformly chosen from 002 005 006 004 006 007\007\007\006 030 013 002 003  The public key is 033 003 031 011 that are publicly known The encryption of message 012 011 the clear-text space 034 deìned as 035 006 012\006 036 007\003\006 012\033 012 010\011\012 030\006 031 012 010\011\012 030 007\003\006 022 003\002\004 006\022 003\005\004 007\003 022 where 036 is uniformly chosen from 002 005 006 004 006 007\007\007\006 030 013 002 003  Decryption of the cipher-text 022 with the private key 032 can be executed by computing 012 003 022 002 006 022 011 005 007 005 002  The encryption scheme is based on the computational difìculty of computing the discrete logarithm of group G Given a prime number 030  a generator 031 and an expression 031 013 010\011\012 030  it is computationally difìcult to nd the value 037  The ElGamal encryption is semantically secure under the Decisional Difìe-Hellman DDH Thus the encryption scheme has the indistinguishability property that any two different messages will have different cipher-texts since the random number 036 can take many different values The ElGamal encryption has a randomisation property to allow computing a different encryption from a given encryption 034  C Computation model Privacy preserving mining protocols implement among a set of semi-honest parities One of these parties play the special role which is called the miner to collect messages from all parties and compute the nal result We assume that all parties are online where each party has a communication channel with the miner To be applicable we require that the protocol can ensure users privacy in an environment that doesnêt have any secure channels between the party and the miner In addition it should not require any communication among the parties 
97 


In our solution 016 of the parties act as commodity parties that is called a moderator Moderators have the special duty of randomising the data for protecting privacy of each partyês data In order to make the protocol practical we divide all parties joint data sets into groups where each group has 012 records which is randomly chosen by all parties from their database The miner computes the frequency from one group at a time Our requirement is that each party should has its data at a time In other words the miner should compute the frequency of the data tuple from a group In contrast it should not know which frequency generated from which group record We assume that prior to the protocol each party has obtained the key pairs for the Elgamal encryption scheme and each partyês public key and the miner has known by members in the system D Deìnition of privacy The privacy preservation of the proposed protocol is based on the semi-honest security model In this model each party participating in the protocol has to follow rules using correct input and cannot use what it sees during the execution of the protocol to compromise security A general deìnition of the secure multi-party computation in the semi-honest model is stated in This deìnition w as deri v ed to mak e a simpliìed deìnition in the semi-honest model for privacy-preserving data mining in the fully distributed setting scenario 5 This scenario is similar to our computation model In this paper we consider the possibility that some corrupted parties share their data with the miner to derive the private data of the honest parties One requirement is that no other private information about the honest parties be revealed except the nal result In our model information known by parties is no more than information known by the miner Thus we do not have to consider the problem in which parties share information with each other A distribution ensemble  003 002  014 003 011 011 017 is a family of probability distributions indexed by some inìnite set 017 of binary strings We sometimes take 017 003 002 004 014 013 011 011 002 003 in which case the indices in 017 are viewed as natural numbers Deìnition 2 Computational indistinguishability Two ensembles  002\015\016 014\002  014 003 014 004 010 and  002\015\016 014\002  014 003 014 004 010 are computational indistinguishable denoted  017 014  if the following holds For every polynomial time algorithm 005  and every  005  there exists an integer 010 such that for all 011 015 010  010 014\036 006 005 006  014 007\003\004\007 013 014\036 006 005 006  014 007\003\004\007 010 013 004 011 017 For more general we assume that there are  parties involved in the frequency mining protocol in which a party plays the role as a miner Each party 014 003 has the input 004 003  where 004 003 can be an integer number or the set of the binary numbers The deìnition of privacy preserving in semi-honest model is presented as follows Deìnition 3 Assume that each party 014 003 has a private set of keys 002 003 and a public set of keys 035 003  A protocol for the above deìned frequency mining problem protects each userês privacy against the miner along with  corrupted parties in the semihonest model if for all  007\002 004 006 007\007\007\006  003 such that 010  010 003   there exists a probabilistic polynomial-time algorithm 034 such that 002 034 006 006 014 004 003 006\014 003 015 003 004 020 006\035 003 003 017 014\002  015 021\003\014\015\012\022 006 023 002 007 002 003 003 014 004 003 006\002 003 015 024 003 006\002 003 where 017 014 denotes computational indistinguishability Basically the deìnition 2 states that the computation is secure if the joint view of the miner and the corrupted parties during the execution of the protocol can be effectively simulated by a simulator The miner and the corrupted parties have observed in the protocol using only the result  the corrupted parties knowledge and the public keys Therefore the miner and the corrupted parties can not learn anything from   By the deìnition it indicates that there exists a simulator satisìed the above equation III P RIVACY PRESERVING FREQUENCY MINING IN TWO DIMENSION DISTRIBUTED DATA A Privacy preserving frequency mining protocol Our goal is that the miner should obtain a random permutation of the set  031 012 002 025 002   031 012 004 025 004  without knowing each 026 005 coming from which parties Where 036 003 is randomly chosen from 014\004 006 013 002\015 by all other parties Note that if we obtain this result the miner can be counted the number 026 005 003\005 that is equal with 031 012 005 025 005 003 031 007 003\004  Clearly when 026 005 006 003\005  031 012 005 025 005 is the random number the protocol does not leak any other information except the frequency To achieve this goal we use variants of the ElGamal encryption in which it replaces 012 with 031 021  As the result there are the following properties Property 1  The decryption algorithm is not efìcient when 012 is large however there exists an efìcient algorithm that uses the private key to decide whether a ciphertext decrypts to 1 or  031 007  That is suitable to our algorithms Property 2 It has the additive homomorphic property that can be used to perform computation on ciphertexts from different parts Property 3 It allows homomorphic computing of constant multiplication that can be performed without decrypting In our solution we assume that each party has a key pair 006 032 003 006\033 003 003 031 011 002 007 and there  of the 011\012 parties play the role as moderators Without loss of generality we assume in the sequel that the moderators are numbered from 004 to   In practice the choice of moderators can be arbitrary that depends on the requirement of privacy and the efìciency of the application Deìne 032 003 006 004 003 006\002 032 003 033 003 006 005 003 006\002 033 003 003 031 011 In our protocol the parties use the public value 033 as a public key to encrypt their data Therefore decrypting these 
98 


encryptions needs the private key 032  which is not known to any individual party We call 006 032\006 033 007 be the joint key pair Basically the idea of our protocol as follows 1 For each value 024 005\004 of the binary matrix the party holding the value 024 005\004 encrypts this value using the joint public key of moderators and sends this encryption to the miner Note that without the help of all moderators nobody can decrypt any of this encryption By additional monomorphic property of Elgamal scheme the miner connects all encryptions of the binary values 024 005\004 corresponding to the row 023 to obtain the encryption of 003 004 004 010 024 005\004  It then adds 031 005\010 010 010 to this encryption to obtain the encryption of 026 005 003 003 004 004 010 024 005\004 013\010 017 010 Atthe end of this step the miner obtains the 010 encryptions of 026 002  026 026 007 2 The miner sends the set of encryptions of 026 005  023 003 004 006 007\007\007\006 010  to moderators Each moderator 015  015 003\004 006 007\007\007\006   computes the encryption of each 026 003\005 003 036 003\005 026 005 and sends back to the miner Where 036 003\005 are non-zero elements of 027 chosen independently and uniformly at random The miner connects encryptions 026 003\005  015 003\004 006 007\007\006   to obtain an encryption of 026 003 005 003 026 005 003 006 003 006\002 036 003\005  Note that 026 003 005 has a 0 if and only if the original value 026 005 has a 0 On the other hand all non-zero elements in the original values have been changed to the randomized element As the result no extra information is leaked 3 The miner together with  moderators execute the  round to permute and randomise the set of the encryptions of 026 003 002 006 007\007\007\006 026 003 026  Note that ElGamal supports re-randomisation which means computing a different encryption of M from a given encryption of M A related operation is a permutation of the order of items Therefore it randomly rearrange the order of items If we rerandomise and permute a sequence of cipher-texts then we get another sequence of cipher-texts with the same multiset of clear-texts but in a different order Looking at these two sequences of cipher-texts the adversary cannot determine any information about the correspondence between the new cipher-text corresponding and the old cipher-text 4 Finally the moderators jointly help the miner to decrypt the received new encryptions which are in an independent order of the original encryptions The miner counts how many of the decryptions are equal to 004  031 007  This number is equal to the frequency of the tuple The detailed protocol is implemented in phases as follows 002 Phase 1 Data submission For 023 003\004 006 007\007\007\006 010  For each 016 011 017  the party holding 024 005\004 encrypts 024 005\004 using the public key 033  021 005\004 003\006 021 003\002\004 005\004 006\021 003\005\004 005\004 007\003\006 031 027 005\006 033 030 005\006 006\031 030 005\006 007 where  005\004 is chosen randomly from 014\005 006\030 013 004\015 and after that 021 005\004 is sent to the miner  The miner computes 022 005 003\006 022 003\002\004 005 006\022 003\005\004 005 007\003\006 031 005\010 010 010 005 004 004 010 021 003\002\004 005\004 006 005 004 004 010 021 003\005\004 005\004 007 002 Phase 2 Encryption randomisation  For 015 003\004 006 007\007\007\006   the miner sends  022 002  022 026 othe moderator 015  Each moderator 015 re-randomises the received encryptions for 023 003\004 006 007\007\007\006 010  021 003\005 003\006 021 003\002\004 003\005 006\021 003\005\004 003\005 007\003\006\006 022 003\002\004 005 007 012 002\005 006 006 022 003\005\004 005 007 012 002\005 007 where 036 003\005 is chosen uniformly from 014\005 006\030 013 004\015   For 023 003\004 006 007\007\007\006 010  each moderator 015 sets 022 003\005 003 021 003\005 and sends back to the miner  The miner computes For 023 003\004 006 007\007\007\006 010  022 005 003\006 022 003\002\004 005 006\022 003\005\004 005 007\003\006 006 004 003 006\002 022 003\002\004 003\005 006 006 004 003 006\002 022 003\005\004 003\005 007 002 Phase 3 Permutation For 023 003\004 006 007\007\007\006    At the beginning of this step the miner sends  022 002  022 026  to the moderator 015   Each moderator 015 permutes encryptions For 023 003 004 006 007\007\007\006 010  021 005 003\006 021 003\002\004 005 006\021 003\005\004 005 007\003\006 022 003\002\004 031 002 003 005 004 033 032 007 002 003 005 004 006\022 003\005\004 031 002 003 005 004 031 032\031 002 003 005 004 007 where 031 002 is an permutation on 002 004 006 007\007\006 010 003 and 005 is chosen independently and uniformly from 014\005 006\030 013 004\015   For 023 003\004 006 007\007\007\006 010  each moderator 015 sets 022 005 003 021 005 sends  022 002  022 026  back to the miner 002 Phase 4 Frequency computation  The miner sends  022 003\005\004 002  022 003\005\004 026  to all moderators  Each moderator 015 computes for 023 003\004 006 007\007\007\006 010  022 003\005\004 002 005 003 003 004 003\006 022 003\005\004 005 007 011 002 and sends 022 003\005\004 002 005 003 003 004 to the miner  The miner sets  003\005 and works as follows for 023 003\004 006 007\007\007\006 010  004 005 003 022 003\002\004 005  006 005 003 006\002 022 003\005\004 002 005 003 003 004 015 004 005 003\004   003  016\004\017  The miner outputs  B The correctness of the protocol Theorem 1 If all participants follow the protocol then the minerês result is a frequency  as description in Section 2.A Proof At the end of the rst step the miner obtains 022 005 003\006 022 003\002\004 005 006\022 003\005\004 005 007\003\006 031 002 006 003 010 027 005\006 005\010 010 010 033 002 006 003 010 030 005\006 006\031 002 006 003 010 030 005\006 007 003\006 031 025 005 033 033 005 006\031 033 005 007 Where denote 026 005 003 003 004 004 010 024 005\004 013\010 017 010 and 0 005 003 003 004 004 010  005\004 
99 


In Phase 2 the miner receives  022 003\005\004 002  022 003\005\004 026  from Phase 1 and randomises each 022 005  It obtains 022 005 003\006 022 003\002\004 005 006\022 003\005\004 005 007\003\006 006 004 003 006\002 022 003\002\004 003\005 006 006 004 003 006\002 022 003\005\004 003\005 007 003\006 006 004 003 006\002 031 025 005 012 002\005 033 033 005 012 002\005 006 006 004 003 006\002 031 033 005 012 002\005 007 003\006 031 025 005 002 011 002 005\002 012 002\005 033 002 011 002 005\002 033 005 004 012 002\005 006\031 033 005 002 011 002 005\002 012 002\005 007 In Phase 3 the protocol receives the set  022 003\005\004 002  022 003\005\004 026  and permutes this set 016 times Thus the miner obtains 022 005 003\006 022 003\002\004 031 003 005 004 006\022 003\005\004 031 003 005 004 007  where 1 006 023 007 is the nal result of the permutation of the 016 times 022 003\002\004 031 003 005 004 003 031 025 007 003 005 004 002 011 002 005\002 012 002\007 003 005 004 033 033 007 003 005 004 002 011 002 005\002 012 002\007 003 005 004 010 032 007 002 003 005 004 017 022 003\005\004 031 003 005 004 003 031 033 007 003 005 004 002 011 002 005\002 012 002\007 003 005 004 010 032 007 002 003 005 004 Therefore in Phase 4 the miner obtains 004 005 003 022 003\002\004 005  006 005 003 006\002 022 011 002 003 003 031 025 007 003 005 004 002 011 002 005\002 012 002\007 003 005 004 033 003 033 007 003 005 004 002 011 002 005\002 012 002\007 003 005 004 010 032 007 002 003 005 004 004 031 003 033 007 003 005 004 002 011 002 005\002 012 002\007 003 005 004 010 032 007 002 003 005 004 004 002 011 002 005\002 011 002 003 031 025 007 003 005 004 002 011 002 005\002 012 002\007 003 005 004 031 002 011 002 005\002 011 002 003 033 007 003 005 004 002 011 002 005\002 012 002\007 003 005 004 010 032 007 002 003 005 004 004 031 003 033 007 003 005 004 002 011 002 005\002 012 002\007 003 005 004 010 032 007 002 003 005 004 004 002 011 002 005\002 011 002 003 031 025 007 003 005 004 002 011 002 005\002 012 002\007 003 005 004 Thus if 004 005 003\004  022 005 is the encryption of 031 007 that means 026 005 003\005  It further follows that the tuple occurs at a record of the data set and so the frequency  is increased to 004  C The privacy of the protocol Theorem 2 The protocol in Subsection 3.A preserves the privacy of the honest parties against the miner and up to 011\012 013 002 corrupted parties as long as at least one of honest parties is a moderator Proof To prove this theorem we will design a simulator 034 that simulates the joint view of the miner and the corrupted users by a probabilistic polynomial-time algorithm Subsequently this simulator is combined with a simulator for the ElGamal cipher-texts to obtain a completed simulator To do so basically we show a polynomial-time algorithm for computing the joint view of the miner and the corrupted parties The computation of the algorithm is based on what the miner and the corrupted parties have observed in the protocol using only the result   the corrupted parties information and the public keys The algorithm outputs the simulated values for the encryptions generated by a simulator of ElGamal encryptions Clearly it sufìces to consider the case in which only one moderator   002  and one regular party   005  are honest Without loss of generality we assume that  002 is the moderator 004 We will show the simulator that its steps follow the protocolês steps Phase 1 for each 021 005 011  002 or  005  034 computes 2 005 003\006 2 003\002\004 005 0062 003\005\004 005 007\003\006 021 003\002\004 005 006 021 003\005\004 005 007 002 006 002 005\006 006\021 003\005\004 005 007 003\006 031 034 005 031 035 005 006\031 035 005 007 where  005 denotes the binary value in the row 023 of the binary matrix owned by  002 or  005  and 3 005 denotes a random number in 014\005 006 007\007\006  013 004\015  Note that Elgamal encryption is semantically secure under the DDH thus 034 can simulates 2 005 by a random ciphertext of the Elgamal encryption Phase 2 034 has to simulate all 022 002 005 003\006 022 003\002\004 002 005 006\022 003\005\004 002 005 007  Note that given  031 015 002 006\031 015 006 006\031 012\015 002 006\031 012\015 006  since the computational indistinguishability follows from the semantic security of ElGamal encryption which is well known to hold under DDH  031 015 002 006\031 015 006 006\031 012\015 002 006\031 012\015 006  and 006 031 015 002 006\031 015 006 006\031 015 007 006\031 015 010  are not computationally distinguishable Therefore 034 can simulate each 022 002 005 by 022 003 002 005 003\006 031 015 007 006\031 015 010 007  where  011 and  012 are randomly and independently chosen in 014\005 006 013 004\015  Phase 3 034 has to simulate all 021 005 003\006 021 003\002\004 005 006\021 003\005\004 005 007\003 006 022 003\002\004 031 002 003 005 004 033 032 007 002 003 005 004 006\022 003\005\004 031 002 003 005 004 031 032\031 002 003 005 004 007  034 simulates this using a randomly permuted vector of 012 ElGamal cipher-texts among these 012 cipher-texts the number of encryptions of 031 007 should be equal to the output of the protocol all the remaining ciphertexts should be the random number Phase 4 each message 022 003\005\004 002 005 003\002\004 in the protocol can be simulated using 022 003\005\004 002 005 003\002\004 003 022 003\002\004 005 004 005 006 004 003 006\005 022 003\005\004 002 005 003 003 004 where it is similar to the choosing a uniformly random element of 027  This nishes the simulation algorithm IV C OMPLEXITY ANALYSIS A Communication analysis Let us assume that the size of the moderatorês key is 4 bits Phase 1 requires the transmission of 002 010 017 010 010 encryptions for a total of 002 010 017 010 0104 bits In phase 2 002 010 4 bits cipher-texts are transmitted In each iteration of phase 3  002 0104 bits are transmitted for a total of 002 010 4 bits Phase 4 transmits 010 4 bits Since the total is 006\020  016\002 010 017 010 007 0104  B Computational complexity evaluation In this section we show the results of the complexity estimation of the protocol and the efìciency measurement of the protocol in practice In the proposed protocol the computational cost of all parties in the rst phase is 002 010 017 010 010 modular exponentiations The computational cost of the miner is at most of all 006 010 017 010 016  007 010 modular multiplications for the rst phase and the second phase and 010 modular multiplication inversions for the last phase Each moderator uses 020 010 modular exponentiations We conclude that the total computational complexity is 5 006\006 010 017 010 016  007 010 007 modular exponentiations Note 
100 


N 005 002 005 200 400 600 800 1000 2 0.22 0.44 0.67 0.88 1.11 3 0.33 0.66 0.97 1.32 1.65 5 0.55 1.08 1.64 2.14 2.75 10 1.2 2.2 3.2 4.3 5.5 20 2.1 4.3 6.5 8.7 10.8 TABLE I T IME S ECONDS  USED BY ALL PARTIES FOR DATA ENCRYPTION 003 200 400 600 800 1000 Time 0.15 0.32 0.48 0.63 0.8 TABLE II T IME S ECONDS  USED BY EACH MODERATOR that these computational costs do not include the overhead of key generation and computing two parameters 032 and 033  However generating these parameters belongs to the preparation period of the mining process Therefore it can be implemented before the protocol is executed without affecting the computation time of the protocol For evaluating the efìciency of the protocol in practice we build an experiment on the privacy preserving frequency mining in C environment which runs on a laptop with CPU Pentium M 1.8 GHz and 1GB memory The used cryptographic functions are derived from Open SSL Library To measure the computation cost of the frequency mining protocol in worst case we assume that all parties involve in the protocol except the miner are the moderators We measure the computation cost of the frequency mining protocol for 10 parties Before executing the protocol we generate a pair of keys for each party with the size of public keys set at 512 bits Table 1 illustrates our measurements of all partiesês computation time in the submission phase it is in regard to 010 and 010 017 010  for a typical scenario where 010 003 004\005\005\005  010 017 010 003\002\005 The computation time of all parties is about 10.8 seconds Table 2 illustrates our measurements of a moderatorês computation time it is linear in 010 and does not depend on  and 010 017 010 For a typical scenario where 010 003 004\005\005\005  the computation time of a moderator is about 0.8 seconds The minerês computation time it is linear in 010  010 017 010  and   However it is very small it only is 021\020 0126 when 010 003 004\005\005\005\005  010 017 010 003\002\005  and  003\004\005  V P RIVACY PRESERVING FOR CLASSIFICATION RULES LEARNING IN TWO DIMENSION DISTRIBUTED SETTING A Privacy preserving association rules mining 1 Association rules and frequent itemset The association rules mining problem can be formally stated in Let  003  002 006 005 006 007\007\007\006  002 003 be the set of all items Let 002\003 a transaction database where each transaction 020 is a set of items such that 020 012   Associated with each transaction is a unique identiìer denoted by 020&\002  We say that a transaction 020 contains  a set of some items in  if  012 020  The problem is to nd the association rules that have an implication of the form  016  014 6\006  015  where  012    012   and  017  003 7  The support 6 and the conìdence  of the rule  016  are deìned as 6 003 014 006  020  007\003 020 006  020  007 010 002\003 010  003 014 006  010  007\003 020 006  020  007 020 006  007 Where 020 006  007 stands for the number of transactions containing the set  in 002\003 and 010 002\003 010 denotes the total number of transactions in 002\003  The strong association rules are required to meet a minimum support  6 021\003\014  and a minimum conìdence   021\003\014  deìned by the miner A set of items is referred as an itemset An itemset that contains 016 items is a 016 itemset The support count of an itemset is the number of transactions containing the itemset The minimum support count is deìned as 6 021\003\014 010 002\003 010 An itemset is frequent if its support count is not less than the minimum support count Association rule mining is a twostep process 1 Finding all frequent itemsets 2 Generating strong association rules from the frequent itemsets Agrawal et al 2 presented the Apriori algorithm to efìciently identify frequent itemsets for boolean association rules The name of the algorithm is based on the fact that the algorithm uses the Apriori property i.e all nonempty subsets of a frequent itemset must also be frequent 2 Finding a frequent itemset Assume that the transactions set 002\003 is two-dimension distributed into 011\012 parties as in Section 002 007\005  Each party 014 003\004  015 003\004 006 007\007\011\006 016 003\004 006 007\007\006 012 wns 002\003 003\004 that contains information about certain attribute set  003 004 004 and certain records Given a candidate set  of the 016 items the parties wish to cooperatively nd whether or not the candidate set is frequent from the joint transaction set  002\003  without disclosing each partyês individual transactions and even the local frequent itemsets Assume that  is partitioned into parts  004  where 016 011 017  S 012\002 004 006 007\007\006 012 003  Each  004 consists of items 011  003 004 004  Note that if  is frequent in 002\003  it is frequent in at least one horizontal partition 002\003 003  where 002\003 003 003 002\003 003 002 020 007\007\007 020 002\003 003\021  In addition if  004 is frequent in 002\003 003 every  004  016 011 017  is frequent in 002\003 003\004  Considering a map from each 002\003 003\004 to a binary number that is done by each 014 003\004 as follows 8 003\004 003 002 004 006 if  004 is frequent in 002\003 003\004  005 006 otherwise Thus 002\003 is mapped to the binary matrix 011 004 012    Hence  is frequent in at least one horizontal partition 0029 003 as long as at least a row 015 in  with all elements are 004  As the result 8 003 003 003 004 004 010 8 003\004 013\010 017 010 003\005  Clearly using frequency mining can allow the miner to nd a random permutation of  031 036 002   031 036 012  Therefore the miner can identify whether  is frequent or not without knowing  be frequent in which 002\003 003  3 Finding all frequent itemsets and their support counts In the classic Apriori algorithm The k e y issue is computing the support of an itemset To nd out if a particular itemset is frequent we count the number of records where the values for all the attributes in the itemset are 1 Thus the 
101 


problem is to compute the frequency of values tuples that all values in the tuple are 004  The privacy preserving protocol for nding frequent itemsets and support counts follows Apriori algorithm as below 1 002 Finding an item 004 Itemsets is frequent 003 2 022 002 003  3 The miner sets  002 003 021 4 for each  011 022 002 do 5 The miner uses the frequency mining protocol to identify whether or not  is frequent 6 if  is frequent then 7 The miner does  002 003  002 020  8 Let  011  003 004 004  the miner broadcasts the requirement for computing 017\024++;\036 006  007 to all 014 003\004  015 011\002 004 006 007\007\007\006 011 003  9 All parties involve in frequency mining protocol to compute 017\024++;\036 006  007 10 end if 11 end for 12 for 002  003\002   037 005 002 006 003 021  016\016 003 do 13 The miner does 022 037 Approri-gen  037 005 002  14 for each  011 022 037 do 15 The miner uses the frequency mining protocol to identify whether or not  is frequent 16 if  is frequent then 17 The miner does  037 003  037 020  18 Let  consists of items partitioned into the sets  004  where 016 011 017  017 007\002 004 006 007\007\007\006 012 003  the miner broadcasts the requirement for computing 017\024++;\036 006  007 to all 014 003\004  016 011 017  19 The miner and the parties involve in frequency mining protocol to compute 017\024++;\036 006  007 20 end if 21 end for 22 end for 4 Analysis of protocol Statement 1 Correctness If all participants follow the protocol then the minerês result is the frequent itemsets and the support count of each frequent itemset Proof Candidate itemsets are generated by the Apriorigen procedure The correctness of that procedure has proved  The 022 037 sets are generated correctly as long as the input to the procedure is correct We show by induction that the  037 sets are generated correctly At steps 004 013 022 with  003\004   002 is correctly generated by the frequency mining protocol Assume that  037 005 002 has been correctly generated then 022 037 is correctly generated by Apriorigen procedure Since frequency ming protocol is correct the support count of each  011 022 004 005 002 is computed correctly Hence  037 is generated correctly from  037 005 002  The entire frequent itemsets and the support counts gives correct results Statement 2 Privacy The protocol preserves the privacy of the honest users against the miner and up to 011\012 013 002 corrupted parties as long as there is at least an honest be the moderator Proof Since all support count computations and frequent itemsets identiìcation are done independently using frequency mining This statement follows immediately from Theorem 2 5 Evaluation of complexity The communication analysis critically depends on the number of frequency computations called We incur the cost of privacy preserving frequency mining for each call Let 036 be the maximum size of a frequent itemset and let 022 003  015 003\004 006 007\007\007\006 036  and  003  015 003\004 006 007\007\007\006 036  represent the number of candidate itemsets and the found number of frequent itemsets at each round the total communication consists of cost of nding frequent and the cost of the support counts computation that is 022 003 003 012 003 006\002 006\020  016\002 022 003 007 0114 016\006\020  016\002  003 007 0104 bits Similarity the computational complexity is 5 006 003 012 003 006\002 006\006  016 022 003 007 011 016\006  016  003 007 010 007 modular exponentiations B Privacy preserving learning of ID3 tree in two-dimension distributed data Using the primitive of proposed privacy-preserving frequency mining we can learn ID3 trees in two-dimension distributed data without loss of accuracy The minerês algorithm has the same complexity as the original ID3 tree algorithm except for an additional linear overhead factor Which has a value determined by the number of times frequency mining protocol using to compute gain 1 ID3 decision tree learning we rstly present a brief review of ID3 decision trees An ID3 tree is a rooted tree containing nodes and edges Each internal node is a test node and corresponds to an attribute The edges going out of a node correspond to the possible values of that attribute The ID3 algorithm works as follows The tree is constructed top-down in a recursive fashion At the root each attribute is tested to determine how well it alone classiìes the samples The best attribute is then chosen and the samples are partitioned according to this attribute The ID3 algorithm is then recursively called for each child of this node using the corresponding subset of data Thus major problem of the algorithm is choosing the best attribute that can achieve the maximum information gain at each node Clearly the problem of choosing the best attribute can be reduced to computing entropies that require computation of the frequency of tuples of va 2 Protocol of privacy-preserving ID3 tree learning Let 002\003 be a data set that has the set of non-class attributes 005 003 002 005 002 006 007\007\006 005  003 and  the class attribute Without loss of generality we assume that all attributes have the same domain size d 002 037 002 006 007\007\007\006 037 002 003  002\003 is two-dimension distributed into 011\012 parties as in Section 002 007\005  Each party 014 003\004  015 003 004 006 007\007\011\006 016 003\004 006 007\007\006 012 wns 002\003 003\004  There are 011 parties 014 003\021  015 003\004 006 007\007\011 007 holding the classiìcation attribute   The parties wish to cooperatively build the 002 023 decision tree classiìer from the joint data set of all parties without disclosing each partyês individual transactions and even the number of the local records Assume that parties have set a system as the computation model described in Section 023  In this section we use frequency protocol as the primitive to design the privacy protocol for building decision tree following the ID3 
102 


Algorithm PrivacyPreservingID3 006 005\006 006 002\003 007 1 If 005 is empty return a leaf-node with the class value assigned to the most of all transactions in 002\003  2 Use the privacy preserving method to count the number of records with each class label If 002\003 consists of records which have the same class label 8  return a leaf node with 8  3 Otherwise Determine the best attribute 005 003 for 002\003 using the privacy-preserving method For 005 003 003 002 037 002 006 007\007\007\006 037 002 003 let 002\003 006 037 002 007  002\003 006 037 002 007 be a partition of 002\003 that every record in 002\003 006 037 005 007 has attribute value 037 005  Return a tree whose root is labeled 005 003  the root has outgoing edges labeled 037 002  037 002 s.t each edge 037 005 goes to the tree 014 036\0158\037"\033\014 036\6\\0368\015\011\031&\002 023\006 005 013 005 003 006\(\006\002\003 006 037 005 007\007 007 3 Analysis of protocol The communication/computation depends on the number of records number of vertically partition number of attributes number of attribute values per attribute number of classes and complexity of the tree For a rough analysis the cost of computation involves in terms of the time number of frequency mining protocol called to build the tree Assume that there are 036 nodes in nal classiìcation tree In total each node needs  006\004 016 004 007 the calls of frequency mining protocol All node of the tree need 036 006\004 016 004 007 the frequency computation Therefore in total the entire classiìcation process will require O 036\004<\010 006  016 010 017 010 007  encryptions and O 036\004<\010 006  016 010 017 010 007 4  bits communication VI C ONCLUSION In this paper we proposed a method for privacy-preserving classiìcation learning in two-dimension distributed data which has not been investigated previously Basically the proposed method is based on the ElGamal encryption scheme and it ensures strong privacy without loss of accuracy We illustrated the applicability of the method by applying it to design the privacy preserving protocol for some learning methods such as association rules mining decision tree learning We conducted experiments to evaluate the complexity of the protocols The experimental results showed that the protocols are efìcient and practical R EFERENCES  A Evmie vski R Srikant R Agra w al and J Gehrk e Pri v ac y preserving mining of association rules In Proc of the Eighth ACM SIGKDD International Conference on Knowledge Discovery and Data Mining ACM Press pp 217-228 2002  C C Aggarw al P S Y u Eds Pri v ac y-Preserving Data Mining Models and Algorithms Series Advances in Database Systems Springer Vol 34 2008  D Agra w al and C Aggarw al On the design and quantiìcation of pri v ac y preserving data mining algorithms In Proc ACM SIGMOD pp 247-255 2001  D Boneh The decision Dif fe-Hellman problem In ANTS-III V o l 1423 of LNCS pp 48-63 1998  F  W u J Liu and S Zhong An ef cient protocol for pri v ate and accurate mining of support counts Pattern Recognition Letters Vol 30 Issue 1 1 pp 80-86 2009  O Goldreich F oundations of Cryptography  B asic T ools V o l 1 Cambridge University Press 2001  H Martin and S Kazue Ef cient receipt-free v oting based on homomor phic encryption In Proc of Advances in Cryptology-Eurocrypt 2000  J Benaloh and D T uinstra Receipt-free secretballot elections e xtended abstract In Proc of the 26th Annual ACM Symposium on Theory of Computing ACM Press pp 544-553 1994  J V aidya and C Clifton Pri v ac y preserving nai v e Bayes classiìer for vertically partitioned data In Proc of the 2004 SIAM Conference on Data Mining 2004  J V aidya and C Clifton Pri v ac y preserving association rule mining in vertically partitioned data In Proc of the eighth ACM SIGKDD International Conference on Knowledge Discovery and Data Mining pp 639-644 2002  Luong T D Ho T B 2010 Pri v ac y Preserving Frequenc y M ining in 2-Part Fully Distributed Setting IEICE Trans Information Systems to appear  M Kantarcoglu and J V aidya Pri v ac y preserving nai v e Bayes classiìer for horizontally partitioned data In IEEE ICDM Workshop on Privacy Preserving Data Mining pp 3-9 2003  M.Freedman K.Nissim and B.Pinkas Ef cient pri v ate matching and set intersection In Proc of Eurocrypt Vol 3027 of LNCS Springer-Verlag pp 1-19 2004  R Agra w a l a nd R Srikant Pri v ac y preserving data mining In Proc of ACM SIGMOD Conference on Management of Data pp 439-450 2000  R Agra w al R Srikant and D Thomas Pri v ac y preserving OLAP  I n Proc of the 2005 ACM SIGMOD International Conference on Management of Data SIGMOD 05 ACM pp 251-262 2005  R Agra w a l a nd R Srikant Pri v ac y-preserving data mining In Proc of the ACM SIGMOD Conference on Management of Data ACM Press pp 439-450 2000  R.Agra w al T  Imielinski and A.Sw ami Mining association rules between sets of items in large databases In Proc of the 1993 ACM SIGMOD international Conference on Management of Data 207-216 1993  S Zhong Z Y a ng and T  Chen k-Anon ymous data collection Journal of Information Sciences Vol 179 Issue 17 pp 2948-2963 2009  V S V e rykios E Bertino I.N F o vino L.P  Pro v e nza Y  Saygin and Y Theodoridis State-of-the-art in privacy preserving data mining ACM SIGMOD Record Vol 3 No 1 pp 50-57 2004  Y  Lindell B Pinkas Pri v ac y preserving data mining In Adv ances in Cryptology Crypto2000 Vol 1880 of LNCS Springer-Verlag pp 36-53 2000  Y  Tsiounis and M Y ung On the security of ElGamal-based encryption In Public Key Cryptographyê98 Vol 1431 of LNCS pp 117-134 1998  Z Y a ng S Zhong R.N Wright Pri v ac y-preserving classiìcation of customer data without loss of accuracy In Proc of the 2005 SIAM International Conference on Data Mining SDM pp 21-23 2005  W  Du and Z Zhan Using randomized response techniques for pri v ac y preserving data mining In Proc of the Ninth ACM SIGKDD International Conference on Knowledge Discovery and Data Mining ACM Press pp 505510 2003  W  Du and Z Zhan Building decision tree classiìer on pri v ate data In Proc of IEEE International Confonference on Privacy Security and Data Mining pp 1-8 2002 
103 


              


   


                        





