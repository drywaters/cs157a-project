Theta theory: Requirements for encoding events and task rules explain theta phase relationships in hippocampus and neocortex Michael E. Hasselmo Department of Psychology Center for Memory and Brain Program in Neuroscience and Center for BioDynamics Boston University 64 Cummington St Boston MA 02215 hnsselmo\(riibu.edu http:llpeople.bu.eduihassehno Abstract Memory tasks require processes for encoding associations and retrieving them to guide goal directed behavior Hasselmo et al 2002 Simulations of 
the interaction of hippocampus and neocortex demonstrate specific dynamical requirements required for encoding episodic memory and learning task rules 1 Encoding of new information without interference from previously encoded information requires cyclical transitions between encoding and retrieval states 2 Context dependent retrieval of task relevant information from episodic memory requires mechanisms for timing and synchronization of inputs from entorhinal cortex and region 
CA3 to hippocampal region CA1 during retrieval Theta theory provides a framework for describing how performance is enhanced by specific phase relationships of theta rhythm in different regions of the rat hippocampus and neocortex I INTRODUCTION The hippocampal theta rhythm is a 3-10 Hz oscillation which appears prominently in the electroencephalograph EEG recorded at the hippocampal fissure This theta rhythm shows clear dependence upon behavior, with a large increase in the amplitude of theta rhythm during 
locomotion and exploration Buzsaki et al 1983 and also during attention to behaviorally relevant stimuli such as predators or the tone in appetitive or eye blink conditioning paradigm \(Seager et al 2001 Lesions which block theta rhythm impair performance in a range of memory tasks including spatial alternation 8-arm radial maze and spatial reversal Recent research in my laboratory has focused on the possible functional role of the theta rhythm within the hippocampus Theta rhythm results from oscillatory changes in 
synaptic currents in different layers of region CA1 of the hippocampus as shown by current source density analysis Brankack et al 1993; Bragin et al 1998 This current source density analysis is summarized in Figure 1 In particular at the trough the EEG recorded in the hippocampal fissure there is a strong current sink in stratum lacunosum-moleculare the layer which receives excitatory synaptic input from the entorhinal cortex In contrast, during this phase, there is a strong current source in the cell 
body layer stratum pyramidale reflecting the outward cuirents resulting from inhibition at the cell bodies At the opposite phase of the theta rhythm there is a current sink in stratum radiatum associated with strong synaptic input from region CA3 The mechanisms of generation of hippocampal theta rhythm have been studied extensively by a number of researchers Stewart and Fox 1990 Buzsaki et al 1983 However few researchers have described models of the functional role of hippocampal theta rhythm In recent work I have described a model of the 
functional role of hippocampal theta rhythm \(Hasselmo et al 2002a; 2002h; 2002c; Cannon et al 2002 This theta theory provides a functional framework in which a behavioral performance measure is maximized by the relative phases of different oscillatory dynamics within different regions of the hippocampus and associated stmctures This paper will extend this theta theory to address further phase relationships between different sets of physiological data on the hippocampus Ir FUNCTION OF THETA RHYTHM A A simple example To make the functional role 
of theta rhythm clear I will provide an extremely simple example of its possible role in reducing interference during leaming of new paired associates In a typical paired associate memory task subjects are given a set of word pairs A-B such as leather-holster, and are tested on retrieval e.g what word was associated with leather They are then trained repeatedly on a second set of overlapping word pairs A-C such as leather-boot 0-7803-7898-9/03/$17 OO 622003 IEEE 1470 


and are tested on a second retrieval \(e.g what word was most recently associated with leather If we consider each word A B and C to be represented by column vectors a aB and ac and retrieval activity by a the performance on the second retrieval phase can be measured by 1 M  a~pl-a~apll T Now consider a simple heteroassociative memory e.g. Kohonen 1984\which stores the word pairs and is then cued with the input aA to generate the response a In most models interference during encoding is prevented by using specialized dynamics for encoding and retrieval The simplified example presented here focuses on showing the interference effects which could occur in a neural system and how theta rhythmicity could solve these problems Note that in this example we will always assume vectors of unit length Consider a network with two populations a and upre with all initial weights W\(O The network receives afferent input representing the two words and undergoes Hebbian synaptic modification analogous to Hebbian long-term potentiation ap  aB VuA ap  aA 2 1 3 T AW  aptape  aBaA Note that when a second overlapping paired associate is stored in the network synaptic modification will include interference from retrieval of the first paired associate T awl ac+WaA ac+aBaAa,4 ac+aB 4 5 AW=\(ac+aB ac+uB aBaA Subsequently, retrieval cued by input of word A will not effectively differentiate the recent word resulting in poor performance shown by the performance measure awl  Wa  ac  aB i aB T T T 6 7 M=Z.[a~pl-aBaplJ=-l T T B Oscillatory dynamics This extremely simple example can he used to illustrate the potential functional role of theta rhythm in providing appropriate dynamics for encoding and retrieval within neural circuitry of the hippocampal formation The interference from previous retrieval during encoding can he prevented by assuming oscillatory functions for each component of this model BIN I  x 12  sin  h  I  x 2 8 BLrp\(f  sin  OLTp BREr\(i  XI2 sin  Rm  I  x/Z 9 10 Learning of the first pattern takes the form ap  a O,Wa ap  a 1 1 12 T 2n 0  LTP\(elNaB%ETwaA We will assume first pattern learning reaches a Then leaming of the maximum strength of W\(O second pattern takes the form ap  a  OmhBaAaA AW I LTP\(@INQC+~"~B&A 13 T 14 T 277 0 Subsequently we will evaluate retrieval cued by input of word A note that we will take retrieval at the maximum of the oscillatory phase a  max[oRava When the integral over full cycles is computed, the performance measure takes the form M=\(x/2 h Z  Om This function is plotted in Figure 1 As can he seen from the figure the best function of the network is obtained when input is in phase with the phase of long term potentiation and when retrieval RET is 180 degrees out of phase with long-term potentiation Hasselmo et al., 2002a ISOW RET INphase 3600 Figure I Magnitude of the performance mesure M z axis for different phase relationships between the input IN and the leaming rate LTP and between the retrieval RET and the lcaming rate LTP In the description above, the encoding of the second paired associate C is accompanied by forgetting of the first paired associate B However in an actual paired associate task subjects would be able to retrieve both B and C in a context-dependent manner, suggesting that B is not forgotten In this case, correct retrieval of C or B 1471 


depends upon an association of the experimental context with the specific paired associate The full details of this will not be presented here, but we can assume that this experimental context involves modified connections providing input which is selective for one pattem Previously this interaction was used for goal-directed selection of next desired location Hasselmo et al 2002b Here we will just represent context dependent cue activity as oscillatory input biased toward one response e The retrieval activity of the network will also be regulated by oscillations in the activation of the postsynaptic population e as follows With this activation function the performance measure changes with phase relationships in the following manner M   l-x/2 2/4 I 2n\(I-x/2 16 x[\(x/2 p  x/2 4 4,sr This form of the equation will reach a maximum when postsynaptic depolarization is in phase with the retrieval spread RET The phase relationships of posl=RET are plotted in the top of Figure 2 which demonstrates their general consistency with the timing of synaptic currents recorded electrophysiologically in the hippocampus \(See Figure 2  If we assume that that the oscillatory modulation of LTP induction must stay positive no LTD then the phase relationships for maximum function are shified slightly relative to each other similar to the data at the bottom of Figure 2 Note that the modulation of postsynaptic depolarization is constrained to stay positive though spiking activity in the dendrites during encoding might cause an explicit suppression of repeated pattems during retrieval due to a refractory period after dendritic spiking \(Golding et al 2002 The cues for retrieval are presumed to be held in working memory and delivered from neocortical area such as prefrontal cortex The same steps described above can he used to demonstrate that this would require rhythmic activity in prefrontal cortex which is in phase with the hippocampal retrieval activity Specifically phasic activity in prefrontal cortex working memory would appear in equations as SPFc with the same maximal phase as demonstrated above for e  Ongoing experiments in our laboratory have shown that at least in some periods prefrontal and hippocampal theta rhythm are synchronized \(Hyman et al 2002 C Electrophysiological data This use of oscillatory variables to regulate dynamics is directly motivated by experimental evidence from electrophysiological recordings within the hippocampal formation of awake behaving rats In fact the oscillatory variables described above appear to resemble evidence from current source density showing phasic changes in magnitude of synaptic input in different layers of the hippocampal region CA1 Brankack et al 1993 In particular the phase of input IN could correspond to the excitatory afferent input from entorhinal cortex causing current sinks in stratum lacunosum moleculare of region CAI the phase of retrieval RET could correspond to afferent input from region CA3 causing current sinks in stratum radiatum of region CAl\(Brankack et al 1993 and the phase of postsynaptic depolarization DEP could correspond to the phase of rhythmic somatic depolarization Fox 1989 Kamondi et al 1995 appearing when inhibition is weak within stratum pyramidale of region CAI The phase relationships for maximum performance are summarized in Figure 2 and the bottom of the figure shows how these phase relationships match the current source density data showing the relative timing of current sinks determined by current source density analysis in region CAI of the hippocampal formation post RET IN I1 Pyramidale Radiatum Lacunosum moleculare Fig 2 Top Phascs for maximum Function in cquation 16 Bottom Cur source density data showing phascs in rcgian CAI of hippocampus Brankack ct al 1993 1472 


These phase relationships are behaviorally relevant as lesions of region CAI of the hippocampus have been shown to selectively impair performance in paired associate memory tasks in humans Rempel-Clower et al 1996 In rats lesions of the fomix which remove much of the amplitude of theta rhythm impair the ability to leam reversal tasks in which a previously rewarded behavior must be replaced with an opposite behavior For example rats with fomix lesions have difficult learning to make a right tun response after initially leaming a left tum response M'Harzi et al 1987 Markowska et al 1989 These phasic changes require that long-term potentiation LTP at synapses arising from region CA3 should he strongest at the phase when synaptic transmission at these synapses is weakest Consistent with these requirements our recent data Wyble et al 2000 shows that synaptic transmission in stratum radiatum is weakest at the positive peak of local theta which is when previous data shows induction of LTP is strongest in this layer \(Holscher et al 1997 Orr et al 2001; Hyman et al 2002 LTP induction could he due to induction of dendritic spikes by entorhinal input at a time when the soma is hyperpolarized to prevent spiking Golding et al 2002 111 GOAL DIRECTED SELECTION OF NEXT MOVEMENT A The hippocampal circuit As noted above it is desirable to maintain representations of multiple previous associations rather than forgetting them In this case it is necessary to regulate retrieval so that only individual associations are retrieved based on the specific context or goal of one phase of a task In the description above we simply assumed context dependent input could bias the retrieval toward one output Here I will present the circuitry which could perfom this context dependent retrieval in more detail This has been addressed in studies modeling the role of hippocampus in goal directed spatial navigation Recent papers from my laboratory have addressed various aspects of this goal directed spatial navigation Hasselmo et al 2002a 2002b Cannon et al 2002 Koene et al 2003 Gorchetchnikov et al 2003 The overall circuitry of such models is summarized in Figure 3 which schematically illustrates the connectivity of different subregions of entorhinal cortex and hippocampus modeled in these simulations This basic structure has been used to guide the movements of a virtual rat through a virtual environment The virtual rat leams pathways through the environment by encoding associations between sequentially activated place cells  that is neurons responding selectively when the rat is in specific spatial locations Muller et al 1986 Skaggs et al 1996 These pathways can then be used to guide movement in an interactive manner Activity in EC 111 spreads in a reverse direction from goal location until it converges with current location at which time it activates forward associations in region CA3 These two regions send convergent input to region CA1 where neurons are selectively activated on the basis of the next desired location of the rat   parcl I1 I PFC I Y WEClll WCA3-CAI CA3 CA1 U I WCA3 Figure 3 Schcmatic diagram of the hippocampal formation Thc entorhinal cortex providcs most input to the hippocampus receiving convergent input from many regions of association cowx nis figurc highly simplifies the input showing the conncctians bringing spatial input from parietal cortex ParC lo entorhinal cortcx layer I1 ECII and goal dependent input from prefrontal cortex PFC to layer Ill ECIII These regions provide input to region CA3 and region CA I of the hippocampus This basic functional framework raises a number of dynamical issues which have been addressed in a number of publications from this laboratory Hasselmo et al 2002a 2002b Cannon et al 2002 Koene et al 2003 Gorchetchnikov et al 2003 Among other things these models require a buffer in entorhinal cortex which can maintain spiking activity so that slow behavioral transitions can cause sequential spike within the time course of spike timing dependent synaptic plasticity Jensen and Lisman 1996 Fransen et al 2002 Hasselmo et al 2002 B Theta phase precession Among other phenomena these circuits underlie the experimental phenomenon of theta phase precession Theta phase precession is a characteristic of place cells in linear 1473 


environments  for example when a rat must run on along an elevated triangular track in a single direction O'Keefe and Recce 1993; Skaggs et al., 1996 In such tasks many place cells show characteristic changes in phase firing late in the theta cycle when first entering that cells place field and then gradually firing at earlier and earlier phases as the rat traverses the place field Multiple cells ohase vs sequence order 360 Phasc I CA3  Input Strong   B Jo I  Phas I 1 I I i I  Position enter middle exit Fig 4 Simple scqucntial madcl of phase preccssion lensen and Liman 1996 Tsadyks et al 1996 A Associations hcrween placc cells allow thc current location to eausc readout of a scqucncc of future locations When obscwing a singlc cell 5 this initially appcars as firing late in cyclc which moves to earlier phases of theta Multiple cells phase vs sequence order Phas 1 Position enter middle exit Sinele place cell phase vs position Fig 5 Thcoly of phasc preccssion bascd on changcs in length of mtriwd sequence Wallenstein and Hasselmo 1997 A In this madcl sequcnccs arc read out to difierercnt lcngths depcnding on strength of synaptic transmission or dcpolarimtion at diffcrcnt phases of theb E Whcn observing a singlc cell 5 this appcars as a widc slightly scallopcd distribution of spiking This phenomenon has been modeled in a number of different ways including models based on activity spreading along sequences of place cell representations Two of these models are summarized in Figs 4 and 5 Both of these models can be thought of as feedforward models of phase precession They depend upon current location, but do not depend upon the goal or context of behavior In more recent modeling Hasselmo et al 2002b 2002c\theta phase precession has been obtained which depends upon the interaction of associations from the goal in entorhinal cortex with associations from current location in region CA3 This generates predictive spiking in the late phases of theta, and spiking driven by input in early phases of theta as shown in Figure 6 This figure shows spiking of a single place cell in the simulations with spike times plotted relative to theta phase in the model and the position of the virtual rat in the virtual environment In initial models this predictive phase precession has a biphasic nature to it but recent simulations show a smoother transition of phase precession Koene et al 2003 Input   I strong 0 Position Cortical rule learning Performance of most behavioral tasks requires learning of rules associated with these tasks Thus effective simulation of hippocampal dependent behavior requires a sophisticated model of rule learning in neocortical structures as well Recent simulations have extended a similar framework from Fig 3 to modeling of neocortical interactions between goal-dependent feedback and forward associations from current location This allows leaming of complex relationships between elements of sensory input and motor output but continues to require separation of sensory input phases from goal-dependent feedback activity In particular this simulation has been used to model generation of task dependent behavior in the standard spatial alternation task The spatial alternation task shows strong impairments with lesions of the hippocampus 1474 


probably due to loss of episodic memory of previous responses in the task Recent electrophysiological studies have demonstrated selective neuronal spiking activity dependent upon prior or future responses in this task Wood et al 2000 and ongoing simulations and experiments are addressing specific mechanisms of this selective spiking activity References Bragin A Iando G Nadasdy Z Hctke I Wisc K Buzsaki G Gamma 40-IO0 Hz oscillation in the hippocampus of the bchaving rat JournalqfNeuroscience 15 47-60 \(1995 Brankack J Stew M Fox SE 1993 Current source density analysis of the hippocampal theta rhythm associated sustained potentials and candidate synaptic gcnerators Brain Research 615\(2 310-327 Buzsaki G Lcung LW Vandcnvolf CH 1983 Cellular bases of hippocampal EEG in the bchaving rat Brain Res. 287\(2 Cannon R.C Hasselma M.E and Koene R.A 2002 From biophysics to behavior Catacomb2 and the design of biologically plausiblc models for spatial navigation Ncuroinformatics l\(1 3-42 Fox S E 1989 Mcmbrane potential and impedence changes in hippocampal pyramidal cells during thcta rhythm Exp Brain Res 77 283-294 Givens B I 996\Stimulus-cvokcd resetting ofthc dentate theta rhythm relation to working mcmory Neurorepon 8 159-163 Golding NL Staff NP Spruston N 2002 Dcndritic spikes as a mechanism for coopcrativc long-term potentiation Nature 418\(6895 326-331 Gustafsson B Wigstram H Abraham WC, Huang YY 1987 Long term potentiation in thc hippocampus using dcpolarizing current pulses as thc conditioning stimulus to single volley synaptic potentials J NCUTOSC 7\(3 Hassclmo M.E Badelon C and Wyblc B.P 2002a A proposcd function for hippocampal thcta rhythm Separate phases of encoding and rctrieval enhance rcvcrsal of prior Icaming Neural Computation 14\(4 793-817 Hassclmo M.E Hay J Ilyn M and Gorchetchnikov A 2002b Ncuromodulation thcta rhythm and rat spatial navigation Ncural Networks 15 689-707 Hassclmo M.E and McClclland J.L 1999 Ncural modcls of memory Cum Opinion Ncurobiol 9 184-188 Hasselmo M.E Wyblc, B.P and Cannon R.C 2002 From spike frcqucncy to frec mall How ncural circuits pcrform encoding and rctricval In A Parkcr T.J Bussey E. Wilding \(eds.\Thc cognitive neuroscience of memory Encoding and retrieval. London: Psychology Prcss Holscher C Anwyl, R, Rowan MI 1997 Stimulation on fhc positivc phasc ofhippocampal thcta rhythm induces long-term potcntiation that can Bc dcpotentiatcd by stimulation on thc nogativc phaac in arca CAI in vivo JNeurosci 17\(16\6470.6477 Hucrta PT Lisman JE 1995 Bidirectional synaptic plasticity induccd by a single burst during cholinergic thcta oscillation in CAI in vitro Neuron 15\(5 1053-1063 Hyman JM Wyblc BP Goyal V Hassolmo ME 2001 Phasc relationship of LTP inducation and bchavior to thcta rhythm in the rat hippocampus Sac Ncurosci. Abstr. 27 Hyman I Wyble, B.P Rossi,C.A Hasselmo, M.E. \(2002\Coherence between theta rhythm in rat medial prefrontal conex and hippaeampm Sac Neurosci Abslr 28: 477.6 Jensen 0 Lisman JE 1996 Novel lists of7  2 known items can be reliably stored in an oscillatory short-term memory network intcraction with long-term memory Learn Man 3\(2-3 Kamondi A Acsady L Wang XJ Buzsaki G 1998 Theta oscillations in somata and dendrites of hippocampal pyramidal cells in vivo activily-dependent phase-precession of action potentials Hippocampus 8\(3\244-61 Kacne R.A., Cannon, R.C and Hasselmo M.E 2001 Goaldirected spatial navigation of the rat depends on phases of theta oscillation in hippocampal circuitry. Proc. IJCNN 2003 Kohonen T 1984 Self-organization and Associative Memory Springer-Verlag Macrides F Eichenbaum HB Forbes W.B 1982 Temporal relationship between sniffing and the limbic theta rhythm during odor discrimination rcvemal leaming J Neurosei 2 1705-1717 Markowska AL Olton DS Murray EA Gaffan D 1989 A comparative analysis of the role of fomix and cingulate cortex in memory rals Exp Brain Res. 74\(1 M'Hani M Palacios A Monmaur P Willig F Houcine 0 and Delacour 1 1987 Effects of selective lesions of fimbria-fomix an learning set in the rat Physiol  Behav. 40 181-188 OKcefe J and Recce M.L 1993 Phase relationship between hippocampal place unis and the EEG theta rhythm Hippocampus 3 3 17-330 On G Rao G Stevenson GD Bames CA McNaughton BL 1999 Hippocampal synaptic plasticity is modulated by the theta rhythm in thc fascia dcntata of freely behaving rats Soc Neurosci Abstr 25 2165 \(864.14 Rempcl-Clower NL Zola SM Squire LR, Amaral DG 1996 Three cases ofcnduring memory impairment afler bilateral damage limited to the hippocampal formation I Neurosci 16\(16\5233-5255 Skaggs W.E McNaughton B.L Wilson M.A and Bames C.A 1996 Theta phase preccssion in hippocampal neuronal populations and the compression of temporal sequences Hippocampus 6 149 172 Sohal V.S and Hasselmo M.E 1998a Changes in GABAB modulation during a theta cycle may be analogous to the fall of tcmperahlrc during annealing Neural Compuralion 10 889-902 Tsodyks MY, Skaggs WE Sejnowski TJ and McNaughton BL 1996 Population dynamics and theta rhythm phase precession of hippocampal place ccll.firing a spiking neuron model Hippocampus 6\(3 271-280 Wallenstein G.V and Hasselmo M.E 1997a GABAergic modulation of hippocampal population activity Sequence leaming place field devclopmcnt and the phase precession effect J Neurophysiol 78\(1\393-408 Wiener SI Paul CA Eichenbaum H 1989 Spatial and bchaviaral correlates of hippocampal n~uronal activity J Nmrosci 9\(8 Wood ER Dudchcnko PA Robisek RJ Eichenbaum H 2000 Hippocampal neurons encode information about different types of memory episodes occurring in the samc location Neuron 27\(3 31 Wyble BP Linstcr C Hasselmo ME 2000 Size of CAI-cvoked synaptic potentials is rclated to theta rhythm phase in rat hippocampus I Ncuraphysiol 83\(4 1475 


I] Hu. K. and Xia S.W., Data mining based on large data warehouse, Journal of software, Vol 9,No.l,pp.53-63,Jan.1998 2] Agrawal. R., Mining association rules between sets of items in large database, Proc. ACM SIGMOD int  l conf. Management of data, Washington DC, pp 207-216.May.1993 3] Alex. B. and Stephen. IS., Data warebouse, Data mining and OLAP, McGraw-Hill Book Co. 1999 4] Chen. M.S. and Philip. S., Data mining: an overview from database perspective, IEEE Transaction on knowledge and data engineering pp.866-883 Aug.1996 Roberto. J., Efficiently mining long pattems from databases, Proceedings of the 1998 ACM-SIGMOD int  l conf. on management of data pp.85-93,1998 6] Duda. R.O., Hart. P.E. and Stork. D.J., Pattem recognition, Wiley, New York, 2001 7] Zaki, M.J., Ogibara. M. and Li. W., New algorithms for fast discovery of association rules, Proceedings of the third Int  l conf. on knowledge discovery in database and data mining, pp.283-286.1997 8] Goulboume. G.,  Coenen. F. and Leng. P., Algorithms for computing association rules using a partial-support tree, Knowledge-Based Systems, Vol 13 pp.141-149,2000 9] Yingwu Fang, Guangpeng Zhang, Dewei Wu and Wang Yi, Research on distributive data mining calculating process-DDCP algorithm, Joiirnal of university of elechonic science and technology, Vo132 No. 1, pp.80-84, Feb.2003 5 1660 pre></body></html 


It should be noted that after the above process the resulting support constraint set may become inconsistent Thus in the next round the value c   m i 1 z i may be larger If that happens the larger value c does not interpret as the privacy condence level Instead it should be interpreted as an indicator for inconsistency of the support constraint set Thus the above privacy deletion procedure should only be carried out one time We should note that even if the condence level is higher that is c   m i 1 z i is small there is still possibility that the condential information specied by  I,s,S  is leaked in theory That is for each transaction database D that satises the constraints S wehave support  I D    s S   However no one may be able to recover this information since it is NP hard to infer this fact Support constraint inference has been extensively studied by Calders in 2 3 It would be interesting to consider conditional privacypreserving synthetic transaction database generations That is we say that no private information is leaked unless some hardness problems are solved efciently This is similar to the methodologies that are used in public key cryptography For example we believe that RSA encryption scheme is secure unless one can factorize large integers In our case we may assume that it is hard on average to efciently solve integer linear programs Based on this assumption we can say that unless integer linear programs could be solved efciently on average no privacy specied in P is leaked by S if the computed condence level c   m i 1 z i is small 5 Conclusions In this paper we discussed the general problems regarding privacy preserving synthetic transaction database generation for benchmark testing purpose In particular we showed that this problem is generally NP hard Approximation algorithms for both synthetic transaction database generation and privacy leakage condence level approximation have been proposed These approximation algorithms include solving a continuous variable linear program According to 6 l i n ear probl ems ha vi ng hundreds of t housands of continuous variables are regularly solved Thus if the support constraint set size is in the order of hundreds of thousands then these approximation algorithms are efcient on regular Pentium-based computers If more constraints are necessary then more powerful computers are needed to generate synthetic transaction databases References 1 R  A g r a w al T  Imilien sk i an d A  S w a mi Min in g association rules between sets of items in large databases In Proc of ACM SIGMOD International Conference on Management of Database  pages 207216 1993  T  C a lders  Axiomatization and Deduction Rules for the Frequency of Itemsets  PhD Thesis Universiteit Antwerpen 2003  T  C a l ders  C omput at i onal compl e x i t y of i t e ms et frequency satisability In Proc 23rd ACM PODS 04  pages 143154 ACM Press 2004  R  F agi n J  Hal pern and N Me gi ddo A l ogi c f or reasoning about probabilities Information and Computation  87 1,2\78128 1990  G Geor gak opoul os  D  K a v v a di as  a nd C  P a padi mitriou Probabilistic satisability J of Complexity  4 111 1988  Li near P r ogrammi ng F r equent l y As k e d Q ues t i ons  http://www-unix.mcs.anl.gov/otc Guide/faq/linear-programming-faq html  T  M ielik  ainen On inverse frequent set mining In Proc of 2nd Workshop on Privacy Preserving Data Mining PPDM  pages 1823 IEEE Computer Society 2003  C  P o t t s  A nal ys i s of a l i n ear programmi ng heuri s t i c for scheduling unrelated parallel machines Discrete Appl Math 10 155164 1985 9 G  R amesh  W  Man iatty  a n d M Zak i Feasib le itemset distributions in data mining theory and application In Proc 22nd ACM PODS  pages 284295 2003  Y  W a ng X W u  a nd Y  Zheng P r i v ac y p res ervi ng data generation for database application performance testing In Proc 1st Int Conf on Trust and Privacy in Digital Business TrustBus 04 together with DEXA  LNCS 3184 pages 142-151 2004 Springer-Verlag  X W u  Y  W u Y  W a ng and Y  Li P ri v a c y a w are mar ket basket data set generation a feasible approach for inverse frequent set mining In Proc 5th SIAM International Conference on Data Mining  April 2005  Z Zheng R  K oha vi  a nd L Mas on R eal w o rl d performance of association rule algorithms In Proc of the ACM-SIGKDD International Conference on Knowledge Discovery and Data Mining  pages 401 406 ACM Press 2001 8 Proceedings of the Fifth IEEE International Conference on Data Mining \(ICDM05 1550-4786/05 $20.00  2005 IEEE 


Discovery, 8, 2004, pp. 7-23 20] W. Teng, M. Hsieh, and M. Chen. On the Mining of Substitution Rules for Statistically Dependent Items Proceedings of IEEE International Conference on Data Mining \(ICDM  02 Proceedings of the Fourth IEEE International Conference on Data Mining \(ICDM  04 0-7695-2142-8/04 $ 20.00 IEEE pre></body></html 


14] Kryszkiewicz, M., and Rybinski, H. \(1999  Incomplete Database Issues for Representative Association Rules  ISBN: 3-540-65965-X, pp. 583-591 15] Little, R.J.A., and Rubin, D.B. \(2002 analysis with missing data, Wiley, New York, ISBN 0471183865 16] Omiecinski, E.R. \(2003  Alternative interest measures for mining associations in databases  IEEE TKDE vol. 15, no. 1, pp.57-69 17] Piramuthu, S. \(1998  Evaluating feature selection methods for learning in data mining applications  in the Proceedings of the Thirty-First Annual Hawaii International Conference on System Sciences, vol. 5, pp. 294-301 18] Pyle, D. \(1999 Morgan Kaufmann Publishers, Inc.ISBN:1-55860-529-0 19] Ragel, A., and Cremilleux, B. \(1999  MVC - A preprocessing Method to deal with missing values   knowledge based system, vol. 12, pp.285-291 20] Ramoni, M., and Sebastiani, P. \(2000  Bayesian Inference with Missing Data Using Bound and Collapse   Journal of Computational and Graphical Statistics, vol. 9, no 4, pp. 779-800 21] Ramoni, M., and Sebastiani, P. \(2001  Robust Bayes Classifiers  AI, vol. 125, no. 1-2, pp. 207-224 22] Ramoni, M., and Sebastiani, P. \(2001  Robust Learning with Missing Data  Machine Learning, vol. 45, no 2 , pp. 147-170 23] Scott, R.E. \(1993 Logic and Practice, SAGE Publications, ISBN: 0803941072 24] Zaki, M.J., and Hsiao, C.J. \(2002  CHARM: An efficient algorithm for closed itemset mining  in the Proceedings of the Second SIAM International Conference on Data Mining Proceedings of the Fourth International Conference on Hybrid Intelligent Systems \(HIS  04 0-7695-2291-2/04 $ 20.00 IEEE pre></body></html 


13: else 14: E|i?1| = E|i?1| ? s The backward process in Algorithm 1, generates level-wise every possible subset starting from the borProceedings of the Fourth IEEE International Conference on Data Mining \(ICDM  04 0-7695-2142-8/04 $ 20.00 IEEE der de?ned by Edge without getting into equivalence classes which have been already mined \(Line 10 such subset satis?es the constraint then it can be added to the output \(Line 12 reused later to generate new subsets \(Line 14 have a monotone constraint in conjunction, the backward process is stopped whenever the monotone border B+\(Th\(CM Lines 3 and 8 4.3. Closed Constrained Itemsets Miner The two techniques which have been discussed above are independent. We push monotone constraints working on the dataset, and anti-monotone constraints working on the search space. It  s clear that these two can coexist consistently. In Algorithm 2 we merge them in a Closet-like computation obtaining CCIMiner Algorithm 2 CCIMiner Input: X,D |X , C, Edge,MP5, CAM , CM X is a closed itemset D |X is the conditional dataset C is the set of closed itemsets visited so far Edge set of itemsets to be used in the BackwardMining MP5 solution itemsets discovered so far CAM , CM constraints Output: MP5 1: C = C ?X 2: if  CAM \(X 3: Edge = Edge ?X 4: else 5: if CM \(X 6: MP5 = MP5 ?X 7: for all i ? flist\(D |X 8: I = X ? {i} // new itemset avoid duplicates 9: if  Y ? C | I ? Y ? supp\(I Y then 10: D |I= ? // create conditional fp-tree 11: for all t ? D |X do 12: if CM \(X ? t 13: D |I= D |I ?{t |I  reduction 14: for all items i occurring in D |I do 15: if i /? flist\(D |I 16: D |I= D |I \\i // ?-reduction 17: for all j ? flist\(D |I 18: if supD|I \(j I 19: I = I ? {j} // accumulate closure 20: D |I= D |I \\{j 21: CCIMiner\(I,D |I , C,B,MP5, CAM , CM 22: MP5 = Backward-Mining\(Edge,MP5, CAM , CM For the details about FP-Growth and Closet see [10 16]. Here we want to outline three basic steps 1. the recursion is stopped whenever an itemset is found to violate the anti-monotone constraint CAM Line 2 2  and ? reductions are merged in to the computation by pruning every projected conditional FPTree \(as done in FP-Bonsai [7 Lines 11-16 3. the Backward-Mining has to be performed to retrieve closed itemsets of those equivalence classes which have been cut by CAM \(Line 22 5. Experimental Results The aim of our experimentation is to measure performance bene?ts given by our framework, and to quantify the information gained w.r.t. the other lossy approaches 


approaches All the tests were conducted on a Windows XP PC equipped with a 2.8GHz Pentium IV and 512MB of RAM memory, within the cygwin environment. The datasets used in our tests are those ones of the FIMI repository1, and the constraints were applied on attribute values \(e.g. price gaussian distribution within the range [0, 150000 In order to asses the information loss of the postprocessing approach followed by previous works, in Figure 4\(a lution sets given by two interpretations, i.e. |I2 \\ I1 On both datasets PUMBS and CHESS this di?erence rises up to 105 itemsets, which means about the 30 of the solution space cardinality. It is interesting to observe that the di?erence is larger for medium selective constraints. This seems quite natural since such constraints probably cut a larger number of equivalence classes of frequency In Figure 4\(b built during the mining is reported. On every dataset tested, the number of FP-trees decrease of about four orders of magnitude with the increasing of the selectivity of the constraint. This means that the technique is quite e?ective independently of the dataset Finally, in Figure 4\(c of our algorithm CCIMiner w.r.t. Closet at di?erent selectivity of the constraint. Since the post-processing approach must ?rst compute all closed frequent itemsets, we can consider Closet execution-time as a lowerbound on the post-processing approach performance Recall that CCIMiner exploits both requirements \(satisfying constraints and being closed ing time. This exploitation can give a speed up of about to two orders of magnitude, i.e. from a factor 6 with the dataset CONNECT, to a factor of 500 with the dataset CHESS. Obviously the performance improvements become stronger as the constraint become more selective 1 http://fimi.cs.helsinki.fi/data Proceedings of the Fourth IEEE International Conference on Data Mining \(ICDM  04 0-7695-2142-8/04 $ 20.00 IEEE Information loss Number of FP-trees generated Run time performance 0 2 4 6 8 10 12 14 x 10 5 10 0 10 1 10 2 10 3 10 4 10 5 10 6 m I 2 I 1  PUMSB@29000 CHESS @ 1200 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2 x 10 6 10 


10 1 10 2 10 3 10 4 10 5 10 6 10 7 m n u m b e r o f fp t re e s PUMSB @ 29000 CHESS @ 1200 CONNECT@11000 0 2 4 6 8 10 12 14 x 10 5 10 0 10 1 10 2 10 3 10 4 m e x e c u ti o n  ti m e  s e c  CCI Miner  \(PUMSB @ 29000 closet         \(PUMSB @ 29000 CCI Miner  \(CHESS @ 1200 closet         \(CHESS @ 1200 CCI Miner  \(CONNECT @ 11000 closet         \(CONNECT @ 11000 a b c Figure 4. Experimental results with CAM ? sum\(X.price 6. Conclusions 


6. Conclusions In this paper we have addressed the problem of mining frequent constrained closed patterns from a qualitative point of view. We have shown how previous works in literature overlooked this problem by using a postprocessing approach which is not lossless, in the sense that the whole set of constrained frequent patterns cannot be derived. Thus we have provided an accurate de?nition of constrained closed itemsets w.r.t the conciseness and losslessness of this constrained representation, and we have deeply characterized the computational problem. Finally we have shown how it is possible to quantitative push deep both requirements \(satisfying constraints and being closed process gaining performance bene?ts with the increasing of the constraint selectivity References 1] R. Agrawal, T. Imielinski, and A. N. Swami. Mining association rules between sets of items in large databases In Proceedings ACM SIGMOD, 1993 2] R. Agrawal and R. Srikant. Fast Algorithms for Mining Association Rules in LargeDatabases. InProceedings of the 20th VLDB, 1994 3] R. J. Bayardo. E?ciently mining long patterns from databases. In Proceedings of ACM SIGMOD, 1998 4] F. Bonchi, F. Giannotti, A.Mazzanti, andD. Pedreschi Adaptive Constraint Pushing in frequent pattern mining. In Proceedings of 7th PKDD, 2003 5] F. Bonchi, F. Giannotti, A.Mazzanti, andD. Pedreschi ExAMiner: Optimized level-wise frequent pattern mining withmonotone constraints. InProc. of ICDM, 2003 6] F. Bonchi, F. Giannotti, A.Mazzanti, andD. Pedreschi Exante: Anticipated data reduction in constrained pattern mining. In Proceedings of the 7th PKDD, 2003 7] F. Bonchi and B. Goethals. FP-Bonsai: the art of growing and pruning small fp-trees. In Proc. of the Eighth PAKDD, 2004 8] J. Boulicaut and B. Jeudy. Mining free itemsets under constraints. In International Database Engineering and Applications Symposium \(IDEAS 9] C. Bucila, J. Gehrke, D. Kifer, and W. White DualMiner: A dual-pruning algorithm for itemsets with constraints. In Proc. of the 8th ACM SIGKDD, 2002 10] J. Han, J. Pei, and Y. Yin. Mining frequent patterns without candidate generation. In Proceedings of ACM SIGMOD, 2000 11] L.Jia, R. Pei, and D. Pei. Tough constraint-based frequent closed itemsets mining. In Proc.of the ACM Symposium on Applied computing, 2003 12] H. Mannila and H. Toivonen. Multiple uses of frequent sets and condensed representations: Extended abstract In Proceedings of the 2th ACM KDD, page 189, 1996 13] R. T. Ng, L. V. S. Lakshmanan, J. Han, and A. Pang Exploratory mining and pruning optimizations of constrained associations rules. In Proc. of SIGMOD, 1998 14] N. Pasquier, Y. Bastide, R. Taouil, and L. Lakhal. Discovering frequent closed itemsets for association rules In Proceedings of 7th ICDT, 1999 15] J.Pei, J.Han,andL.V.S.Lakshmanan.Mining frequent item sets with convertible constraints. In \(ICDE  01 pages 433  442, 2001 16] J. Pei, J. Han, and R. Mao. CLOSET: An e?cient algorithm formining frequent closed itemsets. InACMSIGMODWorkshop on Research Issues in Data Mining and Knowledge Discovery, 2000 17] J. Pei, J. Han, and J. Wang. Closet+: Searching for the best strategies for mining frequent closed itemsets. In SIGKDD  03, August 2003 18] L. D. Raedt and S. Kramer. The levelwise version space algorithm and its application to molecular fragment ?nding. In Proc. IJCAI, 2001 


ment ?nding. In Proc. IJCAI, 2001 19] R. Srikant, Q. Vu, and R. Agrawal. Mining association rules with item constraints. In Proceedings ACM SIGKDD, 1997 20] M. J. Zaki and C.-J. Hsiao. Charm: An e?cient algorithm for closed itemsets mining. In 2nd SIAM International Conference on Data Mining, April 2002 Proceedings of the Fourth IEEE International Conference on Data Mining \(ICDM  04 0-7695-2142-8/04 $ 20.00 IEEE pre></body></html 


4] K. Chang, C. Chong, Bar-Shalom, Joint Probabilistic Data Association in Distributed Sensor Networks IEEE Transactions on Automatic Control, AC-31\(10 octobre 1986 5] Bar-shalom, Multitarget Multisensor Tracking Advanced Application ,:YBS Publishing, 1990 6] Bar-shalom, Multitarget Multisensor Tracking Principles and Techenices ,:YBS Publishing, 1995 7] Hu Wenlong, Mao shiyi, Multisensor Data Association Based on Combinatorial Optimization[J]. Journal of Systems Engineering and Electronics . 1997 NO.1,1~9 8] Pattipati K R, Passive Multisensor Data Association Using a New Relaxation Algorithm.In Multitarget-Multisensor Tracking: Advanced and Applications,Y.Barshalom,Norwood,MA:Aretech,199 0 9] Deb S,et al, An S-Dimentional Assignment Algorithm for Track Initiation ,Proc. Of the IEEE Int. Conf Systems Engineering, Kobe, Japan,Sept 1992 527~530 10] Deb S,et al, A Multisensor-Multitarget Data Association Algorithm for Heterogeneous Sensors[J].IEEE Trans. on AES 1993 ,29 \(2 560~568 12] Bar-shalom,Y.,and Fortmann,T.E  Tracking and Data Association  New York:Academic press,1988 13] J,A,Roecher and G.L.Phillis,Suboptimal Joint Probabilistic Data Association .IEEE Transaction on Aerospace Electronic Systems.1993,29\(2 14] J,A,Roecker,A Class of Near Optimal JPDA Algorithm IEEE Transaction on Aerospace and Electronic Systems,1994,30\(2 15] Han Yanfei, Analysis and Improvement of Multisensor Multitarget Probabbilistic Data Association Filting Algorithm[J].  Journal of Systems Engineering and Electronics, 2002, Vol.24, 36~38  569 pre></body></html 


dense data sets for evaluating pattern mining algorithms These two data sets are obtained from IBM Almaden at http://www.almaden.ibm.com/cs/quest/demos.html. Recently, theMAFIA algorithm [6] was proposed to ef?ciently discover maximal frequent patterns. As shown in their paper, MAFIA can be several orders better than some alternatives, such as DepthProject, for mining maximal frequent patterns. Hence, we chose MAFIA as the base line for our performance evaluation. Finally, please note that only the size-2 patterns are generated in the ?rst BFS phase Experimental Platform We implemented the MHP algorithms using C++ and all experiments were performed Proceedings of the 16th IEEE International Conference on Tools with Artificial Intelligence \(ICTAI 2004 1082-3409/04 $20.00  2004 IEEE on a Pentium III    MHz PC machine with    megabytes main memory, running Linux Redhat 6.1 operating system 5.2. A Performance Comparison 100 1000 10000 100000 1e+06 1e+07 1e+08 1e+09 1e+10 1e+11 0.02 0.025 0.03 0.035 0.04 0.045 0.05 0.055 0.06 N um be r o f C he ck ed P at te rn s Support threshold Mafia Min_Conf=0 Min_Conf=0.1 Min_Conf=0.3 Min_Conf=0.5 Min_Conf=0.7 Min_Conf=0.9 


Figure 4. The Number of Checked Patterns on the Pumsb* Data Set 10 100 1000 10000 100000 0.02 0.025 0.03 0.035 0.04 0.045 0.05 0.055 0.06 R un T im e s ec  Support Threshold Mafia Min_Conf=0 Min_Conf=0.1 Min_Conf=0.3 Min_Conf=0.5 Min_Conf=0.7 Min_Conf=0.9 Figure 5. The RunTime Comparison on the Pumsb* Data Set Figure 4 shows the number of patterns that MHP and MAFIA have to check during the pattern mining process on the pumsb* data set. As can be seen, for MHP, the number of checked patterns is increased with the decrease of the h-con?dence threshold. However, the number of checked patterns of MHP can be signi?cantly smaller than that of MAFIA even if a low h-con?dence threshold is speci?ed To check a pattern, we need to count the support of the patterns. Counting the support of a pattern is the most timeconsuming task during the pattern mining process, since we need to retrieve all the transactions which include one of its sub-pattern, or for Ma?a, retrieve all the bit of the bitmap of this pattern [6]. Therefore, an algorithm is more ef?cient if smaller number of patterns need to be checked 100 1000 10000 100000 1e+06 1e+07 1e+08 1e+09 0.1 0.2 0.3 0.4 0.5 0.6 0.7 N 


um be r o f C he ck ed P at te rn s Support Threshold Mafia Min_Conf=0.5 Min_Conf=0.7 Min_Conf=0.9 Figure 6. The Number of Checked Patterns on the Pumsb Data Set 10 100 1000 10000 0.1 0.2 0.3 0.4 0.5 0.6 0.7 R un T im e s ec  Support Threshold Mafia Min_Conf=0.5 Min_Conf=0.7 Min_Conf=0.9 Figure 7. The RunTime Comparison on the Pumsb Data Set The runtime comparison of MHP and MAFIA on the Pumsb* data set is shown in Figure 5. In the ?gure, we can observe that the runtime of MHP can be signi?cantly reduced with the increase of h-con?dence thresholds. Also the runtime of MHP can be several orders of magnitude less than that of MAFIA even if the h-con?dence threshold is as low as 0.3. The reason is that the number of checked patterns of MHP is sign?cantly smaller than that of MAFIA Similar results are also obtained from the pumsb data set as shown in Figure 6 and Figure 7. For the pumsb data set the number of checked patterns of MHP is much smaller 


than that of MAFIA and the runtime of MHP can be significantly less than that of MAFIA 5.3. The Effect of the MHP Algorithm on Finding Maximal Hyperclique Patterns Figure 8 and Figure 9 show the number of maximal patterns identi?ed byMHP andMAFIA on Pumsb* and Pumsb data sets respectively. As can be seen, the number of maximal hyperclique patterns identi?ed by MHP can be orders of magnitude smaller than the number of maximal frequent patterns identi?ed by MAFIA. In other words, the number Proceedings of the 16th IEEE International Conference on Tools with Artificial Intelligence \(ICTAI 2004 1082-3409/04 $20.00  2004 IEEE 100 1000 10000 100000 1e+06 1e+07 1e+08 1e+09 0.02 0.025 0.03 0.035 0.04 0.045 0.05 0.055 0.06 N um be r o f C ou nt ed P at te rn s Support Threshold Mafia Min_Conf=0 Min_Conf=0.1 Min_Conf=0.3 Min_Conf=0.5 Min_Conf=0.7 Min_Conf=0.9 Figure 8. The Number of MFI/MHP Patterns in the Pumsb* Data Set 100 1000 10000 100000 1e+06 


1e+07 1e+08 0.1 0.2 0.3 0.4 0.5 0.6 0.7 N um be r o f C ou nt ed P at te rn s Support Threshold Mafia Min_Conf=0.5 Min_Conf=0.7 Min_Conf=0.9 Figure 9. The number of MFI/MHP Patterns in the Pumsb Data Set of maximal hyperclique patterns is much easier to manage than that of maximal frequent patterns. Indeed, in realworld applications, it is dif?cult to interpret several million maximal frequent patterns. However, it is possible to interpret the results of maximal hyperclique pattern mining In addition, due to the memory limitation, we cannot extract maximal frequent patterns with MAFIA on the Pumsb data set if the support threshold is less than 0.4, as shown in Figure 7. In contrast, MHP can identify maximal hyperclique patterns when the support threshold is 0.1, if we set the h-con?dence threshold to 0.5. In other words, MHP has the ability to identify patterns which can be dif?cult to identify for MAFIA. Hence, MHP can better explore the pattern space and ?nd interesting patterns at low levels of support 6. Conclusions and Future Work In this paper, we present a two-phase Maximal Hyperclique Pattern \(MHP best features of both the BFS strategy and the DFS strategy. More speci?cally, we adapted DFS pruning methods such as equivalence pruning, to an apriori-like approach In addition, we proved the correctness and completeness of the MHP algorithm. Finally, our experimental results show that the MHP algorithm can be several orders of magnitude faster than standard maximal frequent pattern mining algorithms and has the ability to identify patterns at extremely low levels of support in dense data sets There are several directions for future work. First, in 


this paper, we only generate the size-2 patterns in the BFS phase. It will be interesting to investigate the impact on the performance if the ?rst phase is stopped at a deeper level Also, the projection is a very ef?cient method for ?nding patterns, especially for parallel implementation of pattern mining algorithms [1]. We plan to adapt the projection ideas into our algorithm and design an ef?cient parallel algorithm for mining maximal hyperclique patterns References 1] R. Agarwal, C. Aggarwal, and V. Prasad. A Tree Projection Algorithm For Generation of Frequent Itemsets. pages 350 371, Feb 2001 2] R. Agrawal, T. Imielinski, and A. Swami. Mining Association Rules between Sets of Items in Large Databases. In Proc. of the ACM SIGMOD Conference on Management of Data, pages 207216,May 1993 3] R. Agrawal and R. Srikant. Fast Algorithms for Mining Association Rules. In Proc. of the 20th Intl Conference on Very LargeData Bases, 1994 4] R. Bayardo. Ef?ciently mining long patterns from databases In Proc. of the ACM SIGMOD Conference, 1998 5] R. Bayardo and R. Agrawal. Mining the Most Interesting Rules. In Proc. of the ACM SIGKDD Conference, 1999 6] D. Burdick, M. Calimlim, and J. Gehrke. Ma?a: AMaximal Frequent Itemset Algorithm for Transactional Databases. In Proc. of IEEE Conf. on Data Engineering, 2001 7] Y. Huang, H. Xiong, W. Wu, and Z. Zhang. A Hybrid Approach for Mining Maximal Hyperclique Patterns. In In Technical Report UTDCS-34-04, Department of computer science, University of Texas - Dallas, 2004 8] J.Han, J.Pei, and Y. Yin. Mining Frequent Patterns without Candidate Generation. In Proc. of the ACM SIGMOD International Conference on Management of Data, 2000 9] M.J.Zaki and C.Hsiao. ChARM: An ef?cient algorithm for closed itemset mining. In Proc. of 2nd SIAM International Conference on Data Mining, 2002 10] R.Rymon. Search through Systematic Set Enumeration. In Proc. Third Intl Conference on Principles of Knowledge Representation and Reasoning, 1992 11] H. Xiong, M. Steinbach, P.-N. Tan, and V. Kumar. HICAP: Hierarchial Clustering with Pattern Preservation. In Proc. of 2004 SIAM International Conference on Data Mining \(SDM 12] H. Xiong, P.-N. Tan, and V. Kumar. Mining Strong Af?nity Association Patterns in Data Set with Skewed Support. In Proc. of the Third IEEE International Conference on Data Mining \(ICDM Proceedings of the 16th IEEE International Conference on Tools with Artificial Intelligence \(ICTAI 2004 1082-3409/04 $20.00  2004 IEEE 





