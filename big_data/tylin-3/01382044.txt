 Proceedings of the Third International Conference on Machine Learning and Cybemetics Shanghai 26-29 August 2004 RESEARCH ON ALGORITHM OF USER QUERY FREQUENT ITEMSETS MINING YONG ZHONG XIAO-LIN QIN Information Science and Technology Institute, Nanjing University of Aeronautics and Astronautics Nanjing 210016 China 1  Information Science and Technology Institute, Nanjing University of Aeronautics and Astronautics Nanjing 210016 China E-MAIL: zhongyong@fosu.edu.cn Abstract 
An algorithm of mining database user query profdes of transaction level is presented The algorithm changes the computing method of the support and confidence in association rules mining by adding query structure and attribute relations to the computation. Since there is no causal relationship in the access of attributes in queries the method is more appropriate to describe user query behaviors than itemsets used 
by association des The method can be used in database intrusion detection system to prevent database from illegal intrusions effectively Realization performance and application of the algorithm are discussed in the paper Keywords Data mining intrusion detection user profde 1 Introduction Traditional database security emphasizes user authentication and access control which is a kind of prevention-centric security mechanism There exist limitations in prevention-centric security mechanism Experience has shown that we cannot he completely 
successful in prevention problems Hackers continually surprise us by finding new ways to break into or interfere with  Moreover prevention centric mechanisms are powerless against misbehaviors by legitimate users who perform functions for which they are authorized especially for the system administrator Also with the development of network many network-based attacks such as password sniffing and session hijacking allow attackers to masquerade as a legitimate user So it gets many attentions to find other protection mechanisms for 
database to remedy the limitations Intrusion detection analyses system status and actions to find illegal accesses and malicious actions and can provide an effective method to reduce intrusion actions Intrusion detection can supplement protection of database systems by rejecting the future access of detected attackers and by providing useful hints on how to strengthen the defense But the previous researches of intrusion detection mainly focus on network or host intrusion detection Only a few researches are concerned with database intrusion detection 2d1 Database has data structure and semantics itself and the users have their unique behaviors 
So database intrusion detection can make up the insufficiency of the network and host intrusion detection  There are mainly two categories of intrusion detection techniques anomaly detection and signature recognition misuse detection\Anomaly detection techniques detect an intrusion when the observed activities demonstrate a large deviation from the profiles of normal activities Signature recognition techniques store patterns of intrusion signatures and compare those signatures with the observed activities for a match to detect an intrusion In anomaly detection one of the most important techniques is to 
find the user profiles The paper presents an algorithm to mine user profiles based on user query frequent itemsets 2 2.1 Association Rules User Query Frequent Itemsets Mining Algorithm Definition 2.1 Itemset Let A be a set of attributes and I be a set of values on A called items Any subset of I is called an itemset The number of items in an itemset is called its length I 
Definition 2.2 association rule Let D be a database with n attributes columns Define support\(Xl as the percentage of transaction records in D that contains itemset X An association rule is the expression X-Y c s Here X and Y are itemsets and Xn Y 6 s=supprt\(XU r is the support of the rule and c= support\(XU Y x is the confidence 0-7803-8403-2/04/$20.00 a2004 IEEE 1671 


Proceedings of the 223bird Intemational Conference on Machine Laming and Cybemetics Shanghai 26-29 August 2004 There are many association rules algorithm since the association rule was brought forth of which the Apriori algorithm is the most famous The association rules mining methods can find the rules effectively, which are causal and hidden in the large amount of the data But in the access of attributes in database queries, there is no causal relationship so that it is difficult to use association rules 2.2 Transaction-Level User Profiles One big difference of database anomaly detection from OS or network anomaly detection is that application semantics are much more critical to the accuracy of intrusion detection In many cases application semantics-independent detection methods for transactions such as table access statistics data file access statistics session statistics and database schema semantics are not enough to identify abnormal behaviors 221I Application semantics and transaction statements have to be incorporated and evaluated For example a corrupted accoun&t raises salary of somebody by 30.000 instead of 3,000 which is the right number The application semantics-independent metrics will find nothing abnormal However the amount of salary raise namely 30,000 is so huge and clearly very suspicious This kind of anomaly can only be captured when application semantics or transaction statements are used The Database Language SQL SQL is a standard interface for accessing and manipulating relational databases The mining algorithm of the paper is based on the SQL statements and tries to find user profiles of transaction level 23 Transaction Fingerprints There are fixed formats in many SQL queries id applications with database services Regularly the SQL statements submitted to the database are typically generated by some server-side scripts/programs These statements are generated in a predictable manner and this regularity gives rise to oppormnities to characterize valid transactions with some sort of signatures For example a SELECT statement of an employee table query submitted by application X frequently is 223select number name age from employee where department=\222 sales\222 and age>20 and age<60\224 but someday X submits a statement \223select number, name age from employee where rank=\222 high\222 and age>20 and age<W This SQL statement does not conform to the pattern of the SELWJT statement from X It could be the result of a misuse Because of the regularity of SQL statements it is likely to derive signatures to help identify illegitimate SQL statements The fingerprints method 221I uses regular expressions to represent variants of SQL statements that can result from a transaction A fingerprint characterizes one set of SQL statements For example the fingerprint of the aforementioned SELECT statement can be 223%elect number name age from employee where department=\222 1\222\224 I 222 and age>[[:digit and amt<[[:digit:]]+$\224 The literal containing the value of department has been replaced with the regular expression 221 222I 222 which represents a quoted string. The numerical value of age is represented by the regular expression digit which represents an integer And finally, the whole expression begins with a A and ends with a  to prevent any additional clauses from being injected into the statement 2.4 User Query Frequent Itemsets Mining Based on the concept of the association rules and fingerprints, the algorithm of the paper presents its query support function and confidence function 2.4.1 Query Compact Function Considering a given database schema R attributes are close if they either belong to the same relation or can be related by exploiting a sequence of foreign key dependencies And shorter the sequence of foreign key dependencies is closer the attributes are So we define query compact function in key dependencies Definition 2.4.1.1 Relation Distance Function Assume a relation database schema R Given two relations RI ER R2ER the relation distance between RI and Rz denoted by RDisf RI is defmed as RDist\(R1  Ro&m\(RI,R2 1 where RoacNum\(R1~2 computes the number of primary and foreign keys between two relations RI and Rz by which they can be related where function Min computes the minimum 1672 


Proceedings of the Third International Conference on Mad Relation distance function computes the minimal distance between two relations For example in Figure 1 RDist\(Salesman Product RDist\(Sa1esman Worker Definition 2.4.1.2 Attribute Distance Function Assume a relation database schema R Given two attributes AIER A~ERz where RI R,\200R the attribute distance between AI and A2 I denoted by AttrDist\(A,,4  is defined as AttrDist\(A,,4 R1,R RDist\(Ri,Rj I Attribute distance of attributes is defined and normalized by relation distance that they belong to The reason of the formula divided by Max\(RDist\(Ri,Rj is to normalize the result soO<AttrDist\(A 4 lo Definition 2.4.1.3 Query Compact Function Given a setofrandomattributesA A1,A2  A query compact function of A denoted by Querycompact A  is defined as QueryCompact A  Max{AttrDist\(Ai A I Ai, A E A 1 3 Query compact function computes the maximal attribute distance among a set of attributes The more compact an attributes set is smaller the result of query compact function is the more probable the attributes will be referred together by a query 2.4.2:Query Support Function Ri Rj ER 2 The contents of the SQL statements submitted to the database are often changed greatly But the fingerprint of the SQL statements is fixed comparatively especially to single user or role For example the fingerprint of a book search statement of a library is  eiect title author publisher ISBN from bookstore where title    I   The same user may search all kinds of titles of books but seldom search the same title iteratively If we compute the support of the statement in the whole audit session maybe many important statements also have small supports as same as the hivial statements So we change the computing method of the support and use fingerprints as the computing body Def~tion 2.4.2.1 Query Support Function Given one query Q and an.audit session Au in a relation database schema R query support of Q in the audit session Au denoted by Supporf\(Q is defmed as Supporf\(Q Q 4 where functionjingerprint\(Q rems the fingerprint that Q matches IFingerprint\(Q returns the queries number that line Learning and Cybemeucs Shanghai 26-29 August 2004 match the fmgerprint in Au kul returns the number of all the items in Au Audit session 3 is the way that audit data are aggregated For instance the data can be grouped according to users or roles adopted by the users pery Support of Q is percent of the number of queries that matches the same fingerprint Q in the whole audit session It shows the support degree of the fingerprint 2.43 Query Confidence Function Given one query Q and an audit session Au in a relation database schema R two main factors can influence the confidence degree of the query Q One is the confidence degree of the query Q in the fingerprint that it matches and another is the query compact of the Q Higher the confidence values in fingerprint and smaller the query compact is more confident the query is So we change the confidence of the association according to following def~tion Defhtion 2.4.3.1 Fingerprint Conjidence Function Given one query Q and an audit session Au in a relation database schema R fingerprint confidence of Q in the audit session Au denoted by FingerconflQ  is defmed as FingemonflQ IQVlFingerprint Q 6 where function FingerprinqQ returns the fmgerprint that Q matches IFingerprint\(Q returns the queries number that match the fingerprint in Au IQ1 returns the number of Q Fingerprint confidence of Q computes the important degree of Q in the fingerprint that Q matches Definition 2.4.3.2 Query Confidence Function Given one query Q and an audit session Au in a relation database schema R query confidence of Q in the audit session Au denoted by ConflQ  is defined as conflQ Weighr\(l-QueryCompnct\(Q 1-Weighr where Weight is the weight between query compact and fingerprint confidence. Greater the value of Weight is more important the query compact in query confidence and contrary ta fmgerprint confidence For normalization we restrict OGWeight Gl and due to O<QueryCompact\(Q G1,OSFingerConflQ Sl soOSConflQ GI 2A.4 User Query Frequent Itemsefs FingerConflQ 7 We use the concept of query frequent itemsets to describe user query profiles User query frequent itemsets are the queries that the return values of their support and confidence function exceed corresponding thresholds Definition 2.4.4.1 Query Frequent Itemsets Given a 1673 


query Q in an audit session Au query Q is said to be a query frequent itemset in Au if Support\(Q\BsupThreshold Confidence\(Q 2 conThreshold supThreshold and conThreshold are user-defined parameters Their values are within R[0,1 supThreshold and conThreshold can he adjusted If tighter monitoring is desired SupThreshold and conrhreshold can be adjusted accordingly so that more selective frequent itemsets are discovered Therefore only very typical user query behaviors are described in the profiles By adding query compact in query confidence function the computing method of query frequent itemsets shows influence of fixed relations among attributes to user profiles and by using fingerprints in query support function the method shows the influence of query structure to user profiles Since there is no causal relationship in the access of attributes in queries query frequent itemsets are more appropriate to describe user query bebaviors than itemsets used by association rules aforementioned 2.4.5 Algorithm Inputs an audit session Au in a relation database Outputs all the query frequent itemsets in Au Presumptive conditions the items in Au have been preprocessed and all the iterative items have been removed A counter is added to items for recording number of the items and to fingerprints for recording number of items that match the fingerprints Function counteriX retums the counter value of item or fingerprint X The algorithm to discover all query frequent itemsets in an audit session is divided into four steps Step 1 Read the item x in the audit session Au sequentially. Generate the fingerprintfof x Step 2 In the fingerprint set fs that includes all the generated fingerprints if can find a fmgerprintf  Efs that x matches  then counfer\(f   f x Else if f can he incorporated with a fingerprint f 2005 then incorporates f with f  to f  and counter f   f  x adds f  to fs and removesf fromfs else addsftofs with counterv x Step 3 If not finishes reading the audit session yet then return to step 1 else scans thefs and summarizes the fingerprints and their counter Step 4: computes the support and confidence of every item in Au and outputs the query frequent itemsets The Algorithm of generating fingerprint of step 1 can be found in 9 Paper 6 provides a method of selective summarization of literals to summarize fingerprints The schema R method will replace a literal with a token only when the literal corresponds to a domain that carries no implicit meaning for operations and data sensitivity If the range of values in the domain is very large or unbounded\then it is unlikely that such value has an implicit meaning. To test if the domain is unbounded the method tests the growth rate of the number of unique values for the attribute as the size of the sample increases If the domain is unbounded the growth rate will be constant I where s is the number of the samples in the observation On the other hand if the domain contains only a few fixed constants, then the number of distinct values will be similar to the standard diminishing growth curve Number of distinct literals found s Number of distinct literals No\(l-e  91 This behavior can be easily tested with many statistical methods such as the non-parametric one-sample Komoglov-Smimov's D Statistics test KS-test Because of the paper length we won't discuss this funher here 2.4.6 Performance analysis of the algorithm In step 1 and step 2 the algorithm scans the audit session Au sequentially and searches the fingerprints that have already been generated If the search method of fingerprints is sequential then the complexity is Oh t+l 2 where n is the number of items in Au and 2 is the number of all the fingerprints If fingerprints are organized according to some search trees such as sorted tree or B tree the search complexity of fingerprints can be achieved quantity of logt Then the complexity is O\(n*log t In step 3 the algorithm scans the fs and summarizes the fingerprints the complexity is O\(t*f where t is number of fingerprints and f is the average number of the conditions of the fingerprints In step 4 the complexity of computing support and confidence of query is O\(n where n is the number of items in Au 3 Application nf the Query Frequent Itemsets The query frequent itemsets can be the reference of user behaviors The degree of the user query behaviors that deviate from the query frequent itemsets represents the normal degree of the user query behaviors For example we can compute attribute distance or tuple distance O between query frequent itemsets and the queries that are being submitted as a measure for deviating degree In some situations such as in the intrusion of SQL injection the computing method of query frequent itemset can be applied Proceedings of the Third International Conference on Machine Learning and Cybernetics, Shanghai 26-29 August 2004 1674 


Proceedings of the Third International Conference on Machine Learning and Cybemetics, Shanghai 26-29 August 2004 1675 directly to intrusion detection SQL injection can inject or change the SQL statements to some forged statements We use the sample Active Server Pages ASP 221login\222 page of 224I which accesses a SQL Server database and attempts to authenticate access to some fictional application The authentication SQL statement is Var sql=\223select  from users where usemame=\222 224  223 221 224 usemame  223 222 and password  221 224 password If the user specifies the following Usemame 222  drop table users  Password The SQL statement 223select  from users where usemame=\222 222  drop table users  224 will be executed In Transact-SQL, the 221 222 character sequence is the 221single lime comment\222 sequence and the 221:\222 character denotes the end of one query The 221 222 at the end of the username field is required in order for the query to terminated without error After the statement is executed, the users table will be deleted and all the users can\222t login in the database The attacker could log on as any user if using the following input Usemame admin\222   The statement \223select  from users where usemame 222 admin\222  224 will be executed The attacker could log in as the fust user in the 221users\222 table with the following input Usemame 222 or 1=1  The statement \223select  from users where usemame or 1=1  224will be executed The reason why the SQL injection can succeed is that the application believes that the 221constant\222 row that the attacker specified was part of the recordset retrieved from the database SQL injection can be solved partially by the methods such as input validation length limit string replacement and etc But there are many limitations in all the methods ll The mining algorithm of the paper can be applied to prevent SQL injection effectively and remedy the limitations of other methods. To the login statement the algorithm can get the following fingerprint 223select  from users where usemame\222 224\222 I 222 and password=\222 224\222  222  To the injected SQL statements aforementioned, there aren\222t any fingerprints that the statements can match the query support and confidence of the statements is near zero 221and can raise serious alarms The algorithm can also prevent other intrusions such as by obtaining information using error messages and express application semantics due to the using of regular expressions to represent the attribute area in fingerprint For example, if we need that the length of password can\222t be smaller than 5 and the password must I be number or character a fingerprint as following can be gotten 223select  from users where usemame=\222 223\222 I 222 and password 222 a-zA-ZO-9]{5  222  4 Conclusions In this paper we change the computing methods of support and confidence in association rules by using the concept of fingerprint and present an algorithm to find the user query frequent itemsets The algorithm solves the problem that there is no causal relationship in the access of attributes in queries so that it is difficult to use association rule by adding the key and foreign key relations of attributes and the fingerprints that represent the fixed structure of the queries to the computation of support and confidence of the query frequent itemsets. At last the paper presents a performance analysis of the algorithm and its application in intrusion detection Acknowledgements This paper is supported by the Aeronautics Science Foundations of China \(No. 02F52033\and the Information Science and Technology Institute Nanjing University of Aeronautics and Astronautics References I P Am\224 S Jajodia C.D McCollum and B.T Blaustein 223Surviving information warfare attacks on databases\224 In Proceedings of the EEE Symposium on Security and Privacy pp 164-174 Oakland, CA May 1997 Robert S Sielken 223Application intrusion detection\224 Technical Report CS-99-17, Department of Computer Science, University of Virginia June 1999 3 Christina Yip Chung Michael Gertz Karl Levitt 223DEMIDS A Misuse Detection System for Database Systems\224 In The Third Annual IFIP TC-I1 WG 11.5 Working Conference on Integrity and Intemal Control in Information Systems, 1999 4 Christina Yip Chung Michael Gem Karl Levitt 223Discovery of Multi-Level Security Policies\224 The Fourteenth Annual IFIP WG 11.3 Working Conference on Database Security, 2000 5 S Ingsriswang P Liu 223AAID An Application Aware Transaction-Level Database Intrusion Detection System\224 Technical Report Dept of Information Systems UMBC 2001 2 


Proceedings of the Third Intemational Conference on Machine Leaming and Cybemetics Shanghai 26-29 August 2004 6 Sin Yeung Lee Wai Lup Low Pei Yuen Wong 223Leaming Fingerprints For A Database Intrusion Detection System\224 7th European Symposium on Research in Computer Security ESORICS 2002 7 Agrawal R and Srikant R 223Fast algorithms for mining association IIJ~~S\224 In Proceedings of the 20th VLDB Conference 1994 8 P Liu et AI 223The Design and Implementation of an Intrusion Tolerant Database System\224 Technical Report PSU-S2-2002-003 Penn State Cyber Security 9 Low W L Lee S Y Teoh P 221\221DTAFIT Detecting Intrusions in Databases Through Fingerprinting Group, 2002 Transactions\224 In Proceedings of the 4th International Conference on Enterprise Information Systems ICEIS pp 264,265,267,269 2002 lo Chen Zheng Yanfen Zhao 223A Distance-Based Approach to Find Interesting Patterns proceedings of 5th Intemational Data Warehousing and Knowledge Discovery Conference aWaK 2003 F\222rague Czech Republic pp.299-308 September 3-5,2003 ll Anley C 223Advanced SQL Injection In SQL Server Applications\224, Next Generation Security Software Ltd Available at URL http://www.nextgenss.com papers advanced sql-injection.pdf 2002 1676 


I] Hu. K. and Xia S.W., Data mining based on large data warehouse, Journal of software, Vol 9,No.l,pp.53-63,Jan.1998 2] Agrawal. R., Mining association rules between sets of items in large database, Proc. ACM SIGMOD int  l conf. Management of data, Washington DC, pp 207-216.May.1993 3] Alex. B. and Stephen. IS., Data warebouse, Data mining and OLAP, McGraw-Hill Book Co. 1999 4] Chen. M.S. and Philip. S., Data mining: an overview from database perspective, IEEE Transaction on knowledge and data engineering pp.866-883 Aug.1996 Roberto. J., Efficiently mining long pattems from databases, Proceedings of the 1998 ACM-SIGMOD int  l conf. on management of data pp.85-93,1998 6] Duda. R.O., Hart. P.E. and Stork. D.J., Pattem recognition, Wiley, New York, 2001 7] Zaki, M.J., Ogibara. M. and Li. W., New algorithms for fast discovery of association rules, Proceedings of the third Int  l conf. on knowledge discovery in database and data mining, pp.283-286.1997 8] Goulboume. G.,  Coenen. F. and Leng. P., Algorithms for computing association rules using a partial-support tree, Knowledge-Based Systems, Vol 13 pp.141-149,2000 9] Yingwu Fang, Guangpeng Zhang, Dewei Wu and Wang Yi, Research on distributive data mining calculating process-DDCP algorithm, Joiirnal of university of elechonic science and technology, Vo132 No. 1, pp.80-84, Feb.2003 5 1660 pre></body></html 


It should be noted that after the above process the resulting support constraint set may become inconsistent Thus in the next round the value c   m i 1 z i may be larger If that happens the larger value c does not interpret as the privacy con“dence level Instead it should be interpreted as an indicator for inconsistency of the support constraint set Thus the above privacy deletion procedure should only be carried out one time We should note that even if the con“dence level is higher that is c   m i 1 z i is small there is still possibility that the con“dential information speci“ed by  I,s,S  is leaked in theory That is for each transaction database D that satis“es the constraints S wehave support  I D    s S   However no one may be able to recover this information since it is NP hard to infer this fact Support constraint inference has been extensively studied by Calders in 2 3 It would be interesting to consider conditional privacypreserving synthetic transaction database generations That is we say that no private information is leaked unless some hardness problems are solved ef“ciently This is similar to the methodologies that are used in public key cryptography For example we believe that RSA encryption scheme is secure unless one can factorize large integers In our case we may assume that it is hard on average to ef“ciently solve integer linear programs Based on this assumption we can say that unless integer linear programs could be solved ef“ciently on average no privacy speci“ed in P is leaked by S if the computed con“dence level c   m i 1 z i is small 5 Conclusions In this paper we discussed the general problems regarding privacy preserving synthetic transaction database generation for benchmark testing purpose In particular we showed that this problem is generally NP hard Approximation algorithms for both synthetic transaction database generation and privacy leakage con“dence level approximation have been proposed These approximation algorithms include solving a continuous variable linear program According to 6 l i n ear probl ems ha vi ng hundreds of t housands of continuous variables are regularly solved Thus if the support constraint set size is in the order of hundreds of thousands then these approximation algorithms are ef“cient on regular Pentium-based computers If more constraints are necessary then more powerful computers are needed to generate synthetic transaction databases References 1 R  A g r a w al T  Imilien sk i an d A  S w a mi Min in g association rules between sets of items in large databases In Proc of ACM SIGMOD International Conference on Management of Database  pages 207…216 1993  T  C a lders  Axiomatization and Deduction Rules for the Frequency of Itemsets  PhD Thesis Universiteit Antwerpen 2003  T  C a l ders  C omput at i onal compl e x i t y of i t e ms et frequency satis“ability In Proc 23rd ACM PODS 04  pages 143…154 ACM Press 2004  R  F agi n J  Hal pern and N Me gi ddo A l ogi c f or reasoning about probabilities Information and Computation  87 1,2\78…128 1990  G Geor gak opoul os  D  K a v v a di as  a nd C  P a padi mitriou Probabilistic satis“ability J of Complexity  4 1…11 1988  Li near P r ogrammi ng F r equent l y As k e d Q ues t i ons  http://www-unix.mcs.anl.gov/otc Guide/faq/linear-programming-faq html  T  M ielik  ainen On inverse frequent set mining In Proc of 2nd Workshop on Privacy Preserving Data Mining PPDM  pages 18…23 IEEE Computer Society 2003  C  P o t t s  A nal ys i s of a l i n ear programmi ng heuri s t i c for scheduling unrelated parallel machines Discrete Appl Math 10 155…164 1985 9 G  R amesh  W  Man iatty  a n d M Zak i Feasib le itemset distributions in data mining theory and application In Proc 22nd ACM PODS  pages 284…295 2003  Y  W a ng X W u  a nd Y  Zheng P r i v ac y p res ervi ng data generation for database application performance testing In Proc 1st Int Conf on Trust and Privacy in Digital Business TrustBus 04 together with DEXA  LNCS 3184 pages 142-151 2004 Springer-Verlag  X W u  Y  W u Y  W a ng and Y  Li P ri v a c y a w are mar ket basket data set generation a feasible approach for inverse frequent set mining In Proc 5th SIAM International Conference on Data Mining  April 2005  Z Zheng R  K oha vi  a nd L Mas on R eal w o rl d performance of association rule algorithms In Proc of the ACM-SIGKDD International Conference on Knowledge Discovery and Data Mining  pages 401 406 ACM Press 2001 8 Proceedings of the Fifth IEEE International Conference on Data Mining \(ICDM05 1550-4786/05 $20.00 © 2005 IEEE 


Discovery, 8, 2004, pp. 7-23 20] W. Teng, M. Hsieh, and M. Chen. On the Mining of Substitution Rules for Statistically Dependent Items Proceedings of IEEE International Conference on Data Mining \(ICDM  02 Proceedings of the Fourth IEEE International Conference on Data Mining \(ICDM  04 0-7695-2142-8/04 $ 20.00 IEEE pre></body></html 


14] Kryszkiewicz, M., and Rybinski, H. \(1999  Incomplete Database Issues for Representative Association Rules  ISBN: 3-540-65965-X, pp. 583-591 15] Little, R.J.A., and Rubin, D.B. \(2002 analysis with missing data, Wiley, New York, ISBN 0471183865 16] Omiecinski, E.R. \(2003  Alternative interest measures for mining associations in databases  IEEE TKDE vol. 15, no. 1, pp.57-69 17] Piramuthu, S. \(1998  Evaluating feature selection methods for learning in data mining applications  in the Proceedings of the Thirty-First Annual Hawaii International Conference on System Sciences, vol. 5, pp. 294-301 18] Pyle, D. \(1999 Morgan Kaufmann Publishers, Inc.ISBN:1-55860-529-0 19] Ragel, A., and Cremilleux, B. \(1999  MVC - A preprocessing Method to deal with missing values   knowledge based system, vol. 12, pp.285-291 20] Ramoni, M., and Sebastiani, P. \(2000  Bayesian Inference with Missing Data Using Bound and Collapse   Journal of Computational and Graphical Statistics, vol. 9, no 4, pp. 779-800 21] Ramoni, M., and Sebastiani, P. \(2001  Robust Bayes Classifiers  AI, vol. 125, no. 1-2, pp. 207-224 22] Ramoni, M., and Sebastiani, P. \(2001  Robust Learning with Missing Data  Machine Learning, vol. 45, no 2 , pp. 147-170 23] Scott, R.E. \(1993 Logic and Practice, SAGE Publications, ISBN: 0803941072 24] Zaki, M.J., and Hsiao, C.J. \(2002  CHARM: An efficient algorithm for closed itemset mining  in the Proceedings of the Second SIAM International Conference on Data Mining Proceedings of the Fourth International Conference on Hybrid Intelligent Systems \(HIS  04 0-7695-2291-2/04 $ 20.00 IEEE pre></body></html 


13: else 14: E|i?1| = E|i?1| ? s The backward process in Algorithm 1, generates level-wise every possible subset starting from the borProceedings of the Fourth IEEE International Conference on Data Mining \(ICDM  04 0-7695-2142-8/04 $ 20.00 IEEE der de?ned by Edge without getting into equivalence classes which have been already mined \(Line 10 such subset satis?es the constraint then it can be added to the output \(Line 12 reused later to generate new subsets \(Line 14 have a monotone constraint in conjunction, the backward process is stopped whenever the monotone border B+\(Th\(CM Lines 3 and 8 4.3. Closed Constrained Itemsets Miner The two techniques which have been discussed above are independent. We push monotone constraints working on the dataset, and anti-monotone constraints working on the search space. It  s clear that these two can coexist consistently. In Algorithm 2 we merge them in a Closet-like computation obtaining CCIMiner Algorithm 2 CCIMiner Input: X,D |X , C, Edge,MP5, CAM , CM X is a closed itemset D |X is the conditional dataset C is the set of closed itemsets visited so far Edge set of itemsets to be used in the BackwardMining MP5 solution itemsets discovered so far CAM , CM constraints Output: MP5 1: C = C ?X 2: if  CAM \(X 3: Edge = Edge ?X 4: else 5: if CM \(X 6: MP5 = MP5 ?X 7: for all i ? flist\(D |X 8: I = X ? {i} // new itemset avoid duplicates 9: if  Y ? C | I ? Y ? supp\(I Y then 10: D |I= ? // create conditional fp-tree 11: for all t ? D |X do 12: if CM \(X ? t 13: D |I= D |I ?{t |I  reduction 14: for all items i occurring in D |I do 15: if i /? flist\(D |I 16: D |I= D |I \\i // ?-reduction 17: for all j ? flist\(D |I 18: if supD|I \(j I 19: I = I ? {j} // accumulate closure 20: D |I= D |I \\{j 21: CCIMiner\(I,D |I , C,B,MP5, CAM , CM 22: MP5 = Backward-Mining\(Edge,MP5, CAM , CM For the details about FP-Growth and Closet see [10 16]. Here we want to outline three basic steps 1. the recursion is stopped whenever an itemset is found to violate the anti-monotone constraint CAM Line 2 2  and ? reductions are merged in to the computation by pruning every projected conditional FPTree \(as done in FP-Bonsai [7 Lines 11-16 3. the Backward-Mining has to be performed to retrieve closed itemsets of those equivalence classes which have been cut by CAM \(Line 22 5. Experimental Results The aim of our experimentation is to measure performance bene?ts given by our framework, and to quantify the information gained w.r.t. the other lossy approaches 


approaches All the tests were conducted on a Windows XP PC equipped with a 2.8GHz Pentium IV and 512MB of RAM memory, within the cygwin environment. The datasets used in our tests are those ones of the FIMI repository1, and the constraints were applied on attribute values \(e.g. price gaussian distribution within the range [0, 150000 In order to asses the information loss of the postprocessing approach followed by previous works, in Figure 4\(a lution sets given by two interpretations, i.e. |I2 \\ I1 On both datasets PUMBS and CHESS this di?erence rises up to 105 itemsets, which means about the 30 of the solution space cardinality. It is interesting to observe that the di?erence is larger for medium selective constraints. This seems quite natural since such constraints probably cut a larger number of equivalence classes of frequency In Figure 4\(b built during the mining is reported. On every dataset tested, the number of FP-trees decrease of about four orders of magnitude with the increasing of the selectivity of the constraint. This means that the technique is quite e?ective independently of the dataset Finally, in Figure 4\(c of our algorithm CCIMiner w.r.t. Closet at di?erent selectivity of the constraint. Since the post-processing approach must ?rst compute all closed frequent itemsets, we can consider Closet execution-time as a lowerbound on the post-processing approach performance Recall that CCIMiner exploits both requirements \(satisfying constraints and being closed ing time. This exploitation can give a speed up of about to two orders of magnitude, i.e. from a factor 6 with the dataset CONNECT, to a factor of 500 with the dataset CHESS. Obviously the performance improvements become stronger as the constraint become more selective 1 http://fimi.cs.helsinki.fi/data Proceedings of the Fourth IEEE International Conference on Data Mining \(ICDM  04 0-7695-2142-8/04 $ 20.00 IEEE Information loss Number of FP-trees generated Run time performance 0 2 4 6 8 10 12 14 x 10 5 10 0 10 1 10 2 10 3 10 4 10 5 10 6 m I 2 I 1  PUMSB@29000 CHESS @ 1200 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2 x 10 6 10 


10 1 10 2 10 3 10 4 10 5 10 6 10 7 m n u m b e r o f fp t re e s PUMSB @ 29000 CHESS @ 1200 CONNECT@11000 0 2 4 6 8 10 12 14 x 10 5 10 0 10 1 10 2 10 3 10 4 m e x e c u ti o n  ti m e  s e c  CCI Miner  \(PUMSB @ 29000 closet         \(PUMSB @ 29000 CCI Miner  \(CHESS @ 1200 closet         \(CHESS @ 1200 CCI Miner  \(CONNECT @ 11000 closet         \(CONNECT @ 11000 a b c Figure 4. Experimental results with CAM ? sum\(X.price 6. Conclusions 


6. Conclusions In this paper we have addressed the problem of mining frequent constrained closed patterns from a qualitative point of view. We have shown how previous works in literature overlooked this problem by using a postprocessing approach which is not lossless, in the sense that the whole set of constrained frequent patterns cannot be derived. Thus we have provided an accurate de?nition of constrained closed itemsets w.r.t the conciseness and losslessness of this constrained representation, and we have deeply characterized the computational problem. Finally we have shown how it is possible to quantitative push deep both requirements \(satisfying constraints and being closed process gaining performance bene?ts with the increasing of the constraint selectivity References 1] R. Agrawal, T. Imielinski, and A. N. Swami. Mining association rules between sets of items in large databases In Proceedings ACM SIGMOD, 1993 2] R. Agrawal and R. Srikant. Fast Algorithms for Mining Association Rules in LargeDatabases. InProceedings of the 20th VLDB, 1994 3] R. J. Bayardo. E?ciently mining long patterns from databases. In Proceedings of ACM SIGMOD, 1998 4] F. Bonchi, F. Giannotti, A.Mazzanti, andD. Pedreschi Adaptive Constraint Pushing in frequent pattern mining. In Proceedings of 7th PKDD, 2003 5] F. Bonchi, F. Giannotti, A.Mazzanti, andD. Pedreschi ExAMiner: Optimized level-wise frequent pattern mining withmonotone constraints. InProc. of ICDM, 2003 6] F. Bonchi, F. Giannotti, A.Mazzanti, andD. Pedreschi Exante: Anticipated data reduction in constrained pattern mining. In Proceedings of the 7th PKDD, 2003 7] F. Bonchi and B. Goethals. FP-Bonsai: the art of growing and pruning small fp-trees. In Proc. of the Eighth PAKDD, 2004 8] J. Boulicaut and B. Jeudy. Mining free itemsets under constraints. In International Database Engineering and Applications Symposium \(IDEAS 9] C. Bucila, J. Gehrke, D. Kifer, and W. White DualMiner: A dual-pruning algorithm for itemsets with constraints. In Proc. of the 8th ACM SIGKDD, 2002 10] J. Han, J. Pei, and Y. Yin. Mining frequent patterns without candidate generation. In Proceedings of ACM SIGMOD, 2000 11] L.Jia, R. Pei, and D. Pei. Tough constraint-based frequent closed itemsets mining. In Proc.of the ACM Symposium on Applied computing, 2003 12] H. Mannila and H. Toivonen. Multiple uses of frequent sets and condensed representations: Extended abstract In Proceedings of the 2th ACM KDD, page 189, 1996 13] R. T. Ng, L. V. S. Lakshmanan, J. Han, and A. Pang Exploratory mining and pruning optimizations of constrained associations rules. In Proc. of SIGMOD, 1998 14] N. Pasquier, Y. Bastide, R. Taouil, and L. Lakhal. Discovering frequent closed itemsets for association rules In Proceedings of 7th ICDT, 1999 15] J.Pei, J.Han,andL.V.S.Lakshmanan.Mining frequent item sets with convertible constraints. In \(ICDE  01 pages 433  442, 2001 16] J. Pei, J. Han, and R. Mao. CLOSET: An e?cient algorithm formining frequent closed itemsets. InACMSIGMODWorkshop on Research Issues in Data Mining and Knowledge Discovery, 2000 17] J. Pei, J. Han, and J. Wang. Closet+: Searching for the best strategies for mining frequent closed itemsets. In SIGKDD  03, August 2003 18] L. D. Raedt and S. Kramer. The levelwise version space algorithm and its application to molecular fragment ?nding. In Proc. IJCAI, 2001 


ment ?nding. In Proc. IJCAI, 2001 19] R. Srikant, Q. Vu, and R. Agrawal. Mining association rules with item constraints. In Proceedings ACM SIGKDD, 1997 20] M. J. Zaki and C.-J. Hsiao. Charm: An e?cient algorithm for closed itemsets mining. In 2nd SIAM International Conference on Data Mining, April 2002 Proceedings of the Fourth IEEE International Conference on Data Mining \(ICDM  04 0-7695-2142-8/04 $ 20.00 IEEE pre></body></html 


4] K. Chang, C. Chong, Bar-Shalom, Joint Probabilistic Data Association in Distributed Sensor Networks IEEE Transactions on Automatic Control, AC-31\(10 octobre 1986 5] Bar-shalom, Multitarget Multisensor Tracking Advanced Application ,:YBS Publishing, 1990 6] Bar-shalom, Multitarget Multisensor Tracking Principles and Techenices ,:YBS Publishing, 1995 7] Hu Wenlong, Mao shiyi, Multisensor Data Association Based on Combinatorial Optimization[J]. Journal of Systems Engineering and Electronics . 1997 NO.1,1~9 8] Pattipati K R, Passive Multisensor Data Association Using a New Relaxation Algorithm.In Multitarget-Multisensor Tracking: Advanced and Applications,Y.Barshalom,Norwood,MA:Aretech,199 0 9] Deb S,et al, An S-Dimentional Assignment Algorithm for Track Initiation ,Proc. Of the IEEE Int. Conf Systems Engineering, Kobe, Japan,Sept 1992 527~530 10] Deb S,et al, A Multisensor-Multitarget Data Association Algorithm for Heterogeneous Sensors[J].IEEE Trans. on AES 1993 ,29 \(2 560~568 12] Bar-shalom,Y.,and Fortmann,T.E  Tracking and Data Association  New York:Academic press,1988 13] J,A,Roecher and G.L.Phillis,Suboptimal Joint Probabilistic Data Association .IEEE Transaction on Aerospace Electronic Systems.1993,29\(2 14] J,A,Roecker,A Class of Near Optimal JPDA Algorithm IEEE Transaction on Aerospace and Electronic Systems,1994,30\(2 15] Han Yanfei, Analysis and Improvement of Multisensor Multitarget Probabbilistic Data Association Filting Algorithm[J].  Journal of Systems Engineering and Electronics, 2002, Vol.24, 36~38  569 pre></body></html 


dense data sets for evaluating pattern mining algorithms These two data sets are obtained from IBM Almaden at http://www.almaden.ibm.com/cs/quest/demos.html. Recently, theMAFIA algorithm [6] was proposed to ef?ciently discover maximal frequent patterns. As shown in their paper, MAFIA can be several orders better than some alternatives, such as DepthProject, for mining maximal frequent patterns. Hence, we chose MAFIA as the base line for our performance evaluation. Finally, please note that only the size-2 patterns are generated in the ?rst BFS phase Experimental Platform We implemented the MHP algorithms using C++ and all experiments were performed Proceedings of the 16th IEEE International Conference on Tools with Artificial Intelligence \(ICTAI 2004 1082-3409/04 $20.00 © 2004 IEEE on a Pentium III    MHz PC machine with    megabytes main memory, running Linux Redhat 6.1 operating system 5.2. A Performance Comparison 100 1000 10000 100000 1e+06 1e+07 1e+08 1e+09 1e+10 1e+11 0.02 0.025 0.03 0.035 0.04 0.045 0.05 0.055 0.06 N um be r o f C he ck ed P at te rn s Support threshold Mafia Min_Conf=0 Min_Conf=0.1 Min_Conf=0.3 Min_Conf=0.5 Min_Conf=0.7 Min_Conf=0.9 


Figure 4. The Number of Checked Patterns on the Pumsb* Data Set 10 100 1000 10000 100000 0.02 0.025 0.03 0.035 0.04 0.045 0.05 0.055 0.06 R un T im e s ec  Support Threshold Mafia Min_Conf=0 Min_Conf=0.1 Min_Conf=0.3 Min_Conf=0.5 Min_Conf=0.7 Min_Conf=0.9 Figure 5. The RunTime Comparison on the Pumsb* Data Set Figure 4 shows the number of patterns that MHP and MAFIA have to check during the pattern mining process on the pumsb* data set. As can be seen, for MHP, the number of checked patterns is increased with the decrease of the h-con?dence threshold. However, the number of checked patterns of MHP can be signi?cantly smaller than that of MAFIA even if a low h-con?dence threshold is speci?ed To check a pattern, we need to count the support of the patterns. Counting the support of a pattern is the most timeconsuming task during the pattern mining process, since we need to retrieve all the transactions which include one of its sub-pattern, or for Ma?a, retrieve all the bit of the bitmap of this pattern [6]. Therefore, an algorithm is more ef?cient if smaller number of patterns need to be checked 100 1000 10000 100000 1e+06 1e+07 1e+08 1e+09 0.1 0.2 0.3 0.4 0.5 0.6 0.7 N 


um be r o f C he ck ed P at te rn s Support Threshold Mafia Min_Conf=0.5 Min_Conf=0.7 Min_Conf=0.9 Figure 6. The Number of Checked Patterns on the Pumsb Data Set 10 100 1000 10000 0.1 0.2 0.3 0.4 0.5 0.6 0.7 R un T im e s ec  Support Threshold Mafia Min_Conf=0.5 Min_Conf=0.7 Min_Conf=0.9 Figure 7. The RunTime Comparison on the Pumsb Data Set The runtime comparison of MHP and MAFIA on the Pumsb* data set is shown in Figure 5. In the ?gure, we can observe that the runtime of MHP can be signi?cantly reduced with the increase of h-con?dence thresholds. Also the runtime of MHP can be several orders of magnitude less than that of MAFIA even if the h-con?dence threshold is as low as 0.3. The reason is that the number of checked patterns of MHP is sign?cantly smaller than that of MAFIA Similar results are also obtained from the pumsb data set as shown in Figure 6 and Figure 7. For the pumsb data set the number of checked patterns of MHP is much smaller 


than that of MAFIA and the runtime of MHP can be significantly less than that of MAFIA 5.3. The Effect of the MHP Algorithm on Finding Maximal Hyperclique Patterns Figure 8 and Figure 9 show the number of maximal patterns identi?ed byMHP andMAFIA on Pumsb* and Pumsb data sets respectively. As can be seen, the number of maximal hyperclique patterns identi?ed by MHP can be orders of magnitude smaller than the number of maximal frequent patterns identi?ed by MAFIA. In other words, the number Proceedings of the 16th IEEE International Conference on Tools with Artificial Intelligence \(ICTAI 2004 1082-3409/04 $20.00 © 2004 IEEE 100 1000 10000 100000 1e+06 1e+07 1e+08 1e+09 0.02 0.025 0.03 0.035 0.04 0.045 0.05 0.055 0.06 N um be r o f C ou nt ed P at te rn s Support Threshold Mafia Min_Conf=0 Min_Conf=0.1 Min_Conf=0.3 Min_Conf=0.5 Min_Conf=0.7 Min_Conf=0.9 Figure 8. The Number of MFI/MHP Patterns in the Pumsb* Data Set 100 1000 10000 100000 1e+06 


1e+07 1e+08 0.1 0.2 0.3 0.4 0.5 0.6 0.7 N um be r o f C ou nt ed P at te rn s Support Threshold Mafia Min_Conf=0.5 Min_Conf=0.7 Min_Conf=0.9 Figure 9. The number of MFI/MHP Patterns in the Pumsb Data Set of maximal hyperclique patterns is much easier to manage than that of maximal frequent patterns. Indeed, in realworld applications, it is dif?cult to interpret several million maximal frequent patterns. However, it is possible to interpret the results of maximal hyperclique pattern mining In addition, due to the memory limitation, we cannot extract maximal frequent patterns with MAFIA on the Pumsb data set if the support threshold is less than 0.4, as shown in Figure 7. In contrast, MHP can identify maximal hyperclique patterns when the support threshold is 0.1, if we set the h-con?dence threshold to 0.5. In other words, MHP has the ability to identify patterns which can be dif?cult to identify for MAFIA. Hence, MHP can better explore the pattern space and ?nd interesting patterns at low levels of support 6. Conclusions and Future Work In this paper, we present a two-phase Maximal Hyperclique Pattern \(MHP best features of both the BFS strategy and the DFS strategy. More speci?cally, we adapted DFS pruning methods such as equivalence pruning, to an apriori-like approach In addition, we proved the correctness and completeness of the MHP algorithm. Finally, our experimental results show that the MHP algorithm can be several orders of magnitude faster than standard maximal frequent pattern mining algorithms and has the ability to identify patterns at extremely low levels of support in dense data sets There are several directions for future work. First, in 


this paper, we only generate the size-2 patterns in the BFS phase. It will be interesting to investigate the impact on the performance if the ?rst phase is stopped at a deeper level Also, the projection is a very ef?cient method for ?nding patterns, especially for parallel implementation of pattern mining algorithms [1]. We plan to adapt the projection ideas into our algorithm and design an ef?cient parallel algorithm for mining maximal hyperclique patterns References 1] R. Agarwal, C. Aggarwal, and V. Prasad. A Tree Projection Algorithm For Generation of Frequent Itemsets. pages 350 371, Feb 2001 2] R. Agrawal, T. Imielinski, and A. Swami. Mining Association Rules between Sets of Items in Large Databases. In Proc. of the ACM SIGMOD Conference on Management of Data, pages 207–216,May 1993 3] R. Agrawal and R. Srikant. Fast Algorithms for Mining Association Rules. In Proc. of the 20th Int’l Conference on Very LargeData Bases, 1994 4] R. Bayardo. Ef?ciently mining long patterns from databases In Proc. of the ACM SIGMOD Conference, 1998 5] R. Bayardo and R. Agrawal. Mining the Most Interesting Rules. In Proc. of the ACM SIGKDD Conference, 1999 6] D. Burdick, M. Calimlim, and J. Gehrke. Ma?a: AMaximal Frequent Itemset Algorithm for Transactional Databases. In Proc. of IEEE Conf. on Data Engineering, 2001 7] Y. Huang, H. Xiong, W. Wu, and Z. Zhang. A Hybrid Approach for Mining Maximal Hyperclique Patterns. In In Technical Report UTDCS-34-04, Department of computer science, University of Texas - Dallas, 2004 8] J.Han, J.Pei, and Y. Yin. Mining Frequent Patterns without Candidate Generation. In Proc. of the ACM SIGMOD International Conference on Management of Data, 2000 9] M.J.Zaki and C.Hsiao. ChARM: An ef?cient algorithm for closed itemset mining. In Proc. of 2nd SIAM International Conference on Data Mining, 2002 10] R.Rymon. Search through Systematic Set Enumeration. In Proc. Third Int’l Conference on Principles of Knowledge Representation and Reasoning, 1992 11] H. Xiong, M. Steinbach, P.-N. Tan, and V. Kumar. HICAP: Hierarchial Clustering with Pattern Preservation. In Proc. of 2004 SIAM International Conference on Data Mining \(SDM 12] H. Xiong, P.-N. Tan, and V. Kumar. Mining Strong Af?nity Association Patterns in Data Set with Skewed Support. In Proc. of the Third IEEE International Conference on Data Mining \(ICDM Proceedings of the 16th IEEE International Conference on Tools with Artificial Intelligence \(ICTAI 2004 1082-3409/04 $20.00 © 2004 IEEE 





