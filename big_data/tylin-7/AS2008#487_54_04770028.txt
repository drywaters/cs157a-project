INTERNET ANOMALY DETECTION WITH WEIGHTED FUZZY MATCHING OVER FREQUENT EPISODE RULES DA-PENG CHEN XIAO-SONG ZHANG School of Computer Science  Engineering University of Electronic Science and Technology of China UESTC Chengdu China 610054 E-MAIL:cdp18812761@163.com johnsonzxsguestc.edu.cn Abstract Recent attacks demonstrated that network intrusions have become a major threat to Internet Systems are employed to detect internet anomaly play a vital role in internet security To solve this problem a technique called Frequent Episode Rules FERs base on Data 
Mining has been introduced into anomaly detection system ADS These episode rules are used to distinguish anomalous sequences of TCP UDP or ICMP connections from normal traffic episodes Unfortunately this technique is so depend on the machine learning that we may get some false alarms if the results of machine learning cannot cover all the normal traffic data In this paper we introduce a new approach for internet anomaly detection with weighted fuzzy matching over frequent episode 
rules We use weighted fuzzy matching algorithm to match the rules though machine learning may not cover all the normal traffic The results show that the proposed approach can improve the detection performance of the ADS where only pure frequent episode rule is used Keywords Internet security Anomaly detection weighted fuzzy matching Frequent episode rule Traffic data mining 1 Introduction Internet is so deeply influence our daily life that we can't live without it But with the sharply growth 
of internet-based services and severity information on networks the number and the severity of internet-based computer attacks have distinctly increased 1 Thus Intrusion Detection Systems IDSs become a crucial part of network security 2 Misuse detection and anomaly detection are two major intrusion detection techniques Misuse-based systems can detect known attacks with high success detection rate but very powerless when face the unknown attacks For this reason Anomaly-based systems are employed to detect the unknown 
intrusions which cannot be addressed by misuse detection The critical technique of anomaly detection is to build profiles of normal usage 7 8 12 Then frequent episode rule support by the data mining technique is introduced to anomaly detection system The anomaly is detected once the episode rule describing the real traffic connections cannot find any match with normal connection rules in the database 3 8 Thus if the database cannot covers all the normal connection rules we may have 
a false alarms Here we propose a new anomaly detection scheme that can avoid the false alarms above Through elaborate examination we can obtain a nice result of success detection when we use the weighted fuzzy matching algorithm to match the rule which cannot find in the normal rules We use NetAttack datasets for evaluation which mix Internet trace data with MIT Lincoln Lab IDS attack data Experiment shows that our approach detects abnormal traffic with very high accuracy and low false alarm Paper Organization 
This rest of paper is organized as follows In Section 2 we discuss the related work In Section 3 we introduce Episode rules and pruning techniques In Section 4 we introduce the weighted fuzzy matching technique and it's usage of anomaly detection we describe the experiments and evaluation in Section 5 Finally we summarize the paper and outline our future research plans in Section 6 2 Related Works Anomaly detection system ADS which can detect 
unknown attacks plays a vital role in intrusion detection As data mining has been introduced to the ADS many detection approaches which base on it have been developed In the past data mining techniques such as hidden Markov model based on machine learning has been used to build automatic anomaly detection system At the same time a technique called association rules were employed to build ADS 4 5 9 10 11 Among this 978-1-4244-3425-1/08/$25.00 2512008 IEEE 299 


conneton E2 ES E EIl ES E4 El E2 E:l E2 E6 E2 eentS 0 1 2 3 4 5 _5  8 9 10 1 16 i23 N4 15 16 i7 18 Fig 1 A frequent episode rule generation by scanning a stream of connection events using a sliding window 3.1 Generation of Internet Episode Rules The performance of anomaly detection system is directly affected by the Internet Episode Rules generation We use sequence of connection events such as TCP UDP ICMP or other representational events to build the Internet episode which we use it to distinguish the abnormal episodes from the normal episodes Let E be a set of connection events and A be a set of attributes define over E Then an attribute-value pair over A composes a set I For example I timestamp=10 sec duration=1 sec service=http desthost=192.168.21 1.1 for a typical http connection event El A frequent episode is a set of connection events exceeding the occurrence threshold in a sliding window and expression as follows E3 El E2\(c s window 3.1 All connection events are sequentially ordered that is E3 El E2 must occur in order as listed like in Fig 1 The support and confidence of the above rule are formally defined as follows s  Support\(E3U ElU E2 2 so Support\(E3U ElU E2  c 3.2 3.3 Support\(E3 The support value s is defined by the percentage of occurrences of the episode out of total number of traffic records audited And the confidence level c is the probability of the minimal occurrence of the joint episodes out of the left-hand side LHS episode 6 Here both parameters s and c are bounded from below by a minimum support threshold so and a minimum confidence level co respectively We use the window size to regulate the scanning period of the window After this we use a Base-Support data mining scheme introduced by Lee et al and improved by Hwang et al in 2007 6 3 to eliminate the infrequent traffic patterns which will make the anomaly detection system ineffective in detecting rare network events 3.2 Pruning of Ineffective Episode Rules It is very obvious that many rules will be generated after long time machine learning but some of these rules are uninteresting or ineffective Thus we use a pruning technique to reduce the episode rules a Transposition of Episode Rules Comparing the following two FERs the set service=http flag=sO is implied by service=smtp flag=SF in Rule 1 Thus the second one can be covered by the first one So we just need only to include Rule 1 in the normal rule set Rule1 service=smtp flag=SF service=http flag=sO service=http flag=SF Rule2 service=smtp flag=SF service=http flag=sO service=http flag=SF b Elimination of Redundant Episode Rules In general rules with shorter LHSs are more effective than rules with longer LHSs 6 3 This is because shorter one is much easier to compare c Reconstruction of Episode Rules Many FERs detected form the internet traffic have some transitive patterns Suppose we have two rules A-*B and B-*C in the rule set Then the longer rule A-*B,C is implied Since we reconstruct this rule from two shorter rules the longer rule A-*B,C 300 c method many other approaches based on association rule mining have been proposed for anomaly detection Then the frequent episode rules FERs was first proposed by Mannila and Toivonen 22 With huge audit records data mining generates many complex FERs with redundancy or repetitions 6 Later a framework was made up by Lee et al that employed the FERs for anomaly detection by comparing the current activities with normal traffic profiles They introduced the axis and reference attributes in the JAM project to constrain the rule generation and to obtain temporal features Subsequently Fan et al 8 extended Lee's work to find accurate boundaries between known and unknown attacks When base-support algorithm was introduced Qin and Hwang 6 refined the rule formulation procedure with it to mine normal traffic data Compare with Lee's algorithm the base-support algorithm is fairer to various axis attribute values Due to the fact that the same percentage of records is required for different axis attributes so higher base-support value will result in fewer FERs 3 Episode rules and Pruning techniques In this section we will give a brief show about Internet Episode Rules generation and after the rules generation some redundant rules will be born thus we must eliminate these redundant rules  


becomes redundant The reconstruction helps us split longer FERs into shorter ones 6 3 The rule pruning eliminates most of the ineffective rules automatically thus this process raise the efficiency of detection 4 Weighted Fuzzy Matching technique Traditionally the anomaly is detected once the episode rule describing the real connections cannot find any match with normal connection rules in the database But there is an obvious problem that the normal connection rules may not cover all the normal connections thus unsuccessful match does not means we detect an abnormity So we use weighted fuzzy matching technique to handle this problem For universal consideration we define the algorithm as follows Let a subset of T is Tij ti t+1\261 t and i<i<j<n T=T11n and a subset of S is SIn  SI S2 S3...Sn If the Ti and S n include a same subset Tskt,k2 Tsk3k4   Tskx,ky 1<k1<k2  kx5ky5n we count the similar degree as sim\(X S  Len\(TkIkj  Len\(T 5 Experiments And Evaluation We test our anomaly detection scheme using the NetAttack dataset First we have evaluated the effect of the pruning algorithms on different window sizes The testing results are shown in Fig.2 Fig.2 Episode Rule Growth 4.1 Here Len represents the number of attributes Obviously the value of similar degree is close to 1 represents the two sets are almost accordance Here we ignore the weight of each attributes when we count the similar degree so it is not very accurate Because not every attributes have the same weightiness To handle this problem we add the weight value to the fuzzy matching algorithm We give each items t and s a weight value and form a pair like t1 wi So the weighted similar degree is w_ sim\(X S  Weight\(T k W k  Weight\(T 4.2 If the weighted similar degree exceeds the threshold min_sim we give we judge it as a normal traffic For example A FER in normal database is Rule1 service=smtp flag=SF service=http flag=sO service=http flag=SF and we have a rule that we attain from internet traffic is Rule2 service=smtp flag=SF service=http But we cannot find any match with normal rules So we use weighted fuzzy matching We suppose the weight value of each attributes is as follows service,0.4 flag,0.2 so we can attain the weighted similar degree is 0.55 If the threshold min_sim is 0.87 so we can judge it as an abnormal traffic Fig.3 Pruning effect on false alarms in a week With pruning some ineffective rules are abandoned and then we test the pruning effects on false alarms in a week We find that large scan window sizes will bring more false alarms due to the background noise Without pruning it lead to higher false alarms the results are shown in Fig.3 Due to the fact that each attack may generate many anomalous rules and the rule pruning algorithm cannot remove them all we did not find any changes in false negatives in all experiments And we still can use the remaining anomalous rules to identify the attack Meanwhile we find that when use weighted fuzzy matching an appropriate threshold of similar degree is very important for judging the network traffic normal or abnormal This threshold is decided by diversiform factors such as weight value of each attributes and the number of FERs in normal database The results over our work are shown in Fig.4 301 


References Fig.4 Percentage of false alarms with different threshold of similar degree At last we choose to evaluate the intrusion detection rate corresponding to unknown attacks Our FER with weighted fuzzy matching results in a higher successful detection rate the results are shown in Fig.5 than the pure FER scheme and Association rules scheme For the MIT attack dataset we achieved an average detection rate of 48 compared with 32 using pure FERs and 21 using association rules Fig.5 Average anomaly detection rate in using Weight Fuzzy Matching over FERs compared with using the pure FERS and the association rules alone 6 Conclusions and Future work In this section we summarize major contributions and make some suggestions for further work on Internet anomaly detection in network environment Early FERs can detect most anomalies but there is an obvious problem that the normal connection rules may not cover all the normal connections thus unsuccessful match does not means we detect an abnormity Our approach handles this problem with weighted fuzzy matching technique and obtains a nice result Our work just a preliminary exploration which use the fuzzy matching over FERs inevitably it has some drawbacks In future work we can improve our approach and attain higher detection rate 1 Jiong Zhang and Mohammad Zulkernine A Hybrid Network Intrusion Detection Technique Using Random Forests Proceedings of the First International Conference on Availability Reliability and Security ARES 06 07695-2567-9106 IEEE 2 Carl Endorf Eugene Schultz and Jim Mellander,"Intrusion Detection  Pre-vention McGraw Hill/Osborne 2004 3 Kai Hwang Fellow IEEE Min Cai Member IEEE Ying Chen Student Member IEEE and Min Qin Hybrid Intrusion Detection with Weighted Signature Generation over Anomalous Internet Episodes IEEE TRANSACTIONS ON DEPENDABLE AND SECURE COMPUTING VOL 4 NO 1 JANUARY-MARCH 2007 4 D Barbara J Couto S Jajodia L Popyack and N Wu ADAM Detecting Intrusions by Data Mining Proc IEEE Workshop Information Assurance and Security 2001 5 L Ertoz E Eilertson A Lazarevic P Tan J Srivastava V Kumar and P Dokas The MINDSMinnesota Intrusion Detection System Next Generation Data Mining MIT Press 2004 6 M Qin and K Hwang Frequent Episode Rules for Internet Traffic Analysis and Anomaly Detection Proc IEEE Network Computing and Applications NAC 04 Sept 2004 7 E Eskin A Arnold M Prerau L Portnoy and S Stolfo A Geometric Framework for Unsupervised Anomaly Detection Detecting Intrusions in Unlabeled Data Applications of Data Mining in Computer Security Kluwer Academic Publishers 2002 8 W Fan M Miller S Stolfo W Lee and P Chan Using Artificial Anomalies to Detect Unknown and Known Network Intrusions Proc First IEEE Int'l Conf Data Mining Nov 2001 9 A Lazarevic L Ertoz V Kumar A Ozgur and J Srivastava A Comparative Study of Anomaly Detection Schemes in Network Intrusion Detection Proc Third SIAM Conf Data Mining 2003 http www users cs umn edul/kumarlpapers 10 W Lee S.J Stolfo and K Mok Adaptive Intrusion Detection A Data Mining Approach Artificial Intelligence Rev vol 14 no 6 pp 533-567 Kluwer Academic Publishers Dec 2000 11 W Lee and S Stolfo A Framework for Constructing Features and Models for Intrusion Detection Systems ACM Trans Information and System Security TISSec 2000 12 K.S Killourhy and R.A Maxion Undermining an Anomaly-Based Intrusion Detection System Using Common Exploits Proc Int'l Symp Recent Advances in Intrusion Detection RAID 02 pp 5473 Sept 2002 302 


to their semantic relevance. In fact, the purpose of the first phrase ranking is to find semantically equivalent web service candidates. Based on the ranking obtained in the first phrase, the second phrase that mainly considers context equivalence is implemented. In this phrase, service context is referenced and then realize the relevance reranking Let S = {S 1 S 2 S n be a web service collection and Q = {T 1 T 2 T m consisting of several keywords be the submitted query. By implementing OWL-S based approach, web services in S can be semantically ranked and the ranking result is formed as Ranking Semantic S i  S j S k  To further evaluate web service relevance, context equivalence of the top m web services in the ranking list achieved above is further evaluated. Assuming QC QC 1 QC 2 QC s contains the related web services with which the required web service join together, SC i  SC i 1 SC i t includes the web services heavily dependent with web service candidate S i in Ranking Semantic where each SC i j SC i j,1  SC i j,v  satisfies confidence\(S i  SC i j   the context equivalence of S i is then evaluated as     SC              SC         SC    Ranking t i  2 i  1 i  Context 2 1 QC QC CF QC QC CF QC QC CF S t i i i i i i SC S SC S SC S i         3 Synthetically considering the semantic equivalence and context equivalence of web service S i the relevance of S i to query Q is finally defined as   Ranking  1       Ranking    S  Q Relevance Context Semantic i i i S S        4 where represents the weights of the relevance factors namely semantic equivalence and context equivalence can be valued by empirical approach  7. Conclusions  Web service discovery is one of the fundamental problems in web service based applications. A lot of efforts have been attained in this problem among them semantic based web service discovery methods has shown encouraging performance. However, after retrieving a set of semantically equivalent web service candidates, which one is the best suitable with respect to user’s requirements is a potential challenge. In this paper, we studied the possibility of employing context awareness into web service discovery process and proposed a framework to build context for users and providers to capture user’s real need and capture the provider’s real intention to some extent. The context in this paper is built by using association rule to mining the frequent pattern from web service composition history. After that, a re-ranking mechanism is proposed for ranking the semantically equivalent web service candidates. It is anticipated that the proposed framework will help to alleviate the confusion for users in selecting the right web service during the web service discovery  8. References  1  UDDI, ‘‘The UDDI Technical White Paper http://www.uddi.org/pubs/Ir u_UDDI_Technical_White_Paper.p df  2  Xmethods, http://www.xmethods.net  3  H. Song, D. Cheng, A. Messer, and S. Kalasapur, ‘‘Web Service Discovery Using General Purpose Search Engines’’, In Proceedings of ICOS’2007 conference USA, 2007, pp. 265-271  4  G. Tretola, and E. Zimeo, ‘‘Structure Matching for Enhancing UDDI Queries Results’’, In Proceedings of SOCA’2007 conference Newport Beach, California, USA, 2007, pp. 21-28  5  E. Stroulia, and Y. Wang, ‘‘Flexible Interface Matching for Web-Service Discovery’’, In Proceedings of 4 th WISE conference Rome, Italy, 2003, pp  147-156  6  E. Christensen, F. Curbera, G. Meredith, and S. Weerawarana, ‘‘Web Services Description Language \(WSDL\ 1.1’’, W3C Note, 2001  7  K. Sivashanmugam, K. Verma, A. Sheth, and J. Miller Adding Semantics to Web Services Standards’’, In Proceedings of ICOS’2003 conference USA, 2003, pp. 395-401  8  A. Ankolekar, M. Burstein, J. Hobbs, O. Lassila, D. Martin D. McDermott, S. McIlraith, S. Narayanan, M. Paolucci, T Payne, and K. Sycara, ‘‘DAML-S: Web Service Description for the Semantic Web’’, In Proceedings of 1 st ISWC conference  Sardinia, Italy, 2002, pp. 348-363  9  W3C, ‘‘Web Services Semantics -- WSDL-S http://www.w3.org/Submission/WSDL-S    J. de Bruijn, Holger Lausen, A. Polleres, and D. Fensel The Web Service Modeling Language WSML: An Overview In Proceedings of 3 rd ESWC confenrence Budva, Montenegro 2006, pp  590-604    D. Martin, M. Paolucci, S. McIlraith, M. Burstein, D McDermott, D. McGuinness, B. Parsia, T. Payne, M. Sabou, M Solanki, N. Srinivasan, and K. Sycara, ‘‘Bringing Semantics to Web Services: The OWL-S Approach’’, In Proceedings of 1 st  International Workshop on Semantic Web Services and Web Process Composition San Diego, California, USA, 2004, pp 26-42  
303 
303 
303 


  S. Overhage, ‘‘On Specifying Web Services Using UDDI Improvements’’, In Proceedings of 2002 Net.Objectdays Workshops Germany 2002, pp. 535-550    Y. Li, Y. Liu, L. Zhang, G. Li, B. Xie, and J. Sun, ‘‘An Exploratory Study of Web Services on the Internet’’, In Proceedings of ICOS’2007 conference USA, 2007, pp. 380-387    E. Tamani, and P. Evripidou, ‘‘A Pragmatic Methodology to Web Service Discovery’’, In Proceedings of ICOS’2007 conference USA, 2007, pp. 1168-1171   15  B Schilit N. Adams, and R. Want, “Context-Aware Computing Applications”, In Proceedings of 1 st IEEE Workshop on Mobile Computing Systems and Applications 1994. pp. 85-90  16  P. Brown, J. Bovey, and X. Chen, “Context-aware applications: from the laboratory to the marketplace IEEE Personal Communications Vol. 4, No. 5, 1997, pp. 58-64  17  A Dey Understanding and Using Context Personal and Ubiquitous Computing Vol. 5. No. 1, 2001, pp. 4-7    C. Lee, and A. Helal, ‘‘Context Attributes: An Approach to Enable Context-awareness for Service Discovery’’, In Proceedings of 2003 Symposium on Applications and the Internet Orlando, Florida, USA, 2003, pp. 22-30    Z. Maamar, S. Mostéfaoui, and Q. Mahmoud, ‘‘Context for Personalized Web Services’’, In Proceedings of the 38th Annual Hawaii International Conference on System Sciences Hawaii USA, 2005    Z. Maamar, G. AlKhatib, S. Mostéfaoui, M. Lahkim, and W. Mansoor, ‘‘Context-based Personalization of Web Services Composition and Provisioning’’, In Proceedings of 30 th EUROMICRO Conference Rennes, France, 2004, pp. 396-403  21  B Medjahed and Y. Atif, “Context-based matching for Web service composition Distributed and Parallel Databases  Vol. 21, No. 1, Springer, 2007, pp. 5-37  22  J. Kuck, and M. Gnasa, “Context-Sensitive Service Discovery meets Information Retrieval”, In Proceedings of 5 th IEEE International Conference on Pervasive Computing and Communications Workshops White Plains, New York, USA, 2007, pp 601-605  23  Q Sheng B. Benatallah, Z. Maamar, M. Dumas, and A Ngu, “Enabling Personalized Composition and Adaptive Provisioning of Web Services”, In Proceedings of 16 th CaiSE conference Riga, Latvia, 2004, pp. 322-337  24  S Pokraev J. Koolwaaij and M. Wibbels, “Extending UDDI with context-aware features based on semantic service descriptions”, In Proceedings of 2003 International Conference on Web Services Las Vegas, Nevada, USA, 2003, pp. 184-190  25  M. Keidl, and A. Kemper, “Towards Context-Aware Adaptable Web Services”, In Proceedings of the 13 th International Conference on World Wide Web - Alternate Track Papers Posters New York, USA, 2004, pp. 55-65  26  N. Luo, J. Yan, M. Liu, and S. Yang, “Towards ContextAware Composition of Web Services”, In Proceedings of 5 th  GCC conference Changsha, Hunan, China, 2006, pp. 494-499  27  W. Balke, and M. Wagner, “Towards Personalized Selection of Web Services”, In Proceedings of the 12 th International Conference on World Wide Web - Alternate Paper Tracks Budapest, Hungary, 2003  28  A. Dey, and G. Abowd, “Towards a Better Understanding of Context and Context-awareness”, In Proceedings of 2000 Conference on Human Factors in Computing Systems Workshop on The What, Who, Where, When, and How of ContextAwareness Hague, Netherlands, 2000  29  D. Rocco, J. Caverlee, L. Liu, and T. Critchlow, “Domainspecific Web Service Discovery with Service Class Descriptions”, In Proceedings of ICOS’2005 USA, 2005, pp. 481-488  30  N. Kokash, A. Birukou, and V. D'Andrea, “Web Service Discovery Based on Past User Experience”, In Proceedings of 10 th BIS conference Poznan, Poland, 2007, pp. 95-107  31  Q. Liang, J. Chung, S. Miller, and Y. Ouyang, “Service Pattern Discovery of Web Service Mining in Web Service Registry-Repository”, In Proceedings of ICEBE'2006 Shanghai China, 2006, pp. 286-293  32  S. Basu, F. Casati, and F. Daniel, “Web Service Dependency Discovery Tool for SOA Management”, In Proceedings of SCC’2007 conference USA, 2007, pp. 684-685  33  R. Agrawal, and R. Srikant, “Fast algorithms for mining association rules”, In Proceedings of the 20 th VLDB Conference  1994, pp. 487-499  34  J. Hipp, U. Guntzer, and G. Nakhaeizadeh, “Algorithms for association rule mining: a general survey and comparison SIGKDD Explorations Vol. 2, No. 1, 2000, pp. 58-64  35  C. Zhang, and S. Zhang, S, “Association Rule Mining Models and Algorithms”, Springer-Verlag, Berlin Heidelberg 2002 
304 
304 
304 


 Kluwer Academic Publishers Springer, New York 1st edition, 2001 14  S c h e f f e r   T   F i n d i n g  A s s o c i a t i o n  Ru l e s  t h a t  T r a de Support Optimally Against Confidence th The Elements of Statistical Learning self_care_guide/Urogenital/Postate%20Cancer.pdf  Accessed, 25 August, 2008 11  A g r a w a l   R  T   I m i e l i n s k i     A   S w a m i   M i n i n g  association rules between sets of items in large databases, In Proceedings of the 1993 ACM SIGMOD international conference on Management of data  The Netherlands 42 2001 61-95  Ordonez C Association rule discovery with the train and test approach for heart disease predictio n 207\226 216 12 001 13  H a s t i e   T    R  T i b s h i r a n i     J  H   F r i e d m a n   Proceedings of the 5th European Conference on Principles and Practice of Knowlege Discovery in Databases\(PKDD'01 IEEE Transactions on Information Technology in Biomedicine, 10\(2\, 2006. 334 \226 343 001 Freiburg, Germany : SpringerVerlag, 2001. 424-435 15  F l a c h   P  A     L a c h i c h e   N   Co n f i r m a t i o n g u i d e d  discovery of first-order rules with Tertius 10  P h a r m a c y   h t t p    w w w  p h a r m a c y  g o v  m y    


 7. Conclusions  In this paper we have proposed an intelligent and efficient technique to reassess the distances between dynamic XML documents when one or all of the initially clustered documents have changed. After the changes, the initial clustering solution might become obsolete - the distances between clustered XML documents might have changed more or less depending on the degree of modifications \(insert update, delete\hich have been applied. Re-running full pair-wise comparisons on the entire set of modified documents is not a viable option, because of the large number of redundant operations involved Our proposed technique allows the user to reassess the pair-wise XML document distances, not by fully comparing each new pair of versions in the clustering solution, but by determining the effect of the temporal changes on the previously known distances between them. This approach is both time and I/O effective, as the number of operations involved in distance reassessing is greatly reduced  References  1  Beringer, J. and H\374llermeier, E., Online clustering of parallel data streams Data and Knowledge Engineering 58\(2\,  2006, 180-204 2  Catania, B. and Maddalena A., A Clustering Approach for XML Linked Documents, Proceedings of the 13th International Workshop on Database and Expert Systems Applications \(DEXA\22202\, IEEE 2002 3  Chen, M.S., Han, J. and Yu, P., Data Mining: An Overview from Database Perspective, IEEE Transactions on Knowledge and Data Engineering vol. 8, 1996, 866-883 4  Cormen, T., Leiserson, C. and Rivest, R Introduction to algorithms, MIT Press, 1990 5  Costa, G., Manco, G., Ortale, R. and Tagarelli, A., A tree-based Approach to Clustering XML documents by Structure, PAKDD 2004, LNAI 3202, 137-148 Springer 2004 6  Dalamagas, T., Cheng, T., Winkel, K.J. and Sellis, T 2004, Clustering XML documents by Structure SETN 2004, LNAI 3025, 112-121, Springer 2004 7  Ester, M., Kriegel, H.P., Sander, J., Wimmer,M. and Xu, X., Incremental Clustering for Mining in a Data Warehousing Environment, Proc.of the 24 th VLDB Conference, New York, USA, 1998 8  Garofalakis, M., Rastogi, R., Seshadri, S. And Shim K., Data Mining and the Web: Past, Present and Future Proceedings of WIDM 99 Kansas, US, ACM 1999 9  Mignet, L., Barbosa, D. and Veltri, P., The XML web : a first study, In Proceedings of the 12 th  International Conference on WWW, 500-510 2003   Nayak, R., Xu, S., XCLS: A Fast and Effective Clustering Algorithm for Heterogeneous XML Documents, In Proceedings of the 10 th Pacific-Asia Conference on Advances in Knowledge Discovery and Data Mining, Singapore, LNCS 3918, 2006   Rusu, L.I., Rahayu, W. and Taniar, D., A methodology for Building XML Data Warehouses International Journal of Data warehousing Mining, 1\(2 67-92, 2005   Rusu, L.I., Rahayu, W. and Taniar D.,  Maintaining Versions of Dynamic XML Documents, In Proceedings of the 6th International Conference on Web Information Systems Engineering, New York NY, USA, November 20-22, 2005, LNCS 3806   Rusu, L.I., Rahayu, W. and Taniar, D., Warehousing Dynamic XML Documents, In Proceedings of the 8 th  International Conference on Data Warehousing and Knowledge Discovery \(DaWaK 2006 LNCS 4081 Springer, 175-184, 2006   Shen, Y. and Wang, B., Clustering Schemaless XML documents, CoopIS / DOA/ODBASE 2003, LNCS 2888, 767-784, Springer 2003   Yoon, J. P., Raghavan, V., Chakilam, V., and Kerschberg, L., BitCube: A Three-Dimensional Bitmap Indexing for XML Documents J. Intel. Inf Syst 17, 2-3 \(Dec. 2001\, 241-254   XML data repository, online at http www.cs.washington.edu / research / projects / xmltk xmldata  
456 
456 


5 Related Work There exists extensive previous work on both the mining of software repositories and on the use of clustering algorithms in software engineering This discussion focuses on the most similar and recent work in the area of software evolution Mining Software Repositories Our technique was partially inspired by the work of Zimmermann et al and Y ing et al 17 on the mining of association rules in change history As described in Section 1 we sought to expand the technique to be able to recommend larger but less precise clusters of elements to guide program navigation Bouktif et al also investigated how to recommend cochanges in software development As opposed to the work cited above Bouktif et al used change patterns instead of association rules Also their approach does not attempt to reconstruct transactions and can consider associated 002les that were changed in different transactions ChangeDistiller is a tool to classify changes in a transaction into 002ne-grained operations e.g addition of a method declaration and determines how strongly the change impacts other source code entities Our approach uses similar repository analysis techniques but is focused on providing task-related information as opposed to an overall assessment of a system's evolution Finally repository mining can also be used to detect aspects in the code In this conte xt aspects are recurring sets of changed elements that exhibit a regular structure Aspects differ from the clusters we detect in the regular structure they exhibit which may not necessarily align with the code that is investigated as part of change tasks Clustering Analysis The classical application of clustering for reverse engineering involves grouping software entities based on an analysis of various relations between pairs of entities of a given version of the system Despite its long and rich history  e xperimentation with this approach continues to this day For example Andreopoulos et al combined static and dynamic information K uhn et al used a te xtual similarity measure as the clustering relation and Christl et al used clustering to assist iterative semi-automated reverse engineering The main dif ferences b e tween most clusteringbased reverse engineering techniques and the subject of our investigation is that the entities we cluster are transactions rather than software entities in a single version of a system For this reason our analysis is based strictly on the evolving parts of the system Both Kothari et al and V an ya et al 15 recently reported on their use of clustering to study the evolution of software systems The idea of using change clusters is the same in both works and ours but the purpose of the work is different Kothari et al use change clusters to uncover the types of changes that happened e.g feature addition maintenance etc during the history of a software system Vanya et al use change clusters which they call evolutionary clusters to guide the partitioning of a system that would increase the likelihood that the parts of the system would evolve independently In contrast we cluster transactions based on overlapping elements not 002les to recommend clusters to support program navigation as opposed to architectural-level assessment of the system Finally Hassan and Holt evaluated on 002ve open source systems the performance of several methods to indicate elements that should be modi\002ed together This study found that using historical co-change information as opposed to using simple static analysis or code layout offered the best results in terms of recall and precision The authors then tried to improve the results using 002ltering heuristics and found that keeping only the most frequently cochanged entities yielded the best results As opposed to our approach the evaluated 002ltering heuristics were only applied on entities recovered using association rules and not using clustering techniques The focus of their study was also more speci\002c as they recommend program elements that were strictly changed  as opposed to recommending elements that might be inspected by developers 6 Conclusion Developers often need to discover code that has been navigated in the past We investigated to what extent we can bene\002t from change clusters to guide program navigation We de\002ned change clusters as groups of elements that were part of transactions or change sets that had elements in common Our analysis of close to 12 years of software change data for a total of seven different open-source systems revealed that less than 12 of the changes we studied could have bene\002ted from change clusters We conclude that further efforts should thus focus on maximizing the quality of the match between the current task and past transactions rather than 002nding many potential matches Our study has already helped us in this goal by providing reliable evidence of the effectiveness of some 002ltering heuristics and useful insights for the development of additional heuristics Acknowledgments The authors thank Emily Hill and Jos  e Correa for their advice on the statistical tests and the anonymous reviewers for their helpful suggestions This work was supported by NSERC 
25 
25 
25 
25 
25 


References  B Andreopoulos A An V  Tzerpos and X W ang Multiple layer clustering of large software systems In Proc 12th Working Conf on Reverse Engineering  pages 79–88 2005  S Bouktif Y G Gu  eh  eneuc and G Antoniol Extracting change-patterns from cvs repositories In Proc 13th Working Conf on Reverse Engineering  pages 221–230 2006  S Breu and T  Zimmermann Mining aspects from v ersion history In Proc 21st IEEE/ACM Int'l Conf on Automated Software Engineering  pages 221–230 2006  A Christl R K oschk e and M.-A Store y  Equipping the re\003exion method with automated clustering In Proc 12th Working Conf on Reverse Engineering  pages 89–98 2005  D 020 Cubrani  c G C Murphy J Singer and K S Booth Hipikat A project memory for software development IEEE Transactions on Software Engineering  31\(6 465 2005  B Fluri and H C Gall Classifyi ng change types for qualifying change couplings In Proc 14th IEEE Int'l Conf on Program Comprehension  pages 35–45 2006  A E Hassan and R C Holt Replaying de v elopment history to assess the effectiveness of change propagation tools Empirical Software Engineering  11\(3 2006  D H Hutchens and V  R Basili System s tructure analysis Clustering with data bindings IEEE Transactions on Software Engineering  11\(8 1985  D Janzen and K De V older Na vig ating and querying code without getting lost In Proc 2nd Int'l Conf on AspectOriented Software Development  pages 178–187 2003  J K ot hari T  Denton A Shok ouf andeh S Mancoridis and A E Hassan Studying the evolution of software systems using change clusters In Proc 14th IEEE Int'l Conf on Program Comprehension  pages 46–55 2006  A K uhn S Ducasse and T  G  021rba Enriching reverse engineering with semantic clustering In Proc 12th Working Conf on Reverse Engineering  pages 133–142 2005  M P  Robillard T opology analysis of softw are dependencies ACM Transactions on Software Engineering and Methodology  2008 To appear  M P  Robillard and P  Mangg ala Reusing program in v estigation knowledge for code understanding In Proc 16th IEEE Int'l Conf on Program Comprehension  pages 202 211 2008  J Sillito G Murph y  and K De V older Questions programmers ask during software evolution tasks In Proc 14th ACM SIGSOFT Int'l Symposium on the Foundations of Software Engineering  pages 23–34 2006  A V an ya L Ho\003and S Klusener  P  v an de Laar and H van Vliet Assessing software archives with evolutionary clusters In Proc 16th IEEE Int'l Conf on Program Comprehension  pages 192–201 2008  N W ilde and M C Scully  Softw are reconnaissance Mapping program features to code Software Maintenance Research and Practice  7:49–62 1995  A T  Y ing G C Murph y  R Ng and M C Chu-Carroll Predicting source code changes by mining change history IEEE Transactions on Software Engineering  30\(9 586 2004  A Zeller  The future of programming en vironments Integration synergy and assistance In Proceedings of the 29th International Conference on Software Engineering The Future of Software Engineering  pages 316–325 2007  T  Zimmermann and P  W eißgerber  Preprocessing C VS data for 002ne-grained analysis In Proc 1st Int'l Workshop on Mining Software Repositories  pages 2–6 May 2004  T  Zimmermann P  W eißgerber  S Diehl and A Zeller  Mining version histories to guide software changes In Proc 26th ACM/IEEE Int'l Conf on Software Engineering  pages 563–572 2004 A Clustering Algorithm This algorithm is not sensitive to whether a given program element exists or not in a given version of a program For example if method m exists in one version it is considered a valid program element even if it is removed in a later version In the rest of this section we use the term program element to refer to the uniquely identifying representation of the element e.g a Java fully-quali\002ed name Let T be a transaction modeled as a set of program elements changed together during the history of a software system Let T be a sequence of transactions In this algorithm a cluster is also modeled as a set of elements 1 Input  T  A sequence of transactions 2 Parameter  M IN O VERLAP  A positive non-zero value indicating the minimum overlap between two transactions in a cluster 3 Var  C  A set of clusters initially empty 4 for all T i 2 T do 5 MaxOverlap  0 6 MaxIndex  000 1 7 for all C j 2 C do 8 if j C j  T i j  MaxOverlap then 9 MaxOverlap  j C j  T i j 10 MaxIndex  j 11 end if 12 end for 13 if MaxIndex   0  MaxOverlap 025 M IN O VERLAP  then 14 C MaxIndex   C MaxIndex  T i  15 else 16 NewCluster  T i 17 C  C  f NewCluster g 18 end if 19 end for 20 return C B Systems Analyzed System home pages last veri\002ed 7 May 2008 Ant ant.apache.org Azureus azureus.sourceforge.net Hibernate www.hibernate.org JDT-Core www.eclipse.org/jdt/core JDT-UI www.eclipse.org/jdt/ui Spring springframework.org Xerces xerces.apache.org 
26 
26 
26 
26 
26 


